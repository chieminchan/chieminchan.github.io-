<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ğŸŒµ Vue | CHIEMINCHAN&#39;S BLOG</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/images/donut.png">
    <meta name="description" content="Hi, glad you came.">
    
    <link rel="preload" href="/assets/css/0.styles.8f3dca9f.css" as="style"><link rel="preload" href="/assets/js/app.448d156c.js" as="script"><link rel="preload" href="/assets/js/2.fefa3fa1.js" as="script"><link rel="preload" href="/assets/js/1.67a15f5a.js" as="script"><link rel="preload" href="/assets/js/78.81fd1ead.js" as="script"><link rel="prefetch" href="/assets/js/10.5229b01a.js"><link rel="prefetch" href="/assets/js/11.9dccb5a1.js"><link rel="prefetch" href="/assets/js/12.1aa023e7.js"><link rel="prefetch" href="/assets/js/13.da540175.js"><link rel="prefetch" href="/assets/js/14.981e669d.js"><link rel="prefetch" href="/assets/js/15.f28dd0b3.js"><link rel="prefetch" href="/assets/js/16.47e1d84d.js"><link rel="prefetch" href="/assets/js/17.7ff34030.js"><link rel="prefetch" href="/assets/js/18.6dcbdd16.js"><link rel="prefetch" href="/assets/js/19.e568fd00.js"><link rel="prefetch" href="/assets/js/20.182f1f9b.js"><link rel="prefetch" href="/assets/js/21.b834a74a.js"><link rel="prefetch" href="/assets/js/22.a3523cd2.js"><link rel="prefetch" href="/assets/js/23.61d15c5b.js"><link rel="prefetch" href="/assets/js/24.2aadb209.js"><link rel="prefetch" href="/assets/js/25.836695fb.js"><link rel="prefetch" href="/assets/js/26.0ab922cb.js"><link rel="prefetch" href="/assets/js/27.5ac9e339.js"><link rel="prefetch" href="/assets/js/28.d6a5eb15.js"><link rel="prefetch" href="/assets/js/29.3eea682e.js"><link rel="prefetch" href="/assets/js/3.fc739620.js"><link rel="prefetch" href="/assets/js/30.5225944d.js"><link rel="prefetch" href="/assets/js/31.ec02d3da.js"><link rel="prefetch" href="/assets/js/32.bd05dede.js"><link rel="prefetch" href="/assets/js/33.4a293dcf.js"><link rel="prefetch" href="/assets/js/34.4464026b.js"><link rel="prefetch" href="/assets/js/35.4dd4f327.js"><link rel="prefetch" href="/assets/js/36.ca28dda7.js"><link rel="prefetch" href="/assets/js/37.3a17971f.js"><link rel="prefetch" href="/assets/js/38.f86fa51b.js"><link rel="prefetch" href="/assets/js/39.6ff149b0.js"><link rel="prefetch" href="/assets/js/4.0471e9ae.js"><link rel="prefetch" href="/assets/js/40.23565895.js"><link rel="prefetch" href="/assets/js/41.0116a1ec.js"><link rel="prefetch" href="/assets/js/42.c38f3e0c.js"><link rel="prefetch" href="/assets/js/43.1d0d8ffd.js"><link rel="prefetch" href="/assets/js/44.631fa43e.js"><link rel="prefetch" href="/assets/js/45.0f88df1f.js"><link rel="prefetch" href="/assets/js/46.cc671ab0.js"><link rel="prefetch" href="/assets/js/47.90cce12d.js"><link rel="prefetch" href="/assets/js/48.ad0ce6a4.js"><link rel="prefetch" href="/assets/js/49.ade35f37.js"><link rel="prefetch" href="/assets/js/5.5356be46.js"><link rel="prefetch" href="/assets/js/50.de00c31b.js"><link rel="prefetch" href="/assets/js/51.9de8257a.js"><link rel="prefetch" href="/assets/js/52.50f1abf2.js"><link rel="prefetch" href="/assets/js/53.b3b3acb2.js"><link rel="prefetch" href="/assets/js/54.71bfe1b2.js"><link rel="prefetch" href="/assets/js/55.b00cfb1c.js"><link rel="prefetch" href="/assets/js/56.1bb058d3.js"><link rel="prefetch" href="/assets/js/57.5651fd65.js"><link rel="prefetch" href="/assets/js/58.3dd11306.js"><link rel="prefetch" href="/assets/js/59.233d45e8.js"><link rel="prefetch" href="/assets/js/6.5b3d5499.js"><link rel="prefetch" href="/assets/js/60.7c729149.js"><link rel="prefetch" href="/assets/js/61.eb5805f6.js"><link rel="prefetch" href="/assets/js/62.fde12179.js"><link rel="prefetch" href="/assets/js/63.3358d1e0.js"><link rel="prefetch" href="/assets/js/64.1b930210.js"><link rel="prefetch" href="/assets/js/65.3048ba53.js"><link rel="prefetch" href="/assets/js/66.a065502e.js"><link rel="prefetch" href="/assets/js/67.715eef17.js"><link rel="prefetch" href="/assets/js/68.edf44196.js"><link rel="prefetch" href="/assets/js/69.94cb6d60.js"><link rel="prefetch" href="/assets/js/7.c94df317.js"><link rel="prefetch" href="/assets/js/70.9061bb98.js"><link rel="prefetch" href="/assets/js/71.980c8e32.js"><link rel="prefetch" href="/assets/js/72.43be58ba.js"><link rel="prefetch" href="/assets/js/73.e2f40377.js"><link rel="prefetch" href="/assets/js/74.9ef8a48c.js"><link rel="prefetch" href="/assets/js/75.b006fb40.js"><link rel="prefetch" href="/assets/js/76.311cf38f.js"><link rel="prefetch" href="/assets/js/77.2d4b2c6d.js"><link rel="prefetch" href="/assets/js/79.01e24fba.js"><link rel="prefetch" href="/assets/js/80.b15cc1f3.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.934ed2fb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f3dca9f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">CHIEMINCHAN'S BLOG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/articles/" class="nav-link">
  æ–‡ç« 
</a></div><div class="nav-item"><a href="/fragments/" class="nav-link router-link-active">
  çŸ¥è¯†ç¢ç‰‡
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  ç®—æ³•
</a></div><div class="nav-item"><a href="/reading/" class="nav-link">
  è¯»/è§‚åæ„Ÿ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/chieminchan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHubé¦–é¡µ
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/articles/" class="nav-link">
  æ–‡ç« 
</a></div><div class="nav-item"><a href="/fragments/" class="nav-link router-link-active">
  çŸ¥è¯†ç¢ç‰‡
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  ç®—æ³•
</a></div><div class="nav-item"><a href="/reading/" class="nav-link">
  è¯»/è§‚åæ„Ÿ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/chieminchan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHubé¦–é¡µ
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>çŸ¥è¯†ç¢ç‰‡</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fragments/" aria-current="page" class="sidebar-link">ğŸŒ» çŸ¥è¯†ç¢ç‰‡</a></li><li><a href="/fragments/Vue.html" aria-current="page" class="active sidebar-link">ğŸŒµ Vue</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_001-vue-ç”Ÿå‘½å‘¨æœŸ-é’©å­å‡½æ•°" class="sidebar-link">001ï¼š Vue ç”Ÿå‘½å‘¨æœŸï¼ˆé’©å­å‡½æ•°ï¼‰</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_002-çˆ¶å­ç»„ä»¶æŒ‚è½½é¡ºåºæ˜¯æ€ä¹ˆæ ·çš„" class="sidebar-link">002ï¼š çˆ¶å­ç»„ä»¶æŒ‚è½½é¡ºåºæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_003-vue-çš„æ¨¡ç‰ˆç¼–è¯‘è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„" class="sidebar-link">003ï¼š Vue çš„æ¨¡ç‰ˆç¼–è¯‘è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_004-æ¨¡æ¿ç¼–è¯‘åŸç†" class="sidebar-link">004ï¼š æ¨¡æ¿ç¼–è¯‘åŸç†</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_005-diff-ç®—æ³•" class="sidebar-link">005ï¼š diff ç®—æ³•</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_006-è™šæ‹Ÿ-dom-å®ç°åŸç†-æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹" class="sidebar-link">006ï¼šè™šæ‹Ÿ DOM å®ç°åŸç†ï¼Œæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_007-key-å±æ€§çš„ä½œç”¨" class="sidebar-link">007ï¼š key å±æ€§çš„ä½œç”¨</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_008-computedã€methodsã€-watch-åŒºåˆ«" class="sidebar-link">008ï¼š computedã€methodsã€ watch åŒºåˆ«ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_009-filters-ä¸-computed-çš„åŒºåˆ«ä¸ç”¨æ³•" class="sidebar-link">009ï¼š filters ä¸ computed çš„åŒºåˆ«ä¸ç”¨æ³•</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_010-v-show-ä¸-v-if-åŒºåˆ«" class="sidebar-link">010ï¼š v-show ä¸ v-if åŒºåˆ«ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_011-vue-js-åŒå‘ç»‘å®šåŸç†" class="sidebar-link">011ï¼š Vue.js åŒå‘ç»‘å®šåŸç†</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_012-keep-alive-ç»„ä»¶æœ‰ä»€ä¹ˆä½œç”¨" class="sidebar-link">012ï¼š keep-alive ç»„ä»¶æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_013-vue-ç»„ä»¶é—´é€šä¿¡æœ‰å“ªå‡ ç§æ–¹å¼" class="sidebar-link">013ï¼š Vue ç»„ä»¶é—´é€šä¿¡æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_014-nexttick-åŸç†åˆ†æ" class="sidebar-link">014ï¼š nextTick åŸç†åˆ†æ</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_015-native-ä¿®é¥°ç¬¦çš„ä½œç”¨" class="sidebar-link">015ï¼š .native ä¿®é¥°ç¬¦çš„ä½œç”¨</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_016-çˆ¶ç»„ä»¶å¯ä»¥ç›‘å¬åˆ°å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå—" class="sidebar-link">016ï¼š çˆ¶ç»„ä»¶å¯ä»¥ç›‘å¬åˆ°å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå—ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_016-vue-çš„å•å‘æ•°æ®æµçš„ç†è§£" class="sidebar-link">016ï¼š Vue çš„å•å‘æ•°æ®æµçš„ç†è§£</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_017-vue-äº‹ä»¶ç»‘å®šåŸç†è¯´ä¸€ä¸‹" class="sidebar-link">017ï¼š Vue äº‹ä»¶ç»‘å®šåŸç†è¯´ä¸€ä¸‹</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_018-mvvm-å’Œ-mvc-ç†è§£" class="sidebar-link">018ï¼š MVVM å’Œ MVC ç†è§£</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_019-vue-router-è·¯ç”±æ¨¡å¼æœ‰å‡ ç§" class="sidebar-link">019ï¼švue-router è·¯ç”±æ¨¡å¼æœ‰å‡ ç§</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_020-vue3-0-ç‰¹æ€§" class="sidebar-link">020ï¼š vue3.0 ç‰¹æ€§</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_021-vue-çš„ä¼˜åŒ–" class="sidebar-link">021ï¼š Vue çš„ä¼˜åŒ–</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_022-vue-set-çš„å®ç°åŸç†" class="sidebar-link">022ï¼š Vue.set çš„å®ç°åŸç†</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_023-vue-æ•°æ®æ¸²æŸ“è¿‡ç¨‹" class="sidebar-link">023ï¼šVue æ•°æ®æ¸²æŸ“è¿‡ç¨‹</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_024-ç»„ä»¶æ›´æ–°çš„è¿‡ç¨‹" class="sidebar-link">024ï¼šç»„ä»¶æ›´æ–°çš„è¿‡ç¨‹</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_025-ä¸ºä»€ä¹ˆ-v-for-å’Œ-v-if-ä¸èƒ½èƒ½åŒæ—¶ä½¿ç”¨" class="sidebar-link">025ï¼šä¸ºä»€ä¹ˆ v-for å’Œ v-if ä¸èƒ½èƒ½åŒæ—¶ä½¿ç”¨</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_026-ä¸ºä»€ä¹ˆç»„ä»¶çš„-data-æ˜¯ä¸€ä¸ªå‡½æ•°" class="sidebar-link">026ï¼šä¸ºä»€ä¹ˆç»„ä»¶çš„ data æ˜¯ä¸€ä¸ªå‡½æ•°</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_027-ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸæ’æ§½" class="sidebar-link">027ï¼šä»€ä¹ˆæ˜¯ä½œç”¨åŸŸæ’æ§½</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_028-ç®€è¿°-vuex-å·¥ä½œåŸç†" class="sidebar-link">028ï¼šç®€è¿° vuex å·¥ä½œåŸç†</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_029-action-å’Œ-mutation-åŒºåˆ«" class="sidebar-link">029ï¼šaction å’Œ mutation åŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_030-vue-router-å¯¼èˆªå®ˆå«ç±»å‹" class="sidebar-link">030ï¼švue-router å¯¼èˆªå®ˆå«ç±»å‹</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_031-å®Œæ•´çš„å¯¼èˆªè§£ææµç¨‹" class="sidebar-link">031ï¼šå®Œæ•´çš„å¯¼èˆªè§£ææµç¨‹</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_032-ç®€å•èŠèŠ-new-vue-ä»¥åå‘ç”Ÿçš„äº‹æƒ…" class="sidebar-link">032ï¼šç®€å•èŠèŠ new Vue ä»¥åå‘ç”Ÿçš„äº‹æƒ…</a></li><li class="sidebar-sub-header"><a href="/fragments/Vue.html#_033-æ¨¡æ¿å­—ç¬¦ä¸²è§£æ" class="sidebar-link">033ï¼šæ¨¡æ¿å­—ç¬¦ä¸²è§£æ</a></li></ul></li><li><a href="/fragments/Network.html" class="sidebar-link">ğŸŒµ ç½‘ç»œ</a></li><li><a href="/fragments/JavaScript.html" class="sidebar-link">ğŸŒµ JavaScript</a></li><li><a href="/fragments/JavaScript Algorithms.html" class="sidebar-link">ğŸŒµ JavaScript åŸºç¡€ç®—æ³•</a></li><li><a href="/fragments/ES6.html" class="sidebar-link">ğŸŒµ ES6</a></li><li><a href="/fragments/CSS.html" class="sidebar-link">ğŸŒµ CSS</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue"><a href="#vue" class="header-anchor">#</a> ğŸŒµ Vue</h1> <h2 id="_001-vue-ç”Ÿå‘½å‘¨æœŸ-é’©å­å‡½æ•°"><a href="#_001-vue-ç”Ÿå‘½å‘¨æœŸ-é’©å­å‡½æ•°" class="header-anchor">#</a> 001ï¼š Vue ç”Ÿå‘½å‘¨æœŸï¼ˆé’©å­å‡½æ•°ï¼‰</h2> <p>åˆ›å»ºé˜¶æ®µï¼š beforeCreateã€createdã€beforeMountã€mountedï¼›<br>
æ›´æ–°é˜¶æ®µï¼š beforeUpdateã€updatedï¼›<br>
é”€æ¯é˜¶æ®µï¼š beforeDestoryã€destroyedï¼›<br>
è¿˜æœ‰é’ˆå¯¹æ¥ç¼“å­˜ç»„ä»¶çŠ¶æ€çš„ <code>&lt;keep-alive&gt;&lt;/keep-alive&gt;</code> æä¾›çš„ activated å’Œ deactivatedã€‚</p> <p>å…¶ä¸­æœ€å¸¸ç”¨çš„æ˜¯ beforeCreate å’Œ createdã€beforeMount å’Œ mountedï¼Œä»–ä»¬çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼š</p> <ul><li><code>beforeCreate</code>ï¼šel å’Œ data éƒ½æœªåˆå§‹åŒ–ï¼Œæ•°æ®å’Œæ–¹æ³•éƒ½ä¸èƒ½è¢«è®¿é—®ã€‚</li></ul> <ul><li><code>created</code>ï¼šç»„ä»¶å®ä¾‹åˆ›å»ºå®Œæˆï¼Œå±æ€§å·²ç»ç»‘å®šï¼Œdata å·²åˆå§‹åŒ–ï¼Œel æœªåˆå§‹åŒ–ï¼ˆè¯´æ˜å¯åœ¨ created ä¸­é¦–æ¬¡æ‹¿åˆ° data ä¸­å®šä¹‰çš„æ•°æ®ï¼‰ã€‚</li></ul> <p>åœ¨è¿™é‡Œå¯ä»¥æ‹¿åˆ° data æ•°æ®å’Œæ›´æ”¹æ•°æ®ï¼Œä½†ä¸ä¼šè§¦å‘ updated å‡½æ•°ã€‚å¯ä»¥åšä¸€äº›åˆå§‹æ•°æ®çš„è·å–ï¼Œåœ¨å½“å‰é˜¶æ®µæ— æ³•ä¸ Dom è¿›è¡Œäº¤äº’ï¼Œå¦‚æœéè¦æƒ³ï¼Œå¯ä»¥é€šè¿‡ <code>vm.$nextTick</code> æ¥è®¿é—® Domã€‚</p> <ul><li><code>beforeMount</code>ï¼šå®Œæˆ data å’Œ el çš„åˆå§‹åŒ–ï¼Œtemplate æ¨¡æ¿å·²å¯¼å…¥æ¸²æŸ“å‡½æ•°ç¼–è¯‘ï¼Œä½†æœªæŒ‚è½½ä»æ— æ³•è·å– DOMã€‚ï¼ˆ<code>vm.$mount(el)</code> ä¼šè§¦å‘è¿™ä¸ªçŠ¶æ€ï¼ŒæŠŠ HTML ç»“æ„æ¸²æŸ“å‡ºæ¥ï¼Œä½† vue å®ä¾‹ä¸­çš„æ•°æ®æ²¡æœ‰æ¸²æŸ“åˆ° DOM ä¸­ï¼Œåªæ˜¯åˆ©ç”¨è™šæ‹Ÿ DOM æŠŠå‘å ä½ï¼‰ã€‚</li></ul> <ul><li><code>mounted</code>ï¼šel ä¼šè¢«æ–°åˆ›å»ºçš„ <code>vm.$el</code> æ›¿æ¢ï¼Œå³æœ‰äº† DOM ä¸”å®Œæˆäº†åŒå‘ç»‘å®š å¯è®¿é—® DOM èŠ‚ç‚¹ï¼Œå¹¶æŒ‚åœ¨æ˜¯æ¸²æŸ“ DOMï¼Œå®ŒæˆæŒ‚è½½ï¼ˆè¯´æ˜åœ¨ mounted ä¸­ dom æ ‘æ¸²æŸ“ç»“æŸï¼Œå¯è®¿é—® dom ç»“æ„ï¼‰ã€‚</li></ul> <p>ä¾‹å­ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>vue-test-demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>
            <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.jsdelivr.net/vue/2.1.3/vue.js<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{message}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
            <span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">&quot;#app&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;this is a demo for vue&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">beforeCreate</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token string">&quot;beforeCreate åˆ›å»ºå‰çŠ¶æ€ ï¼š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;el: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;data: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;message: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">created</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token string">&quot;created åˆ›å»ºå®ŒæˆçŠ¶æ€ ï¼š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;el: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;data: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;message: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">beforeMount</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token string">&quot;beforeMount æŒ‚è½½å‰çŠ¶æ€ ï¼š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;el: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;data: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;message: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">mounted</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token string">&quot;mounted æŒ‚è½½å®ŒæˆçŠ¶æ€ ï¼š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;el: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;data: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;message: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">beforeUpdate</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token string">&quot;beforeUpdate æ›´æ–°å‰çŠ¶æ€ ï¼š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;el: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;data: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;message: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">updated</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token string">&quot;updated æ›´æ–°å®ŒæˆçŠ¶æ€ ï¼š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;el: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;data: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;message: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">beforeDestory</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token string">&quot;beforeDestory æ‘§æ¯å‰çŠ¶æ€ ï¼š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;el: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;data: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;message: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">destoryed</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token string">&quot;destoryed æ‘§æ¯åçŠ¶æ€ ï¼š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;el: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;data: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;message: &quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>è¾“å‡ºç»“æœå¦‚å›¾ï¼š<br> <img src="https://raw.githubusercontent.com/chieminchan/chieminchan.github.io/master/images/interviews/Vue-Lifecycle1.jpg" alt="vue ç”Ÿå‘½å‘¨æœŸå›¾ 1"></p> <p><img src="https://raw.githubusercontent.com/chieminchan/chieminchan.github.io/master/images/interviews/Vue-Lifecycle2.jpg" alt="vue ç”Ÿå‘½å‘¨æœŸå›¾ 2"></p> <p>å…¶ä¸­ä¹Ÿå¯ä»¥çœ‹å‡º updated å’Œ destoryed å‰åçŠ¶æ€çš„å˜åŒ–ï¼š</p> <ul><li><code>beforeUpdate</code>ï¼šå¯ä»¥ç›‘å¬åˆ° data çš„å˜åŒ–ï¼Œä½†æ˜¯ view å±‚çš„æ•°æ®æ²¡æœ‰å˜åŒ–ï¼Œå› æ­¤ view å±‚æ²¡æœ‰è¢«é‡æ–°æ¸²æŸ“ã€‚</li> <li><code>updated</code>ï¼šview å±‚è¢«é‡æ–°æ¸²æŸ“ï¼Œæ•°æ®æ›´æ–°ã€‚</li> <li><code>beforeDestory</code>ï¼šå®ä¾‹é”€æ¯ä¹‹å‰è°ƒç”¨ï¼Œå®ä¾‹ä»å¯è®¿é—®å¯ç”¨ã€‚</li> <li><code>destoryed</code>ï¼šVue å®ä¾‹é”€æ¯åè°ƒç”¨ï¼Œè°ƒç”¨åå®ä¾‹æŒ‡ç¤ºçš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šè§£ç»‘å®šï¼Œæ‰€æœ‰çš„äº‹ä»¶ç›‘å¬å™¨ä¼šè¢«ç§»é™¤ï¼Œæ‰€æœ‰çš„å­å®ä¾‹ä¹Ÿä¼šè¢«é”€æ¯ã€‚</li></ul> <p>å‚è€ƒæ–‡ç« ï¼š<br> <a href="https://segmentfault.com/a/1190000011381906" target="_blank" rel="noopener noreferrer">è¯¦è§£ vue ç”Ÿå‘½å‘¨æœŸ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="beforecreate-ä¹‹å‰åšäº†ä»€ä¹ˆ"><a href="#beforecreate-ä¹‹å‰åšäº†ä»€ä¹ˆ" class="header-anchor">#</a> beforeCreate ä¹‹å‰åšäº†ä»€ä¹ˆ</h4> <p>new Vue()åˆ›å»ºä¸€ä¸ªå®ä¾‹åï¼Œä¼šè°ƒç”¨<code>this._init(options)</code>ï¼Œå¹¶ä¸”åœ¨å¤–éƒ¨é€šè¿‡<code>initMixin()ã€stateMiXin()ã€eventMixin()ã€lifeMixin()ã€renderMixin()</code>å»åšåˆå§‹åŒ–äº‹ä»¶ã€åˆå§‹åŒ–ç”Ÿå‘½å‘¨æœŸçš„ä¸€äº›æ“ä½œã€‚</p> <h4 id="æ··å…¥-mixin-çš„æ‰§è¡Œé¡ºåº-ä»¥åŠå¦‚æœæœ‰å†²çªæ€ä¹ˆå¤„ç†çš„"><a href="#æ··å…¥-mixin-çš„æ‰§è¡Œé¡ºåº-ä»¥åŠå¦‚æœæœ‰å†²çªæ€ä¹ˆå¤„ç†çš„" class="header-anchor">#</a> æ··å…¥ mixin çš„æ‰§è¡Œé¡ºåºï¼Œä»¥åŠå¦‚æœæœ‰å†²çªæ€ä¹ˆå¤„ç†çš„ï¼Ÿ</h4> <p>æ··å…¥ mixin æ—¶ï¼Œmixin çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°æ‰§è¡Œä¼šä¼˜å…ˆäºç»„ä»¶ã€‚</p> <p>å½“ç»„ä»¶å’Œæ··å…¥å¯¹è±¡å«æœ‰åŒåé€‰é¡¹æ—¶ï¼Œé€‰é¡¹å°†ä»¥æ°å½“çš„æ–¹å¼â€œåˆå¹¶â€ï¼š</p> <ul><li><p>é’©å­å‡½æ•°ï¼Œcreatedã€mounted ç­‰åŒåé’©å­å‡½æ•°ä¼šåˆå¹¶æˆä¸€ä¸ªæ•°ç»„ï¼Œéƒ½å°†è¢«è°ƒç”¨ã€‚æ··å…¥å¯¹è±¡é’©å­å‡½æ•°ä¼˜å…ˆæ‰§è¡Œï¼ˆç”Ÿå‘½å‘¨æœŸæ‰§è¡Œ mixin å…ˆäºç»„ä»¶ï¼‰ã€‚</p></li> <li><p>Data æ•°æ®ï¼Œæ•°æ®å¯¹è±¡åœ¨å†…éƒ¨è¿›è¡Œé€’å½’åˆå¹¶ï¼Œå¹¶åœ¨å‘ç”Ÿå†²çªæ—¶ä»¥ç»„ä»¶æ•°æ®ä¼˜å…ˆï¼›</p></li> <li><p>å¯¹è±¡é€‰é¡¹ï¼šcomponentsã€methodsã€directives ç­‰å¯¹è±¡ï¼Œä¼šè¢«åˆå¹¶ä¸ºåŒä¸€å¯¹è±¡ã€‚å¦‚æœå‡ºç°äº†ç›¸åŒé”®å€¼å¯¹ï¼Œåˆ™å½“å‰ç»„ä»¶ä¸­çš„é”®å…·æœ‰ä¼˜å…ˆçº§ã€‚</p></li></ul> <h4 id="keep-alive-ç¼“å­˜æ—¶çš„ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œé¡ºåº"><a href="#keep-alive-ç¼“å­˜æ—¶çš„ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œé¡ºåº" class="header-anchor">#</a> keep-alive ç¼“å­˜æ—¶çš„ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œé¡ºåº</h4> <p>keep-alive åŒ…è£¹åŠ¨æ€ç»„ä»¶æ—¶ï¼Œä¼šç¼“å­˜ä¸æ´»åŠ¨çš„ç»„ä»¶å®ä¾‹ï¼Œè€Œä¸æ˜¯é”€æ¯å®ƒä»¬ã€‚</p> <p>é¡µé¢ç¬¬ä¸€æ¬¡è¿›å…¥ï¼Œé’©å­çš„è§¦å‘é¡ºåº created-&gt; mounted-&gt; activatedï¼Œ<br>
é€€å‡ºæ—¶è§¦å‘ deactivatedï¼Œå½“å†æ¬¡è¿›å…¥ï¼ˆå‰è¿›æˆ–è€…åé€€ï¼‰æ—¶ï¼Œåªè§¦å‘ activatedã€‚</p> <h2 id="_002-çˆ¶å­ç»„ä»¶æŒ‚è½½é¡ºåºæ˜¯æ€ä¹ˆæ ·çš„"><a href="#_002-çˆ¶å­ç»„ä»¶æŒ‚è½½é¡ºåºæ˜¯æ€ä¹ˆæ ·çš„" class="header-anchor">#</a> 002ï¼š çˆ¶å­ç»„ä»¶æŒ‚è½½é¡ºåºæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</h2> <p>åŠ è½½æ¸²æŸ“è¿‡ç¨‹ï¼š<br>
çˆ¶ beforeCreate -&gt; çˆ¶ created -&gt; çˆ¶ beforedMount -&gt; å­ beforeCreate -&gt; å­ created -&gt; å­ beforedMount -&gt; å­ mounted -&gt; çˆ¶ mounted</p> <p>å¦å¤–å…³äº updated å’Œ destroyed çš„é¡ºåºï¼ˆä»å¤–åˆ°å†…ï¼Œå†ä»å†…åˆ°å¤–ï¼‰ï¼š</p> <ul><li>å­æ›´æ–°ï¼š çˆ¶ beforeUpdate -&gt; å­ beforeUpdate -&gt; å­ updated -&gt; çˆ¶ updated</li> <li>çˆ¶æ›´æ–°ï¼š çˆ¶ beforeUpdate -&gt; çˆ¶ updated</li> <li>é”€æ¯ï¼š çˆ¶ beforeDestroy -&gt; å­ beforeDestroy -&gt; å­ destroyed -&gt; çˆ¶ destroyed</li></ul> <h2 id="_003-vue-çš„æ¨¡ç‰ˆç¼–è¯‘è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„"><a href="#_003-vue-çš„æ¨¡ç‰ˆç¼–è¯‘è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„" class="header-anchor">#</a> 003ï¼š Vue çš„æ¨¡ç‰ˆç¼–è¯‘è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„</h2> <p>æ™®é€šçš„ template æˆ–è€… el éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œéœ€è¦è§£ææˆ ASTï¼Œå†å°† AST è½¬åŒ–ä¸º render å‡½æ•°ã€‚</p> <p>Vue çš„ç¼–è¯‘è¿‡ç¨‹å°±æ˜¯å°† template/el è½¬åŒ–ä¸º render å‡½æ•°çš„è¿‡ç¨‹ã€‚ä¸»è¦ä¼šç»å†ä»¥ä¸‹é˜¶æ®µï¼š</p> <p>ï¼ˆ1ï¼‰è§£ææ¨¡ç‰ˆï¼Œç”Ÿæˆ AST æ ‘(ä¸€ç§ç”¨ JavaScript å¯¹è±¡çš„å½¢å¼æ¥æè¿°æ•´ä¸ªæ¨¡æ¿)<br>
ä¼šä½¿ç”¨å¤§é‡çš„æ­£åˆ™è¡¨è¾¾å¼å¯¹æ¨¡æ¿è¿›è¡Œè§£æï¼Œé‡åˆ°æ ‡ç­¾ã€æ–‡æœ¬çš„æ—¶å€™éƒ½ä¼šæ‰§è¡Œå¯¹åº”çš„é’©å­è¿›è¡Œç›¸å…³å¤„ç†ã€‚</p> <p>ï¼ˆ2ï¼‰ä¼˜åŒ–<br>
ä¼˜åŒ–è¿‡ç¨‹å°±æ˜¯æ·±åº¦éå† AST æ ‘ï¼ŒæŒ‰ç…§ç›¸å…³æ¡ä»¶å¯¹æ ‘èŠ‚ç‚¹è¿›è¡Œæ ‡è®°ã€‚è¿™äº›è¢«æ ‡è®°çš„èŠ‚ç‚¹è¢«ç§°ä¸º(staticRenderFnsï¼‰ é™æ€èŠ‚ç‚¹ï¼Œå¯ä»¥ä¸éœ€å“åº”å¼çš„ç»“ç‚¹)ã€‚<br>
è¿™æ˜¯ Vue åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­çš„ä¸€å¤„ä¼˜åŒ–ï¼Œåé¢å½“ update æ›´æ–°ç•Œé¢æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ª patch çš„è¿‡ç¨‹ï¼Œ diff ç®—æ³•ä¼šç›´æ¥è·³è¿‡é™æ€èŠ‚ç‚¹ï¼Œä»è€Œå‡å°‘äº†æ¯”è¾ƒçš„è¿‡ç¨‹ï¼Œä¼˜åŒ–äº† patch çš„æ€§èƒ½ã€‚</p> <p>ï¼ˆ3ï¼‰ç¼–è¯‘<br>
å°† AST è½¬åŒ–æˆ render function å­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼Œå¾—åˆ°ç»“æœæ˜¯ render çš„å­—ç¬¦ä¸²ä»¥åŠ staticRenderFns å­—ç¬¦ä¸²ã€‚</p> <h2 id="_004-æ¨¡æ¿ç¼–è¯‘åŸç†"><a href="#_004-æ¨¡æ¿ç¼–è¯‘åŸç†" class="header-anchor">#</a> 004ï¼š æ¨¡æ¿ç¼–è¯‘åŸç†</h2> <ul><li>è§£æ html å¹¶ç”Ÿæˆ AST è¯­æ³•æ ‘ï¼›</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/compiler/parse.js</span>

<span class="token comment">// ä»¥ä¸‹ä¸ºæºç çš„æ­£åˆ™  å¯¹æ­£åˆ™è¡¨è¾¾å¼ä¸æ¸…æ¥šçš„åŒå­¦å¯ä»¥å‚è€ƒå°ç¼–ä¹‹å‰å†™çš„æ–‡ç« (å‰ç«¯è¿›é˜¶é«˜è–ªå¿…çœ‹ - æ­£åˆ™ç¯‡);</span>
<span class="token keyword">const</span> ncname <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[a-zA-Z_][\\-\\.0-9_a-zA-Z]*</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span> <span class="token comment">//åŒ¹é…æ ‡ç­¾å å½¢å¦‚ abc-123</span>
<span class="token keyword">const</span> qnameCapture <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">((?:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ncname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\:)?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ncname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span> <span class="token comment">//åŒ¹é…ç‰¹æ®Šæ ‡ç­¾ å½¢å¦‚ abc:234 å‰é¢çš„abc:å¯æœ‰å¯æ— </span>
<span class="token keyword">const</span> startTagOpen <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">^&lt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>qnameCapture<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åŒ¹é…æ ‡ç­¾å¼€å§‹ å½¢å¦‚ &lt;abc-123 æ•è·é‡Œé¢çš„æ ‡ç­¾å</span>
<span class="token keyword">const</span> startTagClose <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\s*(\/?)&gt;</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span> <span class="token comment">// åŒ¹é…æ ‡ç­¾ç»“æŸ  &gt;</span>
<span class="token keyword">const</span> endTag <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">^&lt;\\/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>qnameCapture<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">[^&gt;]*&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åŒ¹é…æ ‡ç­¾ç»“å°¾ å¦‚ &lt;/abc-123&gt; æ•è·é‡Œé¢çš„æ ‡ç­¾å</span>
<span class="token keyword">const</span> attribute <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\s*([^\s&quot;'&lt;&gt;\/=]+)(?:\s*(=)\s*(?:&quot;([^&quot;]*)&quot;+|'([^']*)'+|([^\s&quot;'=&lt;&gt;`]+)))?</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span> <span class="token comment">// åŒ¹é…å±æ€§  å½¢å¦‚ id=&quot;app&quot;</span>

<span class="token comment">// matchç”¨æ³•ï¼š</span>
<span class="token comment">//  let str=&quot;antzone&quot;;  console.log(str.match(&quot;n&quot;));   è¿”å›[&quot;n&quot;, index: 1, input: &quot;antzone&quot;, groups: undefined]</span>
<span class="token comment">// ï¼ˆ2ï¼‰æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯matchæ–¹æ³•é¦–æ¬¡åŒ¹é…åˆ°çš„å­å­—ç¬¦ä¸²ï¼Œ&quot;antzone&quot;è™½ç„¶æœ‰å¤šä¸ª&quot;n&quot;ï¼Œä½†æ˜¯è¿”å›çš„æ•°ç»„åªå­˜å‚¨é¦–æ¬¡åŒ¹é…åˆ°çš„&quot;n&quot;ï¼Œå¦‚æœmatchæ–¹æ³•çš„å‚æ•°æ˜¯å…¨å±€åŒ¹é…çš„æ­£åˆ™ï¼Œå°†ä¼šå­˜å‚¨æ‰€æœ‰çš„åŒ¹é…åˆ°çš„å­å­—ç¬¦ä¸²ã€‚</span>
<span class="token comment">// ï¼ˆ3ï¼‰indexå±æ€§å€¼è¿”å›é¦–æ¬¡åŒ¹é…åˆ°å­å­—ç¬¦ä¸²çš„ä½ç½®ã€‚</span>
<span class="token comment">// ï¼ˆ4ï¼‰inputå±æ€§å€¼æ˜¯åŸå­—ç¬¦ä¸²&quot;antzone&quot;ã€‚</span>
<span class="token comment">//  https://www.cnblogs.com/ranyonsue/p/10757567.html</span>

<span class="token keyword">let</span> root<span class="token punctuation">,</span> currentParent<span class="token punctuation">;</span> <span class="token comment">//ä»£è¡¨æ ¹èŠ‚ç‚¹ å’Œå½“å‰çˆ¶èŠ‚ç‚¹</span>
<span class="token comment">// æ ˆç»“æ„ æ¥è¡¨ç¤ºå¼€å§‹å’Œç»“æŸæ ‡ç­¾</span>
<span class="token keyword">let</span> stack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// æ ‡è¯†å…ƒç´ å’Œæ–‡æœ¬type</span>
<span class="token keyword">const</span> <span class="token constant">ELEMENT_TYPE</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">TEXT_TYPE</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment">// ç”Ÿæˆastæ–¹æ³•</span>
<span class="token keyword">function</span> <span class="token function">createASTElement</span><span class="token punctuation">(</span><span class="token parameter">tagName<span class="token punctuation">,</span> attrs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">tag</span><span class="token operator">:</span> tagName<span class="token punctuation">,</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">ELEMENT_TYPE</span><span class="token punctuation">,</span>
        <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        attrs<span class="token punctuation">,</span>
        <span class="token literal-property property">parent</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¯¹å¼€å§‹æ ‡ç­¾è¿›è¡Œå¤„ç†</span>
<span class="token keyword">function</span> <span class="token function">handleStartTag</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> tagName<span class="token punctuation">,</span> attrs <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> element <span class="token operator">=</span> <span class="token function">createASTElement</span><span class="token punctuation">(</span>tagName<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;å°†åŒ¹é…ä¸Šçš„matchç”Ÿæˆast&quot;</span><span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>root<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        root <span class="token operator">=</span> element<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    currentParent <span class="token operator">=</span> element<span class="token punctuation">;</span>
    stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&quot;astæ¨å…¥æ ˆ&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>stack<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¯¹ç»“æŸæ ‡ç­¾è¿›è¡Œå¤„ç†</span>
<span class="token keyword">function</span> <span class="token function">handleEndTag</span><span class="token punctuation">(</span><span class="token parameter">tagName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ ˆç»“æ„ []</span>
    <span class="token comment">// æ¯”å¦‚ &lt;div&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt; å½“é‡åˆ°ç¬¬ä¸€ä¸ªç»“æŸæ ‡ç­¾&lt;/span&gt;æ—¶ ä¼šåŒ¹é…åˆ°æ ˆé¡¶&lt;span&gt;å…ƒç´ å¯¹åº”çš„ast å¹¶å–å‡ºæ¥</span>
    <span class="token keyword">let</span> element <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å½“å‰çˆ¶å…ƒç´ å°±æ˜¯æ ˆé¡¶çš„ä¸Šä¸€ä¸ªå…ƒç´  åœ¨è¿™é‡Œå°±ç±»ä¼¼div</span>
    currentParent <span class="token operator">=</span> stack<span class="token punctuation">[</span>stack<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// å»ºç«‹parentå’Œchildrenå…³ç³»</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>currentParent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span>parent <span class="token operator">=</span> currentParent<span class="token punctuation">;</span>
        currentParent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¯¹æ–‡æœ¬è¿›è¡Œå¤„ç†</span>
<span class="token keyword">function</span> <span class="token function">handleChars</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å»æ‰ç©ºæ ¼</span>
    text <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\s</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        currentParent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">TEXT_TYPE</span><span class="token punctuation">,</span>
            text<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// è§£ææ ‡ç­¾ç”Ÿæˆastæ ¸å¿ƒ</span>
<span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token parameter">html</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>html<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æŸ¥æ‰¾&lt;</span>
        <span class="token keyword">let</span> textEnd <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœ&lt;åœ¨ç¬¬ä¸€ä¸ª é‚£ä¹ˆè¯æ˜æ¥ä¸‹æ¥å°±æ˜¯ä¸€ä¸ªæ ‡ç­¾ ä¸ç®¡æ˜¯å¼€å§‹è¿˜æ˜¯ç»“æŸæ ‡ç­¾</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>textEnd <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœå¼€å§‹æ ‡ç­¾è§£ææœ‰ç»“æœ</span>
            <span class="token keyword">const</span> startTagMatch <span class="token operator">=</span> <span class="token function">parseStartTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>startTagMatch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// æŠŠè§£æå¥½çš„æ ‡ç­¾åå’Œå±æ€§è§£æç”Ÿæˆast</span>
                <span class="token function">handleStartTag</span><span class="token punctuation">(</span>startTagMatch<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// åŒ¹é…ç»“æŸæ ‡ç­¾&lt;/</span>
            <span class="token keyword">const</span> endTagMatch <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>endTag<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">&quot;åŒ¹é…endMAtch&quot;</span><span class="token punctuation">,</span> endTagMatch<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>endTagMatch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">advance</span><span class="token punctuation">(</span>endTagMatch<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">handleEndTag</span><span class="token punctuation">(</span>endTagMatch<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">let</span> text<span class="token punctuation">;</span>
        <span class="token comment">// å½¢å¦‚ 3333&lt;/span&gt;&lt;/div&gt;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>textEnd <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// è·å–æ–‡æœ¬</span>
            text <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> textEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">advance</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">handleChars</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åŒ¹é…å¼€å§‹æ ‡ç­¾</span>
    <span class="token keyword">function</span> <span class="token function">parseStartTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> start <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>startTagOpen<span class="token punctuation">)</span><span class="token punctuation">;</span>

        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> html<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>startTagOpen<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// start: [&quot;&lt;div&quot;, &quot;div&quot;, index: 0, input: &quot;&lt;div id=&quot;div1&quot;&gt;&lt;span&gt;3333&lt;/span&gt;&lt;/div&gt;&quot;, groups: undefined]</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>start<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> match <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">tagName</span><span class="token operator">:</span> start<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token literal-property property">attrs</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token comment">//åŒ¹é…åˆ°äº†å¼€å§‹æ ‡ç­¾ å°±æˆªå–æ‰ï¼Œæ–¹ä¾¿åç»­å‰©ä¸‹å­—ç¬¦çš„å…¶ä»–æ“ä½œ</span>
            <span class="token function">advance</span><span class="token punctuation">(</span>start<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// å¼€å§‹åŒ¹é…å±æ€§</span>
            <span class="token comment">// endä»£è¡¨ç»“æŸç¬¦å·&gt;  å¦‚æœä¸æ˜¯åŒ¹é…åˆ°äº†ç»“æŸæ ‡ç­¾</span>
            <span class="token comment">// attr è¡¨ç¤ºåŒ¹é…çš„å±æ€§</span>
            <span class="token comment">// ä¸æ–­åŒ¹é…ï¼Œç›´åˆ°attråŒ¹é…å®Œæˆ–è€…endè¢«åŒ¹é…ä¸Šäº†</span>
            <span class="token keyword">let</span> end<span class="token punctuation">,</span> attr<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>
                <span class="token operator">!</span><span class="token punctuation">(</span>end <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>startTagClose<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                <span class="token punctuation">(</span>attr <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>attribute<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> end<span class="token punctuation">,</span> attr<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// null, [&quot; id=&quot;div1&quot;&quot;, &quot;id&quot;, &quot;=&quot;, &quot;div1&quot;, undefined, undefined, index: 0, input: &quot; id=&quot;div1&quot;&gt;&lt;span&gt;3333&lt;/span&gt;&lt;/div&gt;&quot;, groups: undefined]</span>

                <span class="token function">advance</span><span class="token punctuation">(</span>attr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>

                attr <span class="token operator">=</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">name</span><span class="token operator">:</span> attr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">value</span><span class="token operator">:</span> attr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">||</span> attr<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">||</span> attr<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//è¿™é‡Œæ˜¯å› ä¸ºæ­£åˆ™æ•è·æ”¯æŒåŒå¼•å· å•å¼•å· å’Œæ— å¼•å·çš„å±æ€§å€¼</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>

                match<span class="token punctuation">.</span>attrs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>attr<span class="token punctuation">)</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> match<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
                    <span class="token number">3</span><span class="token punctuation">,</span>
                    end<span class="token punctuation">,</span>
                    <span class="token string">&quot;å¦‚æœåŒ¹é…åˆ°äº†startTagCloseè¿”å›match&quot;</span><span class="token punctuation">,</span>
                    match
                <span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//   ä»£è¡¨ä¸€ä¸ªæ ‡ç­¾åŒ¹é…åˆ°ç»“æŸçš„&gt;äº† ä»£è¡¨å¼€å§‹æ ‡ç­¾è§£æå®Œæ¯•</span>
                <span class="token function">advance</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> match<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//æˆªå–htmlå­—ç¬¦ä¸² æ¯æ¬¡åŒ¹é…åˆ°äº†å°±å¾€å‰ç»§ç»­åŒ¹é…</span>
    <span class="token keyword">function</span> <span class="token function">advance</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        html <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//   è¿”å›ç”Ÿæˆçš„ast</span>
    <span class="token keyword">return</span> root<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// æµ‹è¯•ä¾‹å­</span>
<span class="token keyword">const</span> template <span class="token operator">=</span>
    <span class="token string">'&lt;div id=&quot;div1&quot; class=&quot;test&quot;&gt;&lt;span&gt;3333&lt;/span&gt;&lt;input type=&quot;text&quot;/&gt;&lt;/div&gt;'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">parse</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>æ ¹æ® AST ç”Ÿæˆä»£ç ï¼›</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/compiler/codegen.js</span>
<span class="token keyword">const</span> defaultTagRE <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\{\{((?:.|\\n)+?)\}\}</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span> <span class="token comment">//åŒ¹é…èŠ±æ‹¬å· {{  }} æ•è·èŠ±æ‹¬å·é‡Œé¢çš„å†…å®¹</span>

<span class="token keyword">function</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ¤æ–­èŠ‚ç‚¹ç±»å‹</span>
    <span class="token comment">// ä¸»è¦åŒ…å«å¤„ç†æ–‡æœ¬æ ¸å¿ƒ</span>
    <span class="token comment">// æºç è¿™å—åŒ…å«äº†å¤æ‚çš„å¤„ç†  æ¯”å¦‚ v-once v-for v-if è‡ªå®šä¹‰æŒ‡ä»¤ slotç­‰ç­‰  å’±ä»¬è¿™é‡Œåªè€ƒè™‘æ™®é€šæ–‡æœ¬å’Œå˜é‡è¡¨è¾¾å¼{{}}çš„å¤„ç†</span>

    <span class="token comment">// å¦‚æœæ˜¯å…ƒç´ ç±»å‹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//   é€’å½’åˆ›å»º</span>
        <span class="token keyword">return</span> <span class="token function">generate</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">//   å¦‚æœæ˜¯æ–‡æœ¬èŠ‚ç‚¹</span>
        <span class="token keyword">let</span> text <span class="token operator">=</span> node<span class="token punctuation">.</span>text<span class="token punctuation">;</span>

        <span class="token comment">// ä¸å­˜åœ¨èŠ±æ‹¬å·å˜é‡è¡¨è¾¾å¼</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
            <span class="token string">&quot;1 åˆ¤æ–­æœ‰æ²¡æœ‰åŒ¹é…ä¸Šè¡¨è¾¾å¼{{}}&quot;</span><span class="token punctuation">,</span>
            text<span class="token punctuation">,</span>
            defaultTagRE<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> hasExp <span class="token operator">=</span> <span class="token operator">!</span>defaultTagRE<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hasExp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
                <span class="token string">&quot;1-1 æ²¡åŒ¹é…ä¸Šè¡¨è¾¾å¼{{}} é€šè¿‡_v&quot;</span><span class="token punctuation">,</span>
                text<span class="token punctuation">,</span>
                <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_v(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// æ­£åˆ™æ˜¯å…¨å±€æ¨¡å¼ æ¯æ¬¡éœ€è¦é‡ç½®æ­£åˆ™çš„lastIndexå±æ€§  ä¸ç„¶ä¼šå¼•å‘åŒ¹é…bug</span>
        <span class="token keyword">let</span> lastIndex <span class="token operator">=</span> <span class="token punctuation">(</span>defaultTagRE<span class="token punctuation">.</span>lastIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> tokens <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> match<span class="token punctuation">,</span> index<span class="token punctuation">;</span>

        <span class="token comment">// execçš„ç”¨æ³•ï¼š</span>
        <span class="token comment">// var str = &quot;Visit W3School&quot;;  var patt = new RegExp(&quot;W3School&quot;,&quot;g&quot;); var result = patt.exec(str))</span>
        <span class="token comment">// console.log(result, patt.lastIndex)  =&gt;  W3School 14</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>match <span class="token operator">=</span> defaultTagRE<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// match : [&quot;{{myData}}&quot;, &quot;myData&quot;, index: 4, input: &quot;3333{{myData}}&quot;, groups: undefined]</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1-2 åŒ¹é…ä¸Šè¡¨è¾¾å¼{{}}&quot;</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> match<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// indexä»£è¡¨åŒ¹é…åˆ°çš„ä½ç½®</span>
            index <span class="token operator">=</span> match<span class="token punctuation">.</span>index<span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;</span> lastIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// åŒ¹é…åˆ°çš„{{ä½ç½®  åœ¨tokensé‡Œé¢æ”¾å…¥æ™®é€šæ–‡æœ¬</span>
                <span class="token comment">// æŠŠ '{{' ä¹‹å‰çš„æ–‡æœ¬æ¨å…¥</span>
                tokens<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>lastIndex<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
                    <span class="token string">&quot;2  æŠŠ{{ä¹‹å‰çš„æ–‡æœ¬æ¨å…¥&quot;</span><span class="token punctuation">,</span>
                    <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>lastIndex<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">[</span><span class="token operator">...</span>tokens<span class="token punctuation">]</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">//   æ”¾å…¥æ•è·åˆ°çš„å˜é‡å†…å®¹</span>
            tokens<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_s(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//   åŒ¹é…æŒ‡é’ˆåç§»</span>
            lastIndex <span class="token operator">=</span> index <span class="token operator">+</span> match<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// å¦‚æœåŒ¹é…å®Œäº†èŠ±æ‹¬å·  texté‡Œé¢è¿˜æœ‰å‰©ä½™çš„æ™®é€šæ–‡æœ¬ é‚£ä¹ˆç»§ç»­push</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>lastIndex <span class="token operator">&lt;</span> text<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            tokens<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>lastIndex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// _vè¡¨ç¤ºåˆ›å»ºæ–‡æœ¬</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_v(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tokens<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;+&quot;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å¤„ç†attrså±æ€§</span>
<span class="token keyword">function</span> <span class="token function">genProps</span><span class="token punctuation">(</span><span class="token parameter">attrs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> attrs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> attr <span class="token operator">=</span> attrs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// å¯¹attrså±æ€§é‡Œé¢çš„styleåšç‰¹æ®Šå¤„ç†</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>attr<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;style&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            attr<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            attr<span class="token punctuation">.</span>value <span class="token operator">=</span> obj<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        str <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>attr<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>attr<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>str<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ç”Ÿæˆå­èŠ‚ç‚¹ è°ƒç”¨genå‡½æ•°è¿›è¡Œé€’å½’åˆ›å»º</span>
<span class="token keyword">function</span> <span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> children <span class="token operator">=</span> el<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;0 è§£ææ¯ä¸ªchildren&quot;</span><span class="token punctuation">,</span> children<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">gen</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// é€’å½’åˆ›å»ºç”Ÿæˆcode</span>
<span class="token keyword">function</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> children <span class="token operator">=</span> <span class="token function">getChildren</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// _c( el.tag, {...el.attrs}, -v(æ–‡æœ¬å†…å®¹),  ...children)</span>
    <span class="token comment">// _cä»£è¡¨åˆ›å»ºå…ƒç´  _vä»£è¡¨åˆ›å»ºæ–‡æœ¬ _sä»£è¡¨æ–‡Json.stringify--æŠŠå¯¹è±¡è§£ææˆæ–‡æœ¬</span>
    <span class="token keyword">let</span> code <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_c('</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>el<span class="token punctuation">.</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
        el<span class="token punctuation">.</span>attrs<span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">genProps</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>attrs<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">&quot;undefined&quot;</span>
    <span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>children <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>children<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> code<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// astç”Ÿæˆcodeï¼š _c('div',{id:&quot;div1&quot;,class:&quot;test&quot;}, _v(&quot;13&quot;), _c('span',undefined,_v(&quot;3333{{myData}}&quot;)), _c('input',{type:&quot;text&quot;},_v(&quot;&gt;&quot;)))</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;astç”Ÿæˆcodeï¼š&quot;</span><span class="token punctuation">,</span> <span class="token function">generate</span><span class="token punctuation">(</span>astNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>æ ¹æ® code å­—ç¬¦ä¸²è½¬æˆ render å‡½æ•°</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">compileToFunctions</span><span class="token punctuation">(</span><span class="token parameter">template</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> code <span class="token operator">=</span> <span class="token function">generate</span><span class="token punctuation">(</span>ast<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ä½¿ç”¨withè¯­æ³•æ”¹å˜ä½œç”¨åŸŸä¸ºthis  ä¹‹åè°ƒç”¨renderå‡½æ•°å¯ä»¥ä½¿ç”¨callæ”¹å˜this æ–¹ä¾¿codeé‡Œé¢çš„å˜é‡å–å€¼ æ¯”å¦‚ nameå€¼å°±å˜æˆäº†this.name</span>
    <span class="token keyword">let</span> renderFn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">with(this){return </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>code<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> renderFn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>https://juejin.cn/post/6936024530016010276</p> <h2 id="_005-diff-ç®—æ³•"><a href="#_005-diff-ç®—æ³•" class="header-anchor">#</a> 005ï¼š diff ç®—æ³•</h2> <h2 id="_006-è™šæ‹Ÿ-dom-å®ç°åŸç†-æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹"><a href="#_006-è™šæ‹Ÿ-dom-å®ç°åŸç†-æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹" class="header-anchor">#</a> 006ï¼šè™šæ‹Ÿ DOM å®ç°åŸç†ï¼Œæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</h2> <p>è™šæ‹Ÿ DOM æœ¬è´¨æ˜¯é€šè¿‡ JS å¯¹è±¡æŠ½ç¦»å‡ºæ¨¡æ‹ŸçœŸå® DOM çš„ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼ŒåŒ…å«äº† tagã€propsã€children ä¸‰ä¸ªå±æ€§ã€‚(å¯¹åº”æºç ä¸­çš„ VNode ç±»ï¼Œå®ƒå®šä¹‰åœ¨ src/core/vdom/vnode.js ä¸­)</p> <p>è™šæ‹Ÿ DOM åœ¨ JS æ“æ§ DOM çš„è¿‡ç¨‹ä¸­è¿›è¡Œäº†ä¸€ä¸ªç¼“å­˜ã€‚</p> <p>ä½¿ç”¨çœŸå® DOM å¯¹æ›´æ–°çš„æ•°æ®é‡ç»˜æ•´ä¸ªè§†å›¾å±‚æ˜¯ç›¸å½“æ¶ˆè€—æ€§èƒ½ï¼Œé€šè¿‡è™šæ‹Ÿ DOM å’Œ diff ç®—æ³•å¾—å‡ºä¸€äº›éœ€è¦ä¿®æ”¹çš„æœ€å°å•ä½ï¼Œå¹¶å¯¹å°å•ä½çš„ä½å›¾ä½œå‡ºå¯¹åº”çš„æ›´æ–°ï¼Œè¿™æ ·å­å¯ä»¥å‡å°‘ä¸å¿…è¦çš„ DOM æ“ä½œï¼Œä»¥æ­¤æ¥æé«˜æ€§èƒ½ã€‚</p> <p>è™šæ‹Ÿ DOM çš„ä¼˜ç‚¹ï¼š1ï¼‰å¯¹ç²—æš´çš„ DOM æ“ä½œè¿›è¡Œä¸€ä¸ªç¼“å­˜ï¼Œæ€§èƒ½è¦å¥½ï¼›2ï¼‰æ— éœ€æ“ä½œ domï¼Œä»…éœ€å¤„ç†å¥½ ViewModel ä»£ç é€»è¾‘ï¼Œæ¡†æ¶ä¼šæ ¹æ®è™šæ‹Ÿ DOM å’Œæ•°æ®åŒå‘ç»‘å®šï¼Œæ›´æ–°è§†å›¾ï¼› 3ï¼‰å¯è·¨å¹³å°ï¼Œç”¨äºæœåŠ¡ç«¯æ¸²æŸ“å’Œ weex</p> <p>è™šæ‹Ÿ DOM çš„ç¼ºç‚¹ï¼šæ— æ³•è¿›è¡Œæè‡´ä¼˜åŒ–</p> <h2 id="_007-key-å±æ€§çš„ä½œç”¨"><a href="#_007-key-å±æ€§çš„ä½œç”¨" class="header-anchor">#</a> 007ï¼š key å±æ€§çš„ä½œç”¨</h2> <p>key çš„ä½œç”¨æ˜¯å°½å¯èƒ½çš„å¤ç”¨ DOM å…ƒç´ ã€‚</p> <p>diff æ¯”å¯¹æ—¶ï¼Œä¸€ä¸ªé‡è¦çš„å¯¹æ¯”æ–¹æ³• isSameNodeï¼Œä¸»è¦æ ¹æ® vnode çš„ tagã€key ä¸¤ä¸ªå±æ€§åˆ¤æ–­ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦ç›¸åŒ (isSameNode å‡½æ•°)ï¼Œé€‚å½“çš„ key é…ç½®èƒ½å¤Ÿæœ‰æ•ˆæé«˜ DOM å¤ç”¨ç‡ï¼Œé™ä½ DOM èŠ‚ç‚¹é‡å»ºé¢‘ç‡æ¥æé«˜è¿è¡Œæ€§èƒ½ã€‚</p> <p>åŒæ—¶åœ¨ updateChildren çš„é˜¶æ®µï¼Œkey ä¹Ÿå°±æ˜¯ children ä¸­èŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ã€‚é€šè¿‡ key å»ºç«‹æ–°æ—§ç»“ç‚¹çš„æ˜ å°„å…³ç³»ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨æ—§å­©å­ç»“ç‚¹ä¸­æ‰¾åˆ°å¯ä»¥å¤ç”¨çš„ç»“ç‚¹ï¼Œé™ä½é‡å»ºå¼€é”€ã€‚</p> <h2 id="_008-computedã€methodsã€-watch-åŒºåˆ«"><a href="#_008-computedã€methodsã€-watch-åŒºåˆ«" class="header-anchor">#</a> 008ï¼š computedã€methodsã€ watch åŒºåˆ«ï¼Ÿ</h2> <h4 id="methods"><a href="#methods" class="header-anchor">#</a> methods</h4> <p>ä¸å…·å¤‡ç¼“å­˜èƒ½åŠ›ï¼Œä¹Ÿéå“åº”å¼ï¼Œåªèƒ½æ˜¯ä½œä¸ºäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè¢«åŠ¨è°ƒç”¨ã€‚</p> <h4 id="computed"><a href="#computed" class="header-anchor">#</a> computed</h4> <p>1ï¼‰computed å¯ä»¥å½“ä½œä¸€ä¸ªå±æ€§æ¥ç”¨ï¼›</p> <p>2ï¼‰å…·æœ‰ç¼“å­˜èƒ½åŠ›ï¼Œé»˜è®¤ä¸æ‰§è¡Œé™¤éè¢«è®¿é—®ï¼›<br>
3ï¼‰å“åº”å¼çš„ï¼Œå½“å®ƒä¾èµ–çš„å±æ€§å˜åŒ–æ—¶ï¼Œå®ƒä¼šä¸»åŠ¨æ‰§è¡Œï¼Œè¿›è¡Œå“åº”å¼æ›´æ–°ã€‚</p> <ul><li><p>è®¡ç®—å±æ€§å…·æœ‰ç¼“å­˜åŸå› <br>
computedÂ  ä¼šæ‹¥æœ‰è‡ªå·±çš„ Â watcherã€‚</p> <p>åˆå§‹åŒ–æ—¶ä¼ å…¥ lazy å±æ€§è¡¨æ˜æ˜¯ computed å¯¹åº”çš„è®¢é˜…è€…ï¼Œlazy é¦–æ¬¡ä¸æ‰§è¡Œï¼Œç„¶åä¹Ÿä¼šå¯¹åº”ç”Ÿæˆä¸€ä¸ª dirty å±æ€§ï¼Œåˆå§‹å€¼ä¸º trueã€‚</p> <p>å®ƒå†…éƒ¨æœ‰ä¸ªå±æ€§ Â dirtyÂ  å¼€å…³æ¥å†³å®š Â computedÂ  çš„å€¼æ˜¯éœ€è¦é‡æ–°è®¡ç®—è¿˜æ˜¯ç›´æ¥å¤ç”¨ä¹‹å‰çš„å€¼ã€‚</p> <p>dirty æ‰“å¼€æ—¶ï¼Œä¼šè°ƒç”¨ watcher.evaluateï¼ˆé‡æ–°å»æ±‚å€¼ï¼Œåå…³é—­ dirtyï¼‰ï¼Œå¦åˆ™è¿”å›æ—§å€¼ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨ sum ç¬¬ä¸€æ¬¡è¿›è¡Œæ±‚å€¼çš„æ—¶å€™ä¼šè¯»å–å“åº”å¼å±æ€§ countï¼Œæ”¶é›†åˆ°è¿™ä¸ªå“åº”å¼æ•°æ®ä½œä¸ºä¾èµ–ã€‚å¹¶ä¸”è®¡ç®—å‡ºä¸€ä¸ªå€¼æ¥ä¿å­˜åœ¨è‡ªèº«çš„ value ä¸Šï¼ŒæŠŠ dirty è®¾ä¸º falseï¼Œæ¥ä¸‹æ¥åœ¨æ¨¡æ¿é‡Œå†è®¿é—® sum å°±ç›´æ¥è¿”å›è¿™ä¸ªæ±‚å¥½çš„å€¼ valueï¼Œå¹¶ä¸è¿›è¡Œé‡æ–°çš„æ±‚å€¼ã€‚</p> <p>è€Œ count å‘ç”Ÿå˜åŒ–äº†ä»¥åä¼šé€šçŸ¥ sum æ‰€å¯¹åº”çš„ watcher æŠŠè‡ªèº«çš„ dirty å±æ€§è®¾ç½®æˆ trueï¼Œè¿™ä¹Ÿå°±ç›¸å½“äºæŠŠé‡æ–°æ±‚å€¼çš„å¼€å…³æ‰“å¼€æ¥äº†ã€‚è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œåªæœ‰ count å˜åŒ–äº†ï¼Œ sum æ‰éœ€è¦é‡æ–°å»æ±‚å€¼ã€‚</p> <p>é‚£ä¹ˆä¸‹æ¬¡æ¨¡æ¿ä¸­å†è®¿é—®åˆ° this.sum çš„æ—¶å€™ï¼Œæ‰ä¼šçœŸæ­£çš„å»é‡æ–°è°ƒç”¨ sum å‡½æ•°æ±‚å€¼ï¼Œå¹¶ä¸”å†æ¬¡æŠŠ dirty è®¾ç½®ä¸º falseï¼Œç­‰å¾…ä¸‹æ¬¡çš„å¼€å¯â€¦â€¦</p></li> <li><p>è®¡ç®—å±æ€§å¦‚ä½•æ”¶é›†ä¾èµ–<br>
å½“ computed ä½œä¸ºä¸€ä¸ªå±æ€§è¢«ä½¿ç”¨æ—¶ä¼šä¸ºä»–æ”¶é›†ä¾èµ–ï¼Œå…¶å®å®ƒä¾èµ–äº data å±æ€§å˜åŒ–è€Œå˜åŒ–ï¼Œå› æ­¤å¸® computed æ”¶é›†ä¾èµ–ç›¸å¯¹äºå¸®æ‰€ä¾èµ–çš„ data å±æ€§æ”¶é›†ä¾èµ–ï¼Œæ‰€ä»¥è¿™ä¸ª watcher å¯¹è±¡é‡Œé¢ä¼šç»´æŠ¤ä¸€ä¸ª dep å­˜å‚¨ç»™å“ªäº›å‘å¸ƒè€…æ‰€è®¢é˜…äº†ï¼Œç„¶åä¸ºä¾èµ–å±æ€§ dep ä¸­æ”¾å…¥è‡ªå·±è¿™ä¸ª watcherã€‚</p> <p>computed åœ¨ç»„ä»¶å†…æ™®é€‚æ€§æ›´å¼ºï¼Œå› æ­¤é€‚ç”¨äºå¤æ‚çš„æ•°æ®è½¬æ¢ã€ç»Ÿè®¡ç­‰åœºæ™¯ï¼›ä¸€ä¸ªæ•°æ®å—å¤šä¸ªæ•°æ®å½±å“æ—¶ä½¿ç”¨ã€‚</p></li></ul> <h4 id="watch"><a href="#watch" class="header-anchor">#</a> watch</h4> <p>1ï¼‰åˆå§‹åŒ–æ—¶é»˜è®¤ä¼šæ‰§è¡Œä¸€æ¬¡<br>
2ï¼‰å“åº”å¼çš„ï¼Œå±æ€§ä¸€å˜åŒ–å°±ä¼šè§¦å‘å¯¹åº”çš„å›è°ƒå‡½æ•°<br>
3ï¼‰ä¸€èˆ¬ä¸€ä¸ªæ•°æ®å½±å“å¤šä¸ªæ•°æ®æ—¶ä½¿ç”¨</p> <p>4ï¼‰å½“éœ€æ·±åº¦ç›‘å¬æ—¶ï¼Œå¯è®¾ç½®<code>deepï¼štrue</code>ï¼Œè¿™æ ·ä¾¿ä¼šå¯¹å¯¹è±¡æ¯ä¸€é¡¹å±æ€§è¿›è¡Œç›‘å¬ã€‚ä½†æ˜¯è¿™æ ·ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ï¼Œä¼˜åŒ–çš„è¯å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å½¢å¼ç›‘å¬ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ä¼˜åŒ–å‰</span>
<span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">obj</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'obj has changed to '</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">immediate</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">deep</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä¼˜åŒ–å</span>
<span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'obj.a'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'obj.a has changed to '</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">immediate</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>computed å’Œ watch çš„åº”ç”¨åœºæ™¯ï¼š<br>
å½“æˆ‘ä»¬éœ€è¦è¿›è¡Œæ•°å€¼è®¡ç®—ï¼Œå¹¶ä¸”ä¾èµ–äºå…¶å®ƒæ•°æ®æ—¶ï¼Œåº”è¯¥ä½¿ç”¨ computedï¼Œå¯åˆ©ç”¨ computed çš„ç¼“å­˜ç‰¹æ€§ï¼Œé¿å…æ¯æ¬¡è·å–å€¼æ—¶éƒ½é‡æ–°è®¡ç®—ï¼›</p> <p>å½“æˆ‘ä»¬éœ€è¦åœ¨æ•°æ®å˜åŒ–æ—¶æ‰§è¡Œå¼‚æ­¥æˆ–å¼€é”€è¾ƒå¤§çš„æ“ä½œæ—¶ï¼Œåº”è¯¥ä½¿ç”¨ watchï¼Œä½¿ç”¨ watch é€‰é¡¹å…è®¸æˆ‘ä»¬æ‰§è¡Œå¼‚æ­¥æ“ä½œ ( è®¿é—®ä¸€ä¸ª API )ï¼Œé™åˆ¶æˆ‘ä»¬æ‰§è¡Œè¯¥æ“ä½œçš„é¢‘ç‡ï¼Œå¹¶åœ¨æˆ‘ä»¬å¾—åˆ°æœ€ç»ˆç»“æœå‰ï¼Œè®¾ç½®ä¸­é—´çŠ¶æ€ã€‚è¿™äº›éƒ½æ˜¯è®¡ç®—å±æ€§æ— æ³•åšåˆ°çš„ã€‚</p> <p>https://blog.csdn.net/weixin_46837985/article/details/106632342</p> <p>https://www.imooc.com/article/14466</p> <p>https://segmentfault.com/a/1190000021761594</p> <h2 id="_009-filters-ä¸-computed-çš„åŒºåˆ«ä¸ç”¨æ³•"><a href="#_009-filters-ä¸-computed-çš„åŒºåˆ«ä¸ç”¨æ³•" class="header-anchor">#</a> 009ï¼š filters ä¸ computed çš„åŒºåˆ«ä¸ç”¨æ³•</h2> <h4 id="filters"><a href="#filters" class="header-anchor">#</a> filters</h4> <p>1ï¼‰ä¸å…·å¤‡ç¼“å­˜å’Œå“åº”åŠŸèƒ½ï¼Œæ˜¾å¼è°ƒç”¨æ—¶è§¦å‘ï¼Œä¸€èˆ¬åº”ç”¨åœ¨æ¨¡æ¿æ¸²æŸ“ä¸Šã€‚</p> <p>2ï¼‰ä¼˜ç‚¹æ˜¯å¯é“¾å¼è°ƒç”¨ï¼Œå®¹æ˜“åœ¨ç»„ä»¶å¤–æŠ½è±¡ï¼›<br>
ç¼ºç‚¹æ˜¯æ¯æ¬¡æ¨¡æ¿æ¸²æŸ“æ—¶éƒ½éœ€è¦é‡æ–°æ‰§è¡Œè®¡ç®—</p> <p>3ï¼‰filter æœ‰ä¸¤ç§å®šä¹‰æ–¹å¼ï¼š<br>
ä¸€æ˜¯åœ¨ç»„ä»¶å†…éƒ¨é€šè¿‡ filters å±æ€§å®šä¹‰ï¼›<br>
ä¸€æ˜¯åœ¨ç»„ä»¶å¤–éƒ¨é€šè¿‡ Vue.filter å‡½æ•°å®šä¹‰ï¼š</p> <h2 id="_010-v-show-ä¸-v-if-åŒºåˆ«"><a href="#_010-v-show-ä¸-v-if-åŒºåˆ«" class="header-anchor">#</a> 010ï¼š v-show ä¸ v-if åŒºåˆ«ï¼Ÿ</h2> <ul><li><p><code>v-if</code> æ˜¯çœŸæ­£çš„æ¡ä»¶æ¸²æŸ“ï¼Œæ ¹æ®åˆ¤æ–­æ¡ä»¶æ¥åŠ¨æ€çš„è¿›è¡Œå¢åˆ  DOM å…ƒç´ ã€‚å¦‚æœåˆå§‹æ¸²æŸ“æ—¶æ¡ä»¶ä¸ºå‡åˆ™ä»€ä¹ˆéƒ½ä¸åšï¼Œç›´è‡³æ¡ä»¶ä¸ºçœŸæ—¶æ‰å¼€å§‹æ¸²æŸ“ã€‚</p></li> <li><p><code>v-show</code> ä¸ç®¡åˆå§‹æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Œå…ƒç´ æ€»ä¼šè¢«æ¸²æŸ“ï¼Œé€šè¿‡<code>display: none</code>éšè—èµ·æ¥ã€‚</p></li></ul> <p>v-if é€‚ç”¨äºåœ¨è¿è¡Œæ—¶å¾ˆå°‘æ”¹å˜æ¡ä»¶ï¼Œä¸éœ€è¦é¢‘ç¹åˆ‡æ¢æ¡ä»¶çš„åœºæ™¯ï¼›v-show åˆ™é€‚ç”¨äºéœ€è¦éå¸¸é¢‘ç¹åˆ‡æ¢æ¡ä»¶çš„åœºæ™¯ã€‚</p> <h2 id="_011-vue-js-åŒå‘ç»‘å®šåŸç†"><a href="#_011-vue-js-åŒå‘ç»‘å®šåŸç†" class="header-anchor">#</a> 011ï¼š Vue.js åŒå‘ç»‘å®šåŸç†</h2> <p>Vue åŒå‘ç»‘å®šæ˜¯æŒ‡æ•°æ®ï¼ˆModelï¼‰å’Œè§†å›¾ï¼ˆViewï¼‰åŒæ­¥æ›´æ–°çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œå³æ•°æ®ä» DOM åˆ° JS å’Œä» JS åˆ° DOM ç›‘æµ‹å¹¶åŒæ­¥æ›´æ–°çš„è¿‡ç¨‹ã€‚</p> <p>ä» DOM åˆ° JS çš„è¿‡ç¨‹é€šå¸¸ç”¨ addEventListener å»ç›‘æµ‹ DOM çš„äº‹ä»¶è¡Œä¸ºè¿›è€Œè§¦å‘ JS çš„æ•°æ®å˜åŒ–ã€‚</p> <p>é‚£å¦‚ä½•æ£€æµ‹ JS æ•°æ®å¯¹è±¡å±æ€§å‘ç”Ÿå˜åŒ– è¿›è€ŒåŒæ­¥æ›´æ–°è§†å›¾å‘¢ï¼Ÿ</p> <p>è¿™ä¸ªä¸»è¦é‡‡ç”¨<strong>æ•°æ®åŠ«æŒ</strong>ç»“åˆ<strong>å‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼</strong>çš„æ–¹å¼ï¼Œé€šè¿‡<code>Object.defineProperty()</code>æ¥åŠ«æŒå„ä¸ªå±æ€§çš„ setterï¼Œgetterï¼Œåœ¨æ•°æ®å˜åŠ¨æ—¶å‘å¸ƒæ¶ˆæ¯ç»™è®¢é˜…è€…ï¼Œç„¶åè§¦å‘ç›¸åº”çš„ç›‘å¬å›è°ƒã€‚</p> <ol><li>ç¬¬ä¸€æ­¥ï¼Œåœ¨ç»„ä»¶åˆå§‹åŒ–ï¼Œé€šè¿‡ Observer(æ•°æ®ç›‘å¬å™¨)ï¼Œéå† data é‡Œé¢çš„æ¯ä¸ªå±æ€§å¯¹è±¡ï¼Œä¸ºä»–ä»¬ç»‘å®šä¸€ä¸ªä¸“ç”¨çš„ Dep å¯¹è±¡ï¼ˆå‘å¸ƒè€…ï¼‰ï¼Œå¹¶ä¸”é€šè¿‡ <code>Object.defineProperty</code> é‡å†™æ•°æ®çš„ getter å’Œ setterï¼ŒåŠ«æŒç›‘å¬å±æ€§ã€‚</li></ol> <p>getter ä¼šæ”¶é›†ä¾èµ–ï¼ŒSetter ä¼šæ›´æ–°ä¾èµ–ï¼Œåœ¨å±æ€§æ›´æ–°åè§¦å‘ dep.notify å»é€šçŸ¥æ‰€æœ‰ä¾èµ–ã€‚</p> <ol start="2"><li><p>ç¬¬äºŒæ­¥ï¼Œä¼šå¯¹ propsã€computedã€watch åˆ›å»º watcherï¼š<br>
1ï¼‰è°ƒç”¨ initComputed ï¼Œå°† computed å±æ€§è½¬åŒ–ä¸º watcher å®ä¾‹ï¼›<br>
2ï¼‰è°ƒç”¨ initWatcherï¼Œå°† watcher é…ç½®å±æ€§è½¬åŒ–ä¸º watcher å®ä¾‹ï¼›<br>
3ï¼‰è°ƒç”¨ mountComponentï¼Œå°† render å‡½æ•°ç»‘å®š watcher å®ä¾‹ï¼›</p> <p>å…¶ä¸­ï¼ŒWatcher è¦åšçš„äº‹æƒ…ï¼š<br>
1ï¼‰å¼ºåˆ¶æ‰§è¡Œ getterï¼ŒæŠŠè‡ªå·±æ·»åŠ è¿›å±æ€§è®¢é˜…æ± é‡Œï¼›<br>
2ï¼‰ç¼–å†™ update æ–¹æ³•ï¼Œåœ¨ dep.notify é‡Œè§¦å‘ watcher.update æ–¹æ³•åï¼ˆé€šè¿‡ compile ç»‘å®šçš„æ›´æ–°å›è°ƒï¼‰æ›´æ–°è§†å›¾ã€‚</p></li> <li><p>ç¬¬ä¸‰æ­¥ï¼Œé€šè¿‡ Compile éå†èŠ‚ç‚¹ï¼š<br>
1ï¼‰æ›¿æ¢æ¨¡ç‰ˆå˜é‡ï¼Œåˆå§‹åŒ–é¡µé¢ï¼›<br>
2ï¼‰å¯¹èŠ‚ç‚¹ç»‘å®šå‡½æ•°äº‹ä»¶ï¼ˆv-bind on-click..éå†æ‰€æœ‰èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹ï¼Œè¿›è¡Œæ‰«æè§£æç¼–è¯‘ï¼Œè°ƒç”¨å¯¹åº”çš„æŒ‡ä»¤æ¸²æŸ“å‡½æ•°è¿›è¡Œæ•°æ®æ¸²æŸ“ï¼Œå¹¶è°ƒç”¨å¯¹åº”æŒ‡ä»¤æ›´æ–°å‡½æ•°ï¼ˆvm.$options.methods[exp]ï¼‰è¿›è¡Œç»‘å®šï¼‰</p></li></ol> <h4 id="æ€ä¹ˆå®ç°å¯¹æ•°ç»„çš„ç›‘å¬"><a href="#æ€ä¹ˆå®ç°å¯¹æ•°ç»„çš„ç›‘å¬" class="header-anchor">#</a> æ€ä¹ˆå®ç°å¯¹æ•°ç»„çš„ç›‘å¬ï¼Ÿ</h4> <p>ä»¥ä¸‹æƒ…å†µ vue ä¼šå¯¹æ•°ç»„æ— æ³•ç›‘å¬ï¼š</p> <p>ï¼ˆ1ï¼‰åˆ©ç”¨ç´¢å¼•ç›´æ¥è®¾ç½®ä¸€ä¸ªæ•°ç»„é¡¹æ—¶ï¼Œä¾‹å¦‚ï¼švm.items[indexOfItem] = newValue<br>
ï¼ˆ2ï¼‰ä¿®æ”¹æ•°ç»„çš„é•¿åº¦æ—¶ï¼Œä¾‹å¦‚ï¼švm.items.length = newLength<br>
ï¼ˆ3ï¼‰pushã€pop ä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•ä¹Ÿä¸èƒ½è§¦å‘ setter</p> <p>vue ä¸»è¦é€šè¿‡ä¿®æ”¹é‡æ–°åŸå‹ä¸Šçš„ pushï¼Œpopï¼Œshiftï¼Œunshiftï¼Œsplice, sortï¼Œreverse ä¸ƒä¸ªæ–¹æ³•ï¼Œå»ç›‘å¬é€ æˆæ•°ç»„å˜åŒ–çš„æ–¹æ³•ï¼Œè§¦å‘è¿™ä¸ªæ–¹æ³•çš„åŒæ—¶å»è°ƒç”¨æŒ‚è½½å¥½çš„å“åº”é¡µé¢æ–¹æ³•ï¼Œè¾¾åˆ°é¡µé¢å“åº”å¼çš„æ•ˆæœã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç›‘å¬å‡½æ•°</span>

<span class="token comment">// è®°å½•åŸå§‹Arrayæœªé‡å†™ä¹‹å‰çš„APIåŸå‹æ–¹æ³•</span>
<span class="token keyword">const</span> arrayProto <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

<span class="token comment">// æ‹·è´ä¸€ä»½ä¸Šé¢çš„åŸå‹å‡ºæ¥</span>
<span class="token keyword">const</span> arrayMethods <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>arrayProto<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å°†è¦é‡å†™çš„æ–¹æ³•</span>
<span class="token keyword">const</span> methodsToPatch <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;push&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;pop&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;shift&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;unshift&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;splice&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;sort&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;reverse&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Intercept mutating methods and emit events
 */</span>
methodsToPatch<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">method</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">def</span><span class="token punctuation">(</span>arrayMethods<span class="token punctuation">,</span> method<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">mutator</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åŸæœ‰çš„æ•°ç»„æ–¹æ³•è°ƒç”¨æ‰§è¡Œ</span>
        <span class="token keyword">const</span> result <span class="token operator">=</span> arrayProto<span class="token punctuation">[</span>method<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> ob <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>__ob__<span class="token punctuation">;</span>

        <span class="token keyword">let</span> inserted<span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token string">&quot;push&quot;</span><span class="token operator">:</span>
            <span class="token keyword">case</span> <span class="token string">&quot;unshift&quot;</span><span class="token operator">:</span>
                inserted <span class="token operator">=</span> args<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">&quot;splice&quot;</span><span class="token operator">:</span>
                inserted <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// å¦‚æœæ˜¯æ’å…¥çš„æ•°æ®ï¼Œå°†å…¶å†æ¬¡ç›‘å¬èµ·æ¥</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>inserted<span class="token punctuation">)</span> ob<span class="token punctuation">.</span><span class="token function">observeArray</span><span class="token punctuation">(</span>inserted<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è§¦å‘è®¢é˜…ï¼Œåƒé¡µé¢æ›´æ–°å“åº”å°±åœ¨è¿™é‡Œè§¦å‘</span>
        ob<span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ”¹å˜æ•°ç»„é‡Œçš„å…ƒç´ ä¸èƒ½ç›‘å¬åˆ°ï¼Œä½†æ˜¯æ•°ç»„å†…çš„å€¼æ˜¯å¯¹è±¡ç±»å‹çš„ï¼Œä¿®æ”¹å®ƒä¾æ—§èƒ½å¾—åˆ°ç›‘å¬å“åº”</span>
<span class="token comment">// å¦‚æ”¹å˜list[0].valå¯ä»¥å¾—åˆ°ç›‘å¬ï¼Œä½†æ˜¯æ”¹å˜list[0]ä¸èƒ½ï¼Œä½†æ˜¯ä¾æ—§æ²¡æœ‰å¯¹æ•°ç»„æœ¬èº«çš„å˜åŒ–è¿›è¡Œç›‘å¬ã€‚</span>
<span class="token function">observeArray</span> <span class="token punctuation">(</span><span class="token parameter">items</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç›‘å¬æ•°ç»„å…ƒç´ </span>
    <span class="token function">observe</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="åŒå‘ç»‘å®šçš„å®ç°"><a href="#åŒå‘ç»‘å®šçš„å®ç°" class="header-anchor">#</a> åŒå‘ç»‘å®šçš„å®ç°</h4> <p>ğŸ‘‰ æ›´è¯¦ç»†çš„<a href="https://chieminchan.vercel.app/articles/Vue/Vue%20%E7%9A%84%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A.html" target="_blank" rel="noopener noreferrer">æˆ³æˆ‘<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_012-keep-alive-ç»„ä»¶æœ‰ä»€ä¹ˆä½œç”¨"><a href="#_012-keep-alive-ç»„ä»¶æœ‰ä»€ä¹ˆä½œç”¨" class="header-anchor">#</a> 012ï¼š keep-alive ç»„ä»¶æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h2> <p><code>&lt;keep-alive&gt;</code>æ˜¯ vue å†…ç½®çš„ä¸€ä¸ªç»„ä»¶ï¼Œä¸€èˆ¬ç»“åˆè·¯ç”±å’ŒåŠ¨æ€ç»„ä»¶ä¸€èµ·ä½¿ç”¨ï¼Œä¸»è¦ä½œç”¨æ˜¯ç¼“å­˜ç»„ä»¶ï¼Œä½¿è¢«åŒ…å«çš„ç»„ä»¶ä¿ç•™çŠ¶æ€ï¼Œé¿å…é‡æ–°æ¸²æŸ“åŠ è½½ã€‚</p> <p>å®ƒçš„ prop å±æ€§å€¼åˆ†åˆ«æœ‰ include å’Œ exclude ï¼Œåˆ†åˆ«è¡¨ç¤ºåªæœ‰åŒ¹é…åç§°çš„ç»„ä»¶éœ€è¦ç¼“å­˜å’Œä¸ä¼šè¢«ç¼“å­˜ã€‚ä¼˜å…ˆçº§ exclude è¾ƒé«˜ã€‚</p> <p>å¯¹åº”ä¸¤ä¸ªé’©å­å‡½æ•°ï¼šå½“ç»„ä»¶è¢«æ¿€æ´»æ—¶ï¼Œè§¦å‘é’©å­å‡½æ•° activatedï¼Œå½“ç»„ä»¶è¢«ç§»é™¤æ—¶ï¼Œè§¦å‘é’©å­å‡½æ•° deactivatedï¼Œä¸‹ä¸€æ¬¡è¿›å…¥æ—¶åªä¼šè§¦å‘ activatedã€‚</p> <blockquote><p>keep-alive çš„ä¸­è¿˜è¿ç”¨äº† LRU(Least Recently Used)ç®—æ³•ã€‚</p></blockquote> <h2 id="_013-vue-ç»„ä»¶é—´é€šä¿¡æœ‰å“ªå‡ ç§æ–¹å¼"><a href="#_013-vue-ç»„ä»¶é—´é€šä¿¡æœ‰å“ªå‡ ç§æ–¹å¼" class="header-anchor">#</a> 013ï¼š Vue ç»„ä»¶é—´é€šä¿¡æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ</h2> <p>https://www.cnblogs.com/mengfangui/p/9995470.html</p> <p>https://juejin.im/post/5d59f2a451882549be53b170#heading-16</p> <ul><li><p><code>prop / $emit</code> ï¼šé€‚åˆçˆ¶å­é—´é€šä¿¡</p></li> <li><p><code>ref / $parents / $children</code>ï¼š é€‚åˆçˆ¶å­é—´é€šä¿¡</p></li></ul> <p><code>ref = 'xxx'</code> è¢«ç”¨æ¥ç»™å…ƒç´ æˆ–å­ç»„ä»¶æ³¨å†Œå¼•ç”¨ä¿¡æ¯ã€‚å¼•ç”¨ä¿¡æ¯å°†ä¼šæ³¨å†Œåœ¨çˆ¶ç»„ä»¶çš„ <code>$refs</code> å¯¹è±¡ä¸Šã€‚å¦‚æœåœ¨æ™®é€šçš„ DOM å…ƒç´ ä¸Šä½¿ç”¨ï¼Œå¼•ç”¨æŒ‡å‘çš„å°±æ˜¯ DOM å…ƒç´ ï¼›å¦‚æœç”¨åœ¨å­ç»„ä»¶ä¸Šï¼Œå¼•ç”¨å°±æŒ‡å‘ç»„ä»¶å®ä¾‹ã€‚</p> <p><code>$parent / $children</code> åˆ†åˆ«æŒ‡å‘å½“å‰å®ä¾‹çš„ç›´æ¥çˆ¶ç»„ä»¶ï¼ˆå¦‚æœæ²¡æœ‰çˆ¶å®ä¾‹åˆ™æŒ‡å‘è‡ªå·±ï¼‰å’Œå­ç»„ä»¶ã€‚</p> <ul><li><code>eventBus ï¼ˆ$emit / $onï¼‰</code>ï¼šé€‚åˆä»»ä½•ç»„ä»¶é—´é€šä¿¡</li></ul> <p>å…¬å…±äº‹ä»¶æ€»çº¿<code>eventBus</code>çš„æœ¬è´¨æ˜¯åˆ›å»ºä¸€ä¸ªç©ºçš„ vue å®ä¾‹ä½œä¸ºæ¡¥æ¢ï¼ˆäº‹ä»¶ä¸­å¿ƒï¼‰ï¼Œå®ç°ä»»ä½•ç»„ä»¶é—´çš„é€šä¿¡ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æ³¨å†Œä¸€ä¸ªå…¨å±€çš„äº‹ä»¶æ€»çº¿</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$eventBus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å…„å¼Ÿç»„ä»¶Aï¼ˆAå‘é€aClickäº‹ä»¶ï¼‰</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$eventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;aClick&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;i am a msg from brotherA&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å…„å¼Ÿç»„ä»¶Bï¼ˆBç›‘å¬aClickäº‹ä»¶ï¼‰</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">&quot;aClick&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// å…„å¼ŸAå‘æ¥çš„äº‹ä»¶</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>msgFromA <span class="token operator">=</span> msg<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><code>$attrs / $listeners</code> é€‚åˆå¤šçº§åµŒå¥—ç»„ä»¶é—´é€šä¿¡ï¼ˆvue2.4 æ–°å¢å±æ€§ï¼‰</li></ul> <p><code>$attrs / $listeners</code> å¯ä½œä¸ºè§£å†³å¤šçº§ç»„ä»¶åµŒå¥—ï¼Œéœ€è¦ç»„ä»¶é€šè¿‡<code>prop</code>å’Œ<code>$emit</code>ä¸­è½¬æƒ…å†µçš„ä¼˜åŒ–æ–¹æ¡ˆã€‚</p> <p><code>$attrs</code> ç»§æ‰¿æ‰€æœ‰çš„çˆ¶ç»„ä»¶å±æ€§ï¼ˆé™¤äº†é€šè¿‡ prop ä¼ é€’çš„å±æ€§ã€class å’Œ styleï¼‰ï¼Œé€šå¸¸é…åˆ inheritAttrs é€‰é¡¹ä¸€èµ·ä½¿ç”¨ã€‚<code>inheritAttrsï¼štrue</code>æ—¶ï¼Œå­ç»„ä»¶å¯é€šè¿‡<code>$attrs</code>è·å–åˆ°é™¤ props ä¹‹å¤–çš„æ‰€æœ‰å±æ€§ï¼›<code>inheritAttrsï¼šfalse</code> åªç»§æ‰¿ class å±æ€§ã€‚</p> <p>çˆ¶ç»„ä»¶ A æŠŠå¾ˆå¤šæ•°æ®ä¼ ç»™å­ç»„ä»¶ Bï¼Œå­ç»„ä»¶ B åˆ©ç”¨<code>$attrs</code>æ”¶é›†èµ·æ¥ï¼Œç„¶åå¯ä»¥åˆ©ç”¨ <code>v-bind=&quot;$attrs&quot;</code> ä¼ ç»™ B çš„å­ç»„ä»¶ Cï¼ˆä¹Ÿå°±æ˜¯ A ç»„ä»¶çš„å­™ç»„ä»¶ï¼‰ï¼Œè¿™æ ·å°±ä¸ç”¨ä¸€ä¸ªä¸€ä¸ªå±æ€§å»ä¼ äº†ã€‚</p> <p><code>$listeners</code> ä¸ <code>$attrs</code> ç±»ä¼¼ï¼Œ<code>$listeners</code> ä¼ é€’çš„æ˜¯äº‹ä»¶ï¼Œå¯æ¥æ”¶é™¤äº†å¸¦ <code>.native</code> äº‹ä»¶ä¿®é¥°ç¬¦çš„æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨ï¼Œé€šè¿‡ <code>v-on=&quot;$listeners&quot;</code>å°†æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨ä¼ å…¥å½“å‰ç»„ä»¶çš„å†…éƒ¨ç»„ä»¶ã€‚å†…éƒ¨ç»„ä»¶å¯é€šè¿‡ <code>$emit</code> è§¦å‘äº‹ä»¶ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Father.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;father&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Child <span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">&quot;name&quot;</span> <span class="token operator">:</span>age<span class="token operator">=</span><span class="token string">&quot;age&quot;</span> <span class="token operator">:</span>weight<span class="token operator">=</span><span class="token string">&quot;weight&quot;</span> @updateInfo<span class="token operator">=</span><span class="token string">&quot;updateInfo&quot;</span> @click<span class="token punctuation">.</span>native<span class="token operator">=</span><span class="token string">'clickHandler'</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Child<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token keyword">import</span> Child <span class="token keyword">from</span> <span class="token string">'./Child.vue'</span><span class="token punctuation">;</span>

    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'father'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span> Child <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'father'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
                <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">50</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token function">updateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'father A: update info'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function">clickHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'father A: click handler'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token comment">// Son.vue</span>
 <span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;son&quot;</span><span class="token operator">&gt;</span>
        <span class="token comment">// son ç»„ä»¶å°†ç»§æ‰¿çˆ¶ä½œç”¨åŸŸçš„å±æ€§ä¼ è‡³å…¶è‡ªèº«çš„å­ç»„ä»¶ï¼ˆå³ GrandSon ï¼‰</span>
        <span class="token comment">// son ç»„ä»¶å°†æ¥æ”¶åˆ°çˆ¶ä½œç”¨åŸŸçš„äº‹ä»¶ç›‘å¬å™¨ä¼ è‡³è‡ªèº«çš„å­ç»„ä»¶ï¼ˆå³ GrandSon ï¼‰</span>
        <span class="token operator">&lt;</span>GrandSon v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">'$attrs'</span> v<span class="token operator">-</span>on<span class="token operator">=</span><span class="token string">'$listerners'</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>GrandSon<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token keyword">import</span> GrandSon <span class="token keyword">from</span> <span class="token string">'./GrandSon.vue'</span><span class="token punctuation">;</span>

    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'son'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>GrandSon<span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">inheritAttrs</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//çˆ¶ç»„ä»¶å…±ä¼ æ¥ä¸‰ä¸ªå€¼ï¼Œnameã€ageã€weightï¼Œç”±äº name è¢« props æ¥æ”¶äº†ï¼Œæ•… $attrs åªåŒ…æ‹¬ age ã€weight å±æ€§</span>
            <span class="token comment">//{age: 30, weight: 50}</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$attrs<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//çˆ¶ç»„ä»¶ç›‘å¬äº†ä¸¤ä¸ªäº‹ä»¶ï¼ŒupdateInfoå’Œclickï¼Œç”±äºclickè¢«nativeä¿®é¥°äº†ï¼Œæ•…$listerners åªæœ‰ updateInfo äº‹ä»¶</span>
            <span class="token comment">// {updateInfo: fn}</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token comment">// GrandSon.vue</span>
 <span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;grandson&quot;</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token punctuation">{</span> $attrs <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">{</span><span class="token punctuation">{</span> $listeners <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token keyword">import</span> GrandSon <span class="token keyword">from</span> <span class="token string">'./GrandSon.vue'</span><span class="token punctuation">;</span>

    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'son'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>GrandSon<span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">inheritAttrs</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//{age: 30, weight: 50}</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$attrs<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// {updateInfo: fn}</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$listener<span class="token punctuation">)</span><span class="token punctuation">;</span>

             <span class="token comment">// å¯è§¦å‘ father ç»„ä»¶ä¸­çš„updateInfoå‡½æ•°</span>
             <span class="token comment">// father A: update info</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'updateInfo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><ul><li><code>provide / inject</code> é€‚ç”¨äºéš”ä»£ç»„ä»¶é€šä¿¡ï¼ˆvue2.2 æ–°å¢å±æ€§ï¼‰</li></ul> <p>åœ¨ç¥–å…ˆç»„ä»¶ä¸­å¯é€šè¿‡ <code>provide</code> æŒ‡å®šæˆ‘ä»¬æƒ³è¦æä¾›ç»™åä»£ç»„ä»¶çš„æ•°æ®æˆ–æ–¹æ³•ï¼Œè€Œåœ¨ä»»ä½•åä»£ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨ <code>inject</code> æ¥æ³¨å…¥ <code>provide</code> æä¾›çš„æ•°æ®æˆ–æ–¹æ³•ã€‚</p> <p><code>provide / inject</code> API ä¸»è¦è§£å†³äº†è·¨çº§ç»„ä»¶é—´çš„é€šä¿¡é—®é¢˜ï¼Œä¸è¿‡å®ƒçš„ä½¿ç”¨åœºæ™¯ï¼Œä¸»è¦æ˜¯å­ç»„ä»¶è·å–ä¸Šçº§ç»„ä»¶çš„çŠ¶æ€ï¼Œè·¨çº§ç»„ä»¶é—´å»ºç«‹äº†ä¸€ç§ä¸»åŠ¨æä¾›ä¸ä¾èµ–æ³¨å…¥çš„å…³ç³»ã€‚</p> <blockquote><p>provide å’Œ inject ç»‘å®šå¹¶ä¸æ˜¯å¯å“åº”çš„ã€‚è¿™æ˜¯åˆ»æ„ä¸ºä¹‹çš„ã€‚ç„¶è€Œï¼Œå¦‚æœä½ ä¼ å…¥äº†ä¸€ä¸ªå¯ç›‘å¬çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå…¶å¯¹è±¡çš„å±æ€§è¿˜æ˜¯å¯å“åº”çš„ã€‚</p></blockquote> <p>è¯¦æƒ…æˆ³<a href="https://juejin.im/post/5dc4cbeff265da4d1f51c7f1" target="_blank" rel="noopener noreferrer">è¿™<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><code>Vuex</code> é€‚ç”¨äºæ‰€æœ‰ç»„ä»¶é—´é€šä¿¡</li></ul> <p>Vuex æ˜¯ä¸€ä¸ª Vue.js çš„çŠ¶æ€ç®¡ç†æ¨¡å¼ã€‚æ¯ä¸€ä¸ª Vuex åº”ç”¨çš„æ ¸å¿ƒå°±æ˜¯ storeï¼ˆä»“åº“ï¼‰ã€‚</p> <p><code>store</code>åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒåŒ…å«ç€ä½ çš„åº”ç”¨ä¸­å¤§éƒ¨åˆ†çš„çŠ¶æ€ <code>state</code>ã€‚</p> <p>Vuex çš„çŠ¶æ€å­˜å‚¨æ˜¯å“åº”å¼çš„ã€‚å½“ Vue ç»„ä»¶ä» store ä¸­è¯»å–çŠ¶æ€çš„æ—¶å€™ï¼Œè‹¥ store ä¸­çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç›¸åº”çš„ç»„ä»¶ä¹Ÿä¼šç›¸åº”åœ°å¾—åˆ°é«˜æ•ˆæ›´æ–°ã€‚</p> <p>æ”¹å˜ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€é€”å¾„å°±æ˜¯æ˜¾å¼åœ°æäº¤ (commit) mutationã€‚è¿™æ ·ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°è·Ÿè¸ªæ¯ä¸€ä¸ªçŠ¶æ€çš„å˜åŒ–ã€‚</p> <h2 id="_014-nexttick-åŸç†åˆ†æ"><a href="#_014-nexttick-åŸç†åˆ†æ" class="header-anchor">#</a> 014ï¼š nextTick åŸç†åˆ†æ</h2> <blockquote><p>åœ¨ä¸‹æ¬¡ DOM æ›´æ–°å¾ªç¯ç»“æŸä¹‹åæ‰§è¡Œå»¶è¿Ÿå›è°ƒã€‚åœ¨ä¿®æ”¹æ•°æ®ä¹‹åç«‹å³ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè·å–æ›´æ–°åçš„ DOMã€‚</p></blockquote> <p>ç®€å•æ¥è¯´ï¼š<br>
DOM è‡³å°‘ä¼šåœ¨å½“å‰ tick é‡Œé¢çš„ä»£ç å…¨éƒ¨æ‰§è¡Œå®Œæ¯•åå†æ›´æ–°ã€‚æ‰€ä»¥ä¸å¯èƒ½åšåˆ°åœ¨ä¿®æ”¹æ•°æ®å DOM é©¬ä¸Šæ›´æ–°ï¼Œè¦ä¿è¯åœ¨ DOM æ›´æ–°ä»¥åå†æ‰§è¡ŒæŸä¸€å—ä»£ç ï¼Œå°±å¿…é¡»æŠŠè¿™å—ä»£ç æ”¾åˆ°ä¸‹ä¸€æ¬¡äº‹ä»¶å¾ªç¯é‡Œé¢ï¼Œæ¯”å¦‚ setTimeout(fn, 0)ï¼Œè¿™æ · DOM æ›´æ–°åï¼Œå°±ä¼šç«‹å³æ‰§è¡Œè¿™å—ä»£ç ã€‚</p> <p>åº”ç”¨åœºæ™¯ï¼š</p> <ol><li><p>åœ¨ Vue ç”Ÿå‘½å‘¨æœŸçš„ created()é’©å­å‡½æ•°è¿›è¡Œçš„ DOM æ“ä½œä¸€å®šè¦æ”¾åœ¨ Vue.nextTick()çš„å›è°ƒå‡½æ•°ä¸­ã€‚<br>
åŸå› ï¼šæ˜¯ created()é’©å­å‡½æ•°æ‰§è¡Œæ—¶ DOM å…¶å®å¹¶æœªè¿›è¡Œæ¸²æŸ“ã€‚</p></li> <li><p>åœ¨æ•°æ®å˜åŒ–åè¦æ‰§è¡Œçš„æŸä¸ªæ“ä½œï¼Œè€Œè¿™ä¸ªæ“ä½œéœ€è¦ä½¿ç”¨éšæ•°æ®æ”¹å˜è€Œæ”¹å˜çš„ DOM ç»“æ„çš„æ—¶å€™ï¼Œè¿™ä¸ªæ“ä½œåº”è¯¥æ”¾åœ¨ Vue.nextTick()çš„å›è°ƒå‡½æ•°ä¸­ã€‚<br>
åŸå› ï¼šVue å¼‚æ­¥æ‰§è¡Œ DOM æ›´æ–°ï¼Œåªè¦è§‚å¯Ÿåˆ°æ•°æ®å˜åŒ–ï¼ŒVue å°†å¼€å¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶ç¼“å†²åœ¨åŒä¸€äº‹ä»¶å¾ªç¯ä¸­å‘ç”Ÿçš„æ‰€æœ‰æ•°æ®æ”¹å˜ï¼Œå¦‚æœåŒä¸€ä¸ª watcher è¢«å¤šæ¬¡è§¦å‘ï¼Œåªä¼šè¢«æ¨å…¥åˆ°é˜Ÿåˆ—ä¸­ä¸€æ¬¡ã€‚</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç‚¹å‡»æŒ‰é’®æ˜¾ç¤ºåŸæœ¬ä»¥ v-show = false éšè—èµ·æ¥çš„è¾“å…¥æ¡†ï¼Œå¹¶è·å–ç„¦ç‚¹ã€‚</span>
<span class="token function">showsou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>showit <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token comment">//ä¿®æ”¹ v-show</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;keywords&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//åœ¨ç¬¬ä¸€ä¸ª tick é‡Œï¼Œè·å–ä¸åˆ°è¾“å…¥æ¡†ï¼Œè‡ªç„¶ä¹Ÿè·å–ä¸åˆ°ç„¦ç‚¹</span>
<span class="token punctuation">}</span>

<span class="token comment">// éœ€è¦ä¿®æ”¹æˆ</span>
<span class="token function">showsou</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>showit <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// DOM æ›´æ–°äº†</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;keywords&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myWidth<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>showMe<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ message }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getMyWidth<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>è·å–på…ƒç´ å®½åº¦<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token function">getMyWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showMe <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token comment">//this.message = this.$refs.myWidth.offsetWidth;</span>
        <span class="token comment">//æŠ¥é”™ TypeError: this.$refs.myWidth is undefined</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token comment">//domå…ƒç´ æ›´æ–°åæ‰§è¡Œï¼Œæ­¤æ—¶èƒ½æ‹¿åˆ°på…ƒç´ çš„å±æ€§</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>myWidth<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>nextTick ä¸»è¦ä½¿ç”¨äº†å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ã€‚æ ¹æ®æ‰§è¡Œç¯å¢ƒåˆ†åˆ«å°è¯•é‡‡ç”¨:Promiseã€MutationObserverã€setImmediateï¼Œå¦‚æœä»¥ä¸Šéƒ½ä¸è¡Œåˆ™é‡‡ç”¨ setTimeoutã€‚å³å»¶è¿Ÿè°ƒç”¨ä¼˜å…ˆçº§å¦‚ä¸‹ï¼š<code>Promise &gt; MutationObserver &gt; setImmediate &gt; setTimeout</code>ã€‚</p> <p>å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œå¤šæ¬¡è°ƒç”¨ nextTick ä¼šå°†æ–¹æ³•å­˜å…¥é˜Ÿåˆ—ä¸­ï¼Œé€šè¿‡è¿™ä¸ªå¼‚æ­¥æ–¹æ³•æ¸…ç©ºå½“å‰é˜Ÿåˆ—ã€‚</p> <p><code>this.a = 'test</code> å½“ä¿®æ”¹äº†ä¸€ä¸ªå±æ€§ä»¥åï¼Œä¼šè§¦å‘ä»¥ä¸‹æ­¥éª¤ï¼š</p> <ol><li><p>è¿›å…¥ a çš„ setterï¼Œé€šçŸ¥æ‰€æœ‰è®¢é˜… a å±æ€§çš„ watcherï¼›</p></li> <li><p>watcher æ”¶åˆ°é€šçŸ¥ä»¥åï¼Œä¼šå°†è‡ªå·±æ”¾å…¥æ›´æ–°æ•°ç»„ ï¼ˆ<a href="https://github.com/vuejs/vue/blob/2bff588ce8/src/core/observer/watcher.js#L171" target="_blank" rel="noopener noreferrer">queueWatcher<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼‰</p></li></ol> <p>æ¥ç€æ‰§è¡Œ <code>nextTick(flushSchedulerQueue)</code>,flushSchedulerQueue å‡½æ•°ä¸»è¦ä½œç”¨æ˜¯æ‰§è¡Œæ›´æ–°æ•°ç»„ã€‚</p> <p>æ¥ç€è¿›å…¥<a href="https://github.com/vuejs/vue/blob/2bff588ce8/src/core/util/next-tick.js" target="_blank" rel="noopener noreferrer">next-tick.js å¯¹å¤–æš´éœ²çš„ nextTick<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼š</p> <ol start="3"><li><p>æŠŠä¼ å…¥çš„å›è°ƒå‡½æ•° cb ï¼ˆflushSchedulerQueueï¼‰å‹å…¥ callbacks æ•°ç»„ï¼›</p></li> <li><p>æ‰§è¡Œ timerFunc å‡½æ•°ï¼ˆå†³å®šä½•æ—¶è°ƒç”¨ï¼‰ï¼Œå»¶è¿Ÿè°ƒç”¨ flushCallbacks å‡½æ•°ï¼ˆä¼˜å…ˆçº§ï¼š<code>Promise &gt; MutationObserver &gt; setImmediate &gt; setTimeout</code>ï¼‰</p></li> <li><p>æ‰§è¡Œ flushCallbacks å‡½æ•°ï¼Œå³æ‰§è¡Œ callbacks æ•°ç»„é‡Œé¢çš„æ‰€æœ‰ cb å›è°ƒ</p></li> <li><p>è¿™é‡Œçš„ callbacks æ²¡æœ‰ç›´æ¥åœ¨ nextTick ä¸­æ‰§è¡Œå›è°ƒå‡½æ•°çš„åŸå› æ˜¯ä¿è¯åœ¨åŒä¸€ä¸ª tick å†…å¤šæ¬¡æ‰§è¡Œ nextTickï¼Œä¸ä¼šå¼€å¯å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œè€Œæ˜¯æŠŠè¿™äº›å¼‚æ­¥ä»»åŠ¡éƒ½å‹æˆä¸€ä¸ªåŒæ­¥ä»»åŠ¡ï¼Œåœ¨ä¸‹ä¸€ä¸ª tick æ‰§è¡Œå®Œæ¯•ã€‚</p></li></ol> <p>æ¯æ¬¡è°ƒç”¨ Vue.nextTick æ—¶ä¼šæ‰§è¡Œå…¶ä¸­ ï¼ˆ3-6ï¼‰ æ­¥éª¤ã€‚</p> <blockquote><p>Vue å¼‚æ­¥æ‰§è¡Œ DOM æ›´æ–°ã€‚åªè¦è§‚å¯Ÿåˆ°æ•°æ®å˜åŒ–ï¼ŒVue å°†å¼€å¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶ç¼“å†²åœ¨åŒä¸€äº‹ä»¶å¾ªç¯ä¸­å‘ç”Ÿçš„æ‰€æœ‰æ•°æ®æ”¹å˜ã€‚å¦‚æœåŒä¸€ä¸ª watcher è¢«å¤šæ¬¡è§¦å‘ï¼Œåªä¼šè¢«æ¨å…¥åˆ°é˜Ÿåˆ—ä¸­ä¸€æ¬¡ã€‚è¿™ç§åœ¨ç¼“å†²æ—¶å»é™¤é‡å¤æ•°æ®å¯¹äºé¿å…ä¸å¿…è¦çš„è®¡ç®—å’Œ DOM æ“ä½œä¸Šéå¸¸é‡è¦ã€‚ç„¶åï¼Œåœ¨ä¸‹ä¸€ä¸ªçš„äº‹ä»¶å¾ªç¯â€œtickâ€ä¸­ï¼ŒVue åˆ·æ–°é˜Ÿåˆ—å¹¶æ‰§è¡Œå®é™… (å·²å»é‡çš„) å·¥ä½œã€‚</p></blockquote> <blockquote><p>å¦‚æœ Vue ä½¿ç”¨ setTimeout ç­‰å®ä»»åŠ¡å‡½æ•°ï¼Œé‚£ä¹ˆåŠ¿å¿…è¦ç­‰å¾… UI æ¸²æŸ“å®Œæˆåçš„ä¸‹ä¸€ä¸ªå®ä»»åŠ¡æ‰§è¡Œã€‚å¦‚æœ Vue ä½¿ç”¨å¾®ä»»åŠ¡å‡½æ•°ï¼Œæ— éœ€ç­‰å¾… UI æ¸²æŸ“å®Œæˆæ‰è¿›è¡Œ nextTick çš„å›è°ƒå‡½æ•°æ“ä½œï¼Œå¯ä»¥æƒ³è±¡åœ¨ JS å¼•æ“çº¿ç¨‹å’Œ GUI æ¸²æŸ“çº¿ç¨‹ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œä»¥åŠç­‰å¾… GUI æ¸²æŸ“çº¿ç¨‹çš„è¿‡ç¨‹ä¸­ï¼Œæµè§ˆå™¨åŠ¿å¿…è¦æ¶ˆè€—æ€§èƒ½ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥è°¨çš„æ¡†æ¶å®Œå…¨éœ€è¦è€ƒè™‘çš„äº‹æƒ…ã€‚</p></blockquote> <p>æ›´è¯¦ç»†å¯ä»¥å‚è€ƒï¼Œå­å¥•å¤§å¤§çš„æ–‡ç« <a href="https://juejin.cn/post/6844903843197616136" target="_blank" rel="noopener noreferrer">ã€Šä½ çœŸçš„ç†è§£$nextTick ä¹ˆã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_015-native-ä¿®é¥°ç¬¦çš„ä½œç”¨"><a href="#_015-native-ä¿®é¥°ç¬¦çš„ä½œç”¨" class="header-anchor">#</a> 015ï¼š .native ä¿®é¥°ç¬¦çš„ä½œç”¨</h2> <p>å¯¹ç»„ä»¶ç»‘å®š DOM äº‹ä»¶æ—¶ï¼Œå¯é€šè¿‡<code>.native</code>ä¿®é¥°ã€‚åœ¨çˆ¶å®ä¾‹è§£æå®Œæ¯•å¼€å§‹æŒ‚è½½æ—¶ï¼Œé‡åˆ°å­å…ƒç´ æ˜¯ç»„ä»¶ï¼Œç„¶åå»è§£æç»„ä»¶å†…éƒ¨å¹¶ç”Ÿæˆ DOM ä¹‹åæ‰ addEventListener ç»‘å®šã€‚ç»‘å®šçš„åŸç”Ÿäº‹ä»¶ï¼Œä¼šè¢«å­˜æ”¾åœ¨ç»„ä»¶çš„å¤–å£³èŠ‚ç‚¹ä¸Š <code>vm.$vnode</code>ã€‚</p> <p><code>.native</code> ä¸»è¦ç”¨äº<strong>ç›‘å¬ç»„ä»¶æ ¹å…ƒç´ çš„åŸç”Ÿäº‹ä»¶</strong>ï¼Œ<strong>ç»™è‡ªå®šä¹‰çš„ç»„ä»¶æ·»åŠ åŸç”Ÿäº‹ä»¶</strong>ã€‚</p> <p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šåŠ äº† native ç›¸å½“äºæŠŠè‡ªå®šä¹‰ç»„ä»¶çœ‹æˆäº† html å…ƒç´ å¯ä»¥ç›´æ¥ç›‘å¬åŸç”Ÿ click äº‹ä»¶ï¼›å¦åˆ™åœ¨è‡ªå®šä¹‰ç»„ä»¶ä¸Š ç»‘å®šçš„äº‹ä»¶ é»˜è®¤æ˜¯ è‡ªå®šä¹‰äº‹ä»¶ï¼Œè€Œå¦‚æœåœ¨è‡ªå®šä¹‰ç»„ä»¶ä¸Šæ²¡æœ‰å®šä¹‰è¿™ä¸ªäº‹ ä»¶ï¼Œä¸åŠ  native ä¸ä¼šæ‰§è¡Œã€‚</p> <p>ä¾‹å­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Button.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> v<span class="token operator">-</span>on<span class="token operator">:</span>click<span class="token operator">=</span><span class="token string">&quot;clickHandler&quot;</span><span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
   <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
       <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token function">clickHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;vclick&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è§¦å‘ vclick äº‹ä»¶</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>åŸç”Ÿ html æ ‡ç­¾ç»‘å®šäº‹ä»¶ï¼Œé€šè¿‡ addEventListener ç»‘å®š DOM äº‹ä»¶ï¼Œäº‹ä»¶ä¼šè¢«ä¿å­˜åœ¨è¿™ä¸ªèŠ‚ç‚¹è§£ææˆçš„ vnode ä¸­ï¼Œå°±æ˜¯ <code>vm._vnode</code>ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">// å¼•ç”¨ Button.vue çš„ç»„ä»¶ä½œä¸º&lt;VButton&gt;</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;a&quot;</span><span class="token operator">&gt;</span>

        <span class="token comment">// å¦‚æœä¸æ·»åŠ nativeä¿®é¥°clickï¼Œä¼šè¢«è®¤ä¸ºæ²¡æœ‰æ³¨å†Œè‡ªå®šä¹‰å…ƒç´ çš„è‡ªå®šä¹‰äº‹ä»¶clickå¯¹åº”çš„å¤„ç†å‡½æ•°ã€‚ä½†ä¼šæ‰§è¡ŒvClickHandler</span>
        <span class="token operator">&lt;</span>vButton v<span class="token operator">-</span>on<span class="token operator">:</span>click<span class="token operator">=</span><span class="token string">&quot;clickHandler&quot;</span> v<span class="token operator">-</span>on<span class="token operator">:</span>vclick<span class="token operator">=</span><span class="token string">&quot;vClickHandler&quot;</span><span class="token operator">&gt;</span> æŒ‰é’®<span class="token number">1</span> <span class="token operator">&lt;</span><span class="token operator">/</span>vButton<span class="token operator">&gt;</span>

        <span class="token comment">// clickHandler å’Œ vclickHanddler éƒ½ä¼šæ‰§è¡Œ</span>
        <span class="token operator">&lt;</span>vButton v<span class="token operator">-</span>on<span class="token operator">:</span>click<span class="token punctuation">.</span>native<span class="token operator">=</span><span class="token string">&quot;clickHandler&quot;</span> v<span class="token operator">-</span>on<span class="token operator">:</span>vclick<span class="token operator">=</span><span class="token string">&quot;vClickHandler&quot;</span><span class="token operator">&gt;</span>æŒ‰é’®<span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>vButton<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token keyword">import</span> vButton <span class="token keyword">from</span> <span class="token string">&quot;./Button.vue&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token function">vClickHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// è‡ªå®šä¹‰äº‹ä»¶</span>
                cconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;in v-click&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function">clickHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// domäº‹ä»¶</span>
                cconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;in on-click&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_016-çˆ¶ç»„ä»¶å¯ä»¥ç›‘å¬åˆ°å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå—"><a href="#_016-çˆ¶ç»„ä»¶å¯ä»¥ç›‘å¬åˆ°å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå—" class="header-anchor">#</a> 016ï¼š çˆ¶ç»„ä»¶å¯ä»¥ç›‘å¬åˆ°å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå—ï¼Ÿ</h2> <p>å¯ä»¥ï¼Œå¯é€šè¿‡<code>$emit</code>å®ç°ï¼Œä½†è¿™ä¸ªæ–¹å¼éœ€è¦é€šè¿‡æ‰‹åŠ¨è§¦å‘ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ hook è§£å†³ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åœ¨çˆ¶ç»„ä»¶ä¸­ @hook:é’©å­</span>
<span class="token comment">//  Parent.vue</span>
<span class="token operator">&lt;</span>Child @hook<span class="token operator">:</span>mounted<span class="token operator">=</span><span class="token string">&quot;doSomething&quot;</span> <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Child<span class="token operator">&gt;</span>

<span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'çˆ¶ç»„ä»¶ç›‘å¬åˆ° mounted é’©å­å‡½æ•° ...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">//  Child.vue</span>
<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å­ç»„ä»¶è§¦å‘ mounted é’©å­å‡½æ•° ...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// ä»¥ä¸Šè¾“å‡ºé¡ºåºä¸ºï¼š</span>
<span class="token comment">// å­ç»„ä»¶è§¦å‘ mounted é’©å­å‡½æ•° ...</span>
<span class="token comment">// çˆ¶ç»„ä»¶ç›‘å¬åˆ° mounted é’©å­å‡½æ•° ...</span>
</code></pre></div> <h2 id="_016-vue-çš„å•å‘æ•°æ®æµçš„ç†è§£"><a href="#_016-vue-çš„å•å‘æ•°æ®æµçš„ç†è§£" class="header-anchor">#</a> 016ï¼š Vue çš„å•å‘æ•°æ®æµçš„ç†è§£</h2> <p>çˆ¶ç»„ä»¶å¯ä»¥é€šè¿‡è®¾ç½®å­ç»„ä»¶çš„å±æ€§ï¼ˆPropsï¼‰æ¥å‘å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œè€Œçˆ¶ç»„ä»¶æƒ³è·å¾—å­ç»„ä»¶çš„æ•°æ®ï¼Œéœ€è¦å‘å­ç»„ä»¶æ³¨å†Œäº‹ä»¶ï¼Œåœ¨å­ç»„ä»¶é€šè¿‡<code>$emit</code>è§¦å‘è¿™ä¸ªäº‹ä»¶æŠŠæ•°æ®ä¼ é€’å‡ºæ¥ã€‚å³ Props å‘ä¸‹ä¼ é€’æ•°æ®ï¼Œäº‹ä»¶å‘ä¸Šä¼ é€’æ•°æ®ã€‚</p> <p>è¿™æ ·å­åšçš„æ„ä¹‰æ˜¯ä¸ºäº†é¿å…å­ç»„ä»¶ä¸ç»æ„æ”¹å˜äº†çˆ¶ç»„ä»¶ä¼ æ¥çš„æ•°æ®ï¼Œå¯¼è‡´ä¸ç¡®å®šæ•°æ®çš„æµå‘å¤„ç†ã€‚</p> <h2 id="_017-vue-äº‹ä»¶ç»‘å®šåŸç†è¯´ä¸€ä¸‹"><a href="#_017-vue-äº‹ä»¶ç»‘å®šåŸç†è¯´ä¸€ä¸‹" class="header-anchor">#</a> 017ï¼š Vue äº‹ä»¶ç»‘å®šåŸç†è¯´ä¸€ä¸‹</h2> <p>åŸç”Ÿäº‹ä»¶ç»‘å®šæ˜¯é€šè¿‡ addEventListener ç»‘å®šç»™çœŸå®å…ƒç´ çš„ï¼Œç»„ä»¶äº‹ä»¶ç»‘å®šæ˜¯é€šè¿‡ Vue è‡ªå®šä¹‰çš„ <code>$on</code> å®ç°çš„ã€‚å¦‚æœè¦åœ¨ç»„ä»¶ä¸Šä½¿ç”¨åŸç”Ÿäº‹ä»¶ï¼Œéœ€è¦æ·»åŠ <code>.native</code> å»ä¿®é¥°ï¼Œè¿™æ ·å­ç›¸å½“äºåœ¨ä¼ç»„ä»¶ä¸­æŠŠå­ç»„ä»¶å½“åšæ˜¯æ™®é€š htmlï¼Œç„¶ååŠ ä¸ŠåŸç”Ÿäº‹ä»¶ã€‚</p> <h2 id="_018-mvvm-å’Œ-mvc-ç†è§£"><a href="#_018-mvvm-å’Œ-mvc-ç†è§£" class="header-anchor">#</a> 018ï¼š MVVM å’Œ MVC ç†è§£</h2> <h4 id="mvc"><a href="#mvc" class="header-anchor">#</a> MVC</h4> <ul><li>Modelï¼ˆæ¨¡å‹ï¼‰ï¼šæ˜¯åº”ç”¨ç¨‹åºä¸­ç”¨äºå¤„ç†åº”ç”¨ç¨‹åºæ•°æ®é€»è¾‘çš„éƒ¨åˆ†ã€‚é€šå¸¸æ¨¡å‹å¯¹è±¡è´Ÿè´£åœ¨æ•°æ®åº“ä¸­å­˜å–æ•°æ®</li> <li>Viewï¼ˆè§†å›¾ï¼‰ï¼šæ˜¯åº”ç”¨ç¨‹åºä¸­å¤„ç†æ•°æ®æ˜¾ç¤ºçš„éƒ¨åˆ†ã€‚é€šå¸¸è§†å›¾æ˜¯ä¾æ®æ¨¡å‹æ•°æ®åˆ›å»ºçš„</li> <li>Controllerï¼ˆæ§åˆ¶å™¨ï¼‰ï¼šæ˜¯åº”ç”¨ç¨‹åºä¸­å¤„ç†ç”¨æˆ·äº¤äº’çš„éƒ¨åˆ†ã€‚é€šå¸¸æ§åˆ¶å™¨è´Ÿè´£ä»è§†å›¾è¯»å–æ•°æ®ï¼Œæ§åˆ¶ç”¨æˆ·è¾“å…¥ï¼Œå¹¶å‘æ¨¡å‹å‘é€æ•°æ®ã€‚</li></ul> <p>Model å±‚ä¸ View å±‚è€¦åˆï¼Œäº¤äº’å½¢æˆä¸€ä¸ªå›è·¯ï¼š<br>
æµç¨‹ï¼šç”¨æˆ·æ“ä½œ -&gt; Viewï¼ˆè´Ÿè´£æ¥æ”¶ç”¨æˆ·çš„è¾“å…¥æ“ä½œï¼‰ -&gt; Controllerï¼ˆä¸šåŠ¡é€»è¾‘å¤„ç†ï¼‰ -&gt; Modelï¼ˆæ•°æ®å¤„ç†ï¼‰-&gt; Viewï¼ˆå°†ç»“æœåé¦ˆç»™ Viewï¼‰ã€‚</p> <h4 id="mvvm"><a href="#mvvm" class="header-anchor">#</a> MVVM</h4> <ul><li><p>View å±‚ï¼šè§†å›¾å±‚ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·ç•Œé¢ã€‚å‰ç«¯ä¸»è¦ç”± HTML å’Œ CSS æ¥æ„å»º ã€‚</p></li> <li><p>Model å±‚ï¼šæ•°æ®æ¨¡å‹ï¼Œæ³›æŒ‡åç«¯è¿›è¡Œçš„å„ç§ä¸šåŠ¡é€»è¾‘å¤„ç†å’Œæ•°æ®æ“æ§ï¼Œå¯¹äºå‰ç«¯æ¥è¯´å°±æ˜¯åç«¯æä¾›çš„ api æ¥å£ã€‚</p></li> <li><p>ViewModel å±‚ï¼šåšäº†ä¸¤ä»¶äº‹è¾¾åˆ°äº†æ•°æ®çš„åŒå‘ç»‘å®šï¼š<br>
ä¸€æ˜¯å°†ã€æ¨¡å‹ã€‘è½¬åŒ–æˆã€è§†å›¾ã€‘ï¼Œå³å°†åç«¯ä¼ é€’çš„æ•°æ®è½¬åŒ–æˆæ‰€çœ‹åˆ°çš„é¡µé¢ã€‚å®ç°çš„æ–¹å¼æ˜¯ï¼šæ•°æ®ç»‘å®šã€‚<br>
äºŒæ˜¯å°†ã€è§†å›¾ã€‘è½¬åŒ–æˆã€æ¨¡å‹ã€‘ï¼Œå³å°†æ‰€çœ‹åˆ°çš„é¡µé¢è½¬åŒ–æˆåç«¯çš„æ•°æ®ã€‚å®ç°çš„æ–¹å¼æ˜¯ï¼šDOM äº‹ä»¶ç›‘å¬ã€‚</p></li></ul> <p>MVVM æ¡†æ¶å®ç°äº† View å’Œ Model çš„è‡ªåŠ¨åŒæ­¥ï¼Œä¹Ÿå°±æ˜¯å½“ Model çš„å±æ€§æ”¹å˜æ—¶ï¼Œæˆ‘ä»¬ä¸ç”¨å†è‡ªå·±æ‰‹åŠ¨æ“ä½œ Dom å…ƒç´ ï¼Œæ¥æ”¹å˜ View çš„æ˜¾ç¤ºï¼Œè€Œæ˜¯æ”¹å˜å±æ€§åè¯¥å±æ€§å¯¹åº” View å±‚æ˜¾ç¤ºä¼šè‡ªåŠ¨æ”¹å˜ï¼ˆå¯¹åº” Vue æ•°æ®é©±åŠ¨çš„æ€æƒ³ï¼‰</p> <p>è¿™æ · View å±‚å±•ç°çš„ä¸æ˜¯ Model å±‚çš„æ•°æ®ï¼Œè€Œæ˜¯ ViewModel çš„æ•°æ®ï¼Œç”± ViewModel è´Ÿè´£ä¸ Model å±‚äº¤äº’ï¼Œè¿™å°±å®Œå…¨è§£è€¦äº† View å±‚å’Œ Model å±‚ï¼Œè¿™ä¸ªè§£è€¦æ˜¯è‡³å…³é‡è¦ï¼Œæ˜¯å‰åç«¯åˆ†ç¦»æ–¹æ¡ˆå®æ–½çš„é‡è¦ä¸€ç¯ã€‚</p> <p>ç”¨ Vue çš„è§†è§’æ¥è§£é‡Š MVVM çš„è¯ï¼ŒView è§†å›¾å¯¹åº”çš„æ˜¯ Vue çš„æ¨¡æ¿å’Œæ ·å¼è¡¨ï¼›è€Œ ViewModel åˆ™æ˜¯è¯¥ç»„ä»¶çš„å®ä¾‹ï¼Œæ¯ä¸ªç»„ä»¶çš„ä½œç”¨åŸŸéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œäº’ä¸å½±å“ï¼›è€Œ Vue çš„ Model å±‚ï¼Œåœ¨æ²¡æœ‰å¼•å…¥ç¬¬ä¸‰æ–¹çŠ¶æ€ç®¡ç†çš„æƒ…å†µä¸‹ï¼Œå°±æ˜¯æŒ‡ç»„ä»¶ä¸­ data å±æ€§ä¸­çš„å†…å®¹ã€‚å¦‚æœç³»ç»Ÿä¸­å¼•å…¥äº†å…¨å±€çš„ Model å±‚ï¼Œæ¯”å¦‚ vuexï¼Œé‚£ Model å±‚ä¹ŸåŒ…å«ä¸€ä¸ªå’Œ Vue ç»„ä»¶è„±ç¦»çš„å¯¹è±¡ã€‚</p> <h2 id="_019-vue-router-è·¯ç”±æ¨¡å¼æœ‰å‡ ç§"><a href="#_019-vue-router-è·¯ç”±æ¨¡å¼æœ‰å‡ ç§" class="header-anchor">#</a> 019ï¼švue-router è·¯ç”±æ¨¡å¼æœ‰å‡ ç§</h2> <p>vue-router è·¯ç”±æ¨¡å¼ä¸»è¦æœ‰ä¸¤ç§ï¼šhash å’Œ historyã€‚</p> <h4 id="å¸¸ç”¨çš„-hash-å’Œ-history-è·¯ç”±æ¨¡å¼å®ç°åŸç†"><a href="#å¸¸ç”¨çš„-hash-å’Œ-history-è·¯ç”±æ¨¡å¼å®ç°åŸç†" class="header-anchor">#</a> å¸¸ç”¨çš„ hash å’Œ history è·¯ç”±æ¨¡å¼å®ç°åŸç†</h4> <h2 id="_020-vue3-0-ç‰¹æ€§"><a href="#_020-vue3-0-ç‰¹æ€§" class="header-anchor">#</a> 020ï¼š vue3.0 ç‰¹æ€§</h2> <ol><li>ç›‘æµ‹æœºåˆ¶çš„æ”¹å˜</li></ol> <p>åŸºäº Proxy å®ç°æ•°æ®åŠ«æŒï¼Œæ¶ˆé™¤äº† Vue 2 åŸºäº Object.defineProperty çš„å®ç°æ‰€å­˜åœ¨çš„å¾ˆå¤šé™åˆ¶ï¼š</p> <ul><li>ç›‘æµ‹å¯¹è±¡ï¼›æ£€æµ‹å±æ€§çš„æ·»åŠ å’Œåˆ é™¤ï¼›</li> <li>æ£€æµ‹æ•°ç»„ç´¢å¼•å’Œé•¿åº¦çš„å˜æ›´ï¼›æ”¯æŒ Mapã€Setã€WeakMap å’Œ WeakSetã€‚</li></ul> <ol start="2"><li>Composition API</li></ol> <p>Vue 3 æ¨å‡ºäº† Composition API ï¼ŒComposition API æ˜¯ä»¥å‡½æ•°çš„å½¢å¼å°è£…å…¬å…±é€»è¾‘ï¼Œå®ƒé€šè¿‡æ˜¾å¼çš„è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè®©å¼€å‘äººå‘˜èƒ½åœ¨ç»„ä»¶ä¸­ç›´æ¥äº†è§£åˆ°è¢«å¼•å…¥çš„å­—æ®µï¼Œä»è€Œé¿å… Mixin å‘½åå†²çªã€‚</p> <ol start="3"><li>è™šæ‹Ÿ DOM ä¼˜åŒ–å’Œ diff ç®—æ³•ä¼˜åŒ–</li></ol> <h2 id="_021-vue-çš„ä¼˜åŒ–"><a href="#_021-vue-çš„ä¼˜åŒ–" class="header-anchor">#</a> 021ï¼š Vue çš„ä¼˜åŒ–</h2> <h4 id="ä»£ç å±‚é¢çš„ä¼˜åŒ–"><a href="#ä»£ç å±‚é¢çš„ä¼˜åŒ–" class="header-anchor">#</a> ä»£ç å±‚é¢çš„ä¼˜åŒ–</h4> <ul><li><p>å‡å°‘ data æ•°æ®ï¼Œæˆ–è€…å¯¹ä¸è¯¥åŠ¨çš„å±æ€§é‡‡ç”¨<code>Object.freeze</code>ï¼Œå¦åˆ™æ•°æ®éƒ½ä¼šå¢åŠ  getter å’Œ setterï¼Œä¼šæ”¶é›†å¯¹åº”çš„ watcher</p></li> <li><p>v-if å’Œ v-show åŒºåˆ†ä½¿ç”¨åœºæ™¯</p></li> <li><p>v-for éå†å¿…é¡»ä¸º item æ·»åŠ  keyï¼Œä¸”é¿å…åŒæ—¶ä½¿ç”¨ v-if</p></li> <li><p>computed å’Œ watch åŒºåˆ†ä½¿ç”¨åœºæ™¯</p></li> <li><p>SPA é¡µé¢å–„ç”¨ keep-alive ç¼“å­˜ç»„ä»¶</p></li> <li><p>key ä¿è¯å”¯ä¸€</p></li> <li><p>å›¾ç‰‡èµ„æºæ‡’åŠ è½½</p></li> <li><p>ç¬¬ä¸‰æ–¹æ’ä»¶çš„æŒ‰éœ€å¼•å…¥</p></li> <li><p>é˜²æŠ–ã€èŠ‚æµ</p></li> <li><p>created å¼€å¯å¼‚æ­¥ä»»åŠ¡å¤„ç†ï¼Œæå‰è¯·æ±‚åŠ è½½æ•°æ®</p></li></ul> <h4 id="webpack-å±‚é¢çš„ä¼˜åŒ–"><a href="#webpack-å±‚é¢çš„ä¼˜åŒ–" class="header-anchor">#</a> Webpack å±‚é¢çš„ä¼˜åŒ–</h4> <h2 id="_022-vue-set-çš„å®ç°åŸç†"><a href="#_022-vue-set-çš„å®ç°åŸç†" class="header-anchor">#</a> 022ï¼š Vue.set çš„å®ç°åŸç†</h2> <p>å—ç°ä»£ JavaScript çš„é™åˆ¶ ï¼ŒVue æ— æ³•æ£€æµ‹åˆ°å¯¹è±¡å±æ€§çš„æ·»åŠ æˆ–åˆ é™¤ï¼Œä¹Ÿæ— æ³•æ£€æµ‹æ•°ç»„é•¿åº¦æˆ–è€…é€šè¿‡ç´¢å¼•æ”¹å˜æ•°ç»„å…ƒç´ ã€‚</p> <p>ç”±äº Vue ä¼šåœ¨åˆå§‹åŒ–å®ä¾‹æ—¶å¯¹å±æ€§æ‰§è¡Œ getter/setter è½¬åŒ–ï¼Œæ‰€ä»¥å±æ€§å¿…é¡»åœ¨ data å¯¹è±¡ä¸Šå­˜åœ¨æ‰èƒ½è®© Vue å°†å®ƒè½¬æ¢ä¸ºå“åº”å¼çš„</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">target</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span> <span class="token operator">|</span> Object<span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> any<span class="token punctuation">,</span> <span class="token literal-property property">val</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span><span class="token operator">:</span> any <span class="token punctuation">{</span>
    <span class="token comment">// target ä¸ºæ•°ç»„</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isValidArrayIndex</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä¿®æ”¹æ•°ç»„çš„é•¿åº¦, é¿å…ç´¢å¼•&gt;æ•°ç»„é•¿åº¦å¯¼è‡´splcie()æ‰§è¡Œæœ‰è¯¯</span>
        target<span class="token punctuation">.</span>length <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>length<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ©ç”¨æ•°ç»„çš„spliceå˜å¼‚æ–¹æ³•è§¦å‘å“åº”å¼(æ•°ç»„æ–¹æ³•å·²è¢«é‡æ–°ï¼Œå› æ­¤ä¼šè‡ªåŠ¨è§¦å‘)</span>
        target<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// key å·²ç»å­˜åœ¨ï¼Œç›´æ¥ä¿®æ”¹å±æ€§å€¼</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> target <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
        <span class="token keyword">return</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å› ä¸ºå“åº”å¼æ•°æ® æˆ‘ä»¬ç»™å¯¹è±¡å’Œæ•°ç»„æœ¬èº«éƒ½å¢åŠ äº†__ob__å±æ€§ï¼Œä»£è¡¨çš„æ˜¯ Observer å®ä¾‹ã€‚</span>
    <span class="token keyword">const</span> ob <span class="token operator">=</span> <span class="token punctuation">(</span>target<span class="token operator">:</span> any<span class="token punctuation">)</span><span class="token punctuation">.</span>__ob__<span class="token punctuation">;</span>

    <span class="token comment">// target æœ¬èº«å°±ä¸æ˜¯å“åº”å¼æ•°æ®, ç›´æ¥èµ‹å€¼</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ob<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
        <span class="token keyword">return</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å¯¹å±æ€§è¿›è¡Œå“åº”å¼å¤„ç†</span>
    <span class="token comment">// å°†å±æ€§å®šä¹‰æˆå“åº”å¼çš„</span>
    <span class="token function">defineReactive</span><span class="token punctuation">(</span>ob<span class="token punctuation">.</span>value<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ob<span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> val<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç”±ä»£ç å¯çŸ¥ï¼ŒVue.set çš„å®ç°åŸç†ï¼š</p> <p>ï¼ˆ1ï¼‰å¦‚æœç›®æ ‡æ˜¯æ•°ç»„ï¼Œç›´æ¥ä½¿ç”¨æ•°ç»„çš„ splice æ–¹æ³•è§¦å‘ç›¸åº”å¼ï¼›</p> <p>ï¼ˆ2ï¼‰å¦‚æœç›®æ ‡æ˜¯å¯¹è±¡ï¼Œä¼šå…ˆåˆ¤è¯»å±æ€§æ˜¯å¦å­˜åœ¨ã€å¯¹è±¡æ˜¯å¦æ˜¯å“åº”å¼ï¼Œæœ€ç»ˆå¦‚æœè¦å¯¹å±æ€§è¿›è¡Œå“åº”å¼å¤„ç†ï¼Œåˆ™æ˜¯é€šè¿‡è°ƒç”¨ defineReactive æ–¹æ³•è¿›è¡Œå“åº”å¼å¤„ç†ï¼ˆ defineReactive æ–¹æ³•å°±æ˜¯ Vue åœ¨åˆå§‹åŒ–å¯¹è±¡æ—¶ï¼Œç»™å¯¹è±¡å±æ€§é‡‡ç”¨ Object.defineProperty åŠ¨æ€æ·»åŠ  getter å’Œ setter çš„åŠŸèƒ½æ‰€è°ƒç”¨çš„æ–¹æ³•ï¼‰</p> <h2 id="_023-vue-æ•°æ®æ¸²æŸ“è¿‡ç¨‹"><a href="#_023-vue-æ•°æ®æ¸²æŸ“è¿‡ç¨‹" class="header-anchor">#</a> 023ï¼šVue æ•°æ®æ¸²æŸ“è¿‡ç¨‹</h2> <p><code>$mount</code> æ˜¯æ¸²æŸ“çš„èµ·ç‚¹ã€‚åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œæä¾›äº†ä¸‰ç§æ¸²æŸ“æ¨¡å¼ï¼Œè‡ªå®šä¹‰ Render å‡½æ•°ã€templateã€el å‡å¯ä»¥æ¸²æŸ“é¡µé¢ã€‚</p> <p>é™¤äº† Render å‡½æ•°æ¨¡å¼ï¼Œå…¶ä»–ä¸¤ç§éƒ½éœ€è¦è§£ææˆ ASTï¼Œå†å°† AST è½¬åŒ–ä¸º Render å‡½æ•°ã€‚</p> <p>Render å‡½æ•°çš„ä½œç”¨æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿåœ¨/src/core/instance/lifecycle.js ä¸­æœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>vm<span class="token punctuation">.</span>_watcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>
    vm<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    noop
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>é€šè¿‡ Watcher çš„ç»‘å®šï¼Œæ¯å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰§è¡Œ<code>_update</code>çš„æ–¹æ³•ï¼Œæ­¤æ—¶ä¼šå…ˆæ‰§è¡Œ<code>vm._render()</code>ã€‚åœ¨è¿™ä¸ª <code>vm._render()</code>ä¸­ï¼Œæˆ‘ä»¬çš„ Render å‡½æ•°ä¼šæ‰§è¡Œï¼Œè€Œå¾—åˆ° VNode å¯¹è±¡ã€‚</p> <p>Render å‡½æ•°æ‰§è¡Œç”Ÿæˆäº† VNodeï¼Œè€Œ VNode åªæ˜¯ Virtual DOMã€‚</p> <p>è¿‡ DOM Diff ä¹‹åï¼Œæ¥ç”ŸæˆçœŸæ­£çš„ DOM èŠ‚ç‚¹ã€‚åœ¨/src/core/vdom/patch.js ä¸­çš„ patch(oldVnode, vnode ,hydrating)æ–¹æ³•æ¥å®Œæˆçš„ã€‚</p> <p>patch å…¶ä¸­çš„ä¸»è¦é€»è¾‘ä¸ºï¼š<br>
1ï¼‰å½“ VNode ä¸ºçœŸå®å…ƒç´ æˆ–æ—§çš„ VNode å’Œæ–°çš„ VNode å®Œå…¨ç›¸åŒæ—¶ï¼Œç›´æ¥è°ƒç”¨ createElm æ–¹æ³•ç”ŸæˆçœŸå®çš„ DOM æ ‘ã€‚<br>
2ï¼‰å½“ VNode æ–°æ—§å­˜åœ¨å·®å¼‚æ—¶ï¼Œåˆ™è°ƒç”¨ patchVnode æ–¹æ³•ï¼Œæ¯”è¾ƒæ–°æ—§ VNode èŠ‚ç‚¹ï¼Œæ ¹æ®ä¸åŒçš„çŠ¶æ€å¯¹ DOM åšåˆç†çš„æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ DOMï¼Œæœ€åè°ƒç”¨ createElm ç”ŸæˆçœŸå®çš„ DOM æ ‘ã€‚ï¼ˆæ›´è¿›ä¸€æ­¥äº†è§£å¯çœ‹ diff ç®—æ³•è¿‡ç¨‹ï¼‰</p> <p>å› æ­¤è¿‡ç¨‹å¤§æ¦‚æ€»ç»“å¦‚ä¸‹ï¼š</p> <ol><li>new Vueï¼Œæ‰§è¡Œåˆå§‹åŒ–ï¼Œ è°ƒç”¨ <code>Vue.prototype._init(option)ã€initMixinã€stateMixinã€eventsMixinã€lifecycleMixinã€renderMixin</code></li></ol> <ol start="2"><li>æŒ‚è½½ <code>$mount</code> æ–¹æ³•ï¼Œé€šè¿‡è‡ªå®šä¹‰ Render æ–¹æ³•ã€templateã€el ç­‰ç”Ÿæˆ Render å‡½æ•°</li> <li>é€šè¿‡ Observe ç›‘å¬æ•°æ®çš„å˜åŒ–ï¼Œç„¶åé€šè¿‡<code>dep.notify</code>é€šçŸ¥å¯¹åº”çš„ watchersï¼Œè§¦å‘<code>vm._update(vm._render(), hydrating);</code></li> <li>Render å‡½æ•°æ‰§è¡Œç”Ÿæˆ VNode å¯¹è±¡</li> <li>é€šè¿‡ patch æ–¹æ³•ï¼Œå¯¹æ¯”æ–°æ—§ VNode å¯¹è±¡ï¼Œé€šè¿‡ DOM Diff ç®—æ³•ï¼Œæ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤çœŸæ­£çš„ DOM å…ƒç´ </li></ol> <h2 id="_024-ç»„ä»¶æ›´æ–°çš„è¿‡ç¨‹"><a href="#_024-ç»„ä»¶æ›´æ–°çš„è¿‡ç¨‹" class="header-anchor">#</a> 024ï¼šç»„ä»¶æ›´æ–°çš„è¿‡ç¨‹</h2> <h2 id="_025-ä¸ºä»€ä¹ˆ-v-for-å’Œ-v-if-ä¸èƒ½èƒ½åŒæ—¶ä½¿ç”¨"><a href="#_025-ä¸ºä»€ä¹ˆ-v-for-å’Œ-v-if-ä¸èƒ½èƒ½åŒæ—¶ä½¿ç”¨" class="header-anchor">#</a> 025ï¼šä¸ºä»€ä¹ˆ v-for å’Œ v-if ä¸èƒ½èƒ½åŒæ—¶ä½¿ç”¨</h2> <p>æŠŠ v-if å’Œ v-for åŒæ—¶ç”¨åœ¨åŒä¸€ä¸ªå…ƒç´ ä¸Šã€‚å½“ Vue è§£ææŒ‡ä»¤æ—¶ï¼Œv-for æ¯” v-if å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œæ‰€ä»¥ vue ä¼šå…ˆå¾ªç¯æ‰€æœ‰æ•°æ®åœ¨è¿›è¡Œåˆ¤æ–­,å½±å“æ€§èƒ½ã€‚</p> <h2 id="_026-ä¸ºä»€ä¹ˆç»„ä»¶çš„-data-æ˜¯ä¸€ä¸ªå‡½æ•°"><a href="#_026-ä¸ºä»€ä¹ˆç»„ä»¶çš„-data-æ˜¯ä¸€ä¸ªå‡½æ•°" class="header-anchor">#</a> 026ï¼šä¸ºä»€ä¹ˆç»„ä»¶çš„ data æ˜¯ä¸€ä¸ªå‡½æ•°</h2> <h2 id="_027-ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸæ’æ§½"><a href="#_027-ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸæ’æ§½" class="header-anchor">#</a> 027ï¼šä»€ä¹ˆæ˜¯ä½œç”¨åŸŸæ’æ§½</h2> <h2 id="_028-ç®€è¿°-vuex-å·¥ä½œåŸç†"><a href="#_028-ç®€è¿°-vuex-å·¥ä½œåŸç†" class="header-anchor">#</a> 028ï¼šç®€è¿° vuex å·¥ä½œåŸç†</h2> <h2 id="_029-action-å’Œ-mutation-åŒºåˆ«"><a href="#_029-action-å’Œ-mutation-åŒºåˆ«" class="header-anchor">#</a> 029ï¼šaction å’Œ mutation åŒºåˆ«</h2> <h2 id="_030-vue-router-å¯¼èˆªå®ˆå«ç±»å‹"><a href="#_030-vue-router-å¯¼èˆªå®ˆå«ç±»å‹" class="header-anchor">#</a> 030ï¼švue-router å¯¼èˆªå®ˆå«ç±»å‹</h2> <ol><li>å…¨å±€å‰ç½®å®ˆå«ï¼šrouter.beforeEach</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å½“ä¸€ä¸ªå¯¼èˆªè§¦å‘æ—¶ï¼Œå…¨å±€å‰ç½®å®ˆå«æŒ‰ç…§åˆ›å»ºé¡ºåºè°ƒç”¨ã€‚å®ˆå«æ˜¯å¼‚æ­¥è§£ææ‰§è¡Œï¼Œæ­¤æ—¶å¯¼èˆªåœ¨æ‰€æœ‰å®ˆå« resolve å®Œä¹‹å‰ä¸€ç›´å¤„äºç­‰å¾…ä¸­ã€‚ä¸€å®šè¦è°ƒç”¨<code>next()</code>æ–¹æ³•æ¥ resolve è¿™ä¸ªé’©å­ã€‚æ‰§è¡Œæ•ˆæœä¾èµ– next æ–¹æ³•çš„è°ƒç”¨å‚æ•°ã€‚</p> <ol start="2"><li>å…¨å±€è§£æå®ˆå«ï¼š router.beforeResolve</li></ol> <p>å’Œ router.beforeEach ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯åœ¨å¯¼èˆªè¢«ç¡®è®¤ä¹‹å‰ï¼ŒåŒæ—¶åœ¨æ‰€æœ‰ç»„ä»¶å†…å®ˆå«å’Œå¼‚æ­¥è·¯ç”±ç»„ä»¶è¢«è§£æä¹‹åï¼Œè§£æå®ˆå«å°±è¢«è°ƒç”¨ã€‚</p> <ol start="3"><li><p>å…¨å±€åç½®é’©å­ï¼š router.afterEach</p></li> <li><p>è·¯ç”±ç‹¬äº«çš„å®ˆå«ï¼š beforeEnter</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ä½ å¯ä»¥åœ¨è·¯ç”±é…ç½®ä¸Šç›´æ¥å®šä¹‰ beforeEnter å®ˆå«ï¼Œä½œç”¨ç±»ä¼¼ç”¨beforeEnter</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;/foo&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">component</span><span class="token operator">:</span> Foo<span class="token punctuation">,</span>
            <span class="token function-variable function">beforeEnter</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">// ...</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="5"><li>ç»„ä»¶å†…çš„å®ˆå«ï¼š beforeRouteEnterã€beforeRouteUpdate (2.2 æ–°å¢)ã€beforeRouteLeave</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> Foo <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">...</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token function">beforeRouteEnter</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åœ¨æ¸²æŸ“è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±è¢« confirm å‰è°ƒç”¨</span>
        <span class="token comment">// ä¸èƒ½è·å–ç»„ä»¶å®ä¾‹ `this`</span>
        <span class="token comment">// å› ä¸ºå½“å®ˆå«æ‰§è¡Œå‰ï¼Œç»„ä»¶å®ä¾‹è¿˜æ²¡è¢«åˆ›å»º</span>

        <span class="token comment">//ä¸è¿‡ï¼Œå¯ä»¥é€šè¿‡ä¼ ä¸€ä¸ªå›è°ƒç»™ nextæ¥è®¿é—®ç»„ä»¶å®ä¾‹ã€‚</span>
        <span class="token comment">//åœ¨å¯¼èˆªè¢«ç¡®è®¤çš„æ—¶å€™æ‰§è¡Œå›è°ƒï¼Œå¹¶ä¸”æŠŠç»„ä»¶å®ä¾‹ä½œä¸ºå›è°ƒæ–¹æ³•çš„å‚æ•°ã€‚</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// é€šè¿‡ `vm` è®¿é—®ç»„ä»¶å®ä¾‹</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">beforeRouteUpdate</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åœ¨å½“å‰è·¯ç”±æ”¹å˜ï¼Œä½†æ˜¯è¯¥ç»„ä»¶è¢«å¤ç”¨æ—¶è°ƒç”¨</span>
        <span class="token comment">// ä¸¾ä¾‹æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªå¸¦æœ‰åŠ¨æ€å‚æ•°çš„è·¯å¾„ /foo/:idï¼Œåœ¨ /foo/1 å’Œ /foo/2 ä¹‹é—´è·³è½¬çš„æ—¶å€™ï¼Œ</span>
        <span class="token comment">// ç”±äºä¼šæ¸²æŸ“åŒæ ·çš„ Foo ç»„ä»¶ï¼Œå› æ­¤ç»„ä»¶å®ä¾‹ä¼šè¢«å¤ç”¨ã€‚è€Œè¿™ä¸ªé’©å­å°±ä¼šåœ¨è¿™ä¸ªæƒ…å†µä¸‹è¢«è°ƒç”¨ã€‚</span>
        <span class="token comment">// å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this`</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// é€šå¸¸ç”¨æ¥ç¦æ­¢ç”¨æˆ·åœ¨è¿˜æœªä¿å­˜ä¿®æ”¹å‰çªç„¶ç¦»å¼€ã€‚è¯¥å¯¼èˆªå¯ä»¥é€šè¿‡ next(false) æ¥å–æ¶ˆ</span>
    <span class="token function">beforeRouteLeave</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¯¼èˆªç¦»å¼€è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±æ—¶è°ƒç”¨</span>
        <span class="token comment">// å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this`</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_031-å®Œæ•´çš„å¯¼èˆªè§£ææµç¨‹"><a href="#_031-å®Œæ•´çš„å¯¼èˆªè§£ææµç¨‹" class="header-anchor">#</a> 031ï¼šå®Œæ•´çš„å¯¼èˆªè§£ææµç¨‹</h2> <ol><li><p>å¯¼èˆªè¢«è§¦å‘ã€‚</p></li> <li><p>åœ¨å¤±æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteLeave å®ˆå«ã€‚</p></li> <li><p>è°ƒç”¨å…¨å±€çš„ beforeEach å®ˆå«ã€‚</p></li> <li><p>åœ¨é‡ç”¨çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteUpdate å®ˆå« (2.2+)ã€‚</p></li> <li><p>åœ¨è·¯ç”±é…ç½®é‡Œè°ƒç”¨ beforeEnterã€‚</p></li> <li><p>è§£æå¼‚æ­¥è·¯ç”±ç»„ä»¶ã€‚</p></li> <li><p>åœ¨è¢«æ¿€æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteEnterã€‚</p></li> <li><p>ç”¨å…¨å±€çš„ beforeResolve å®ˆå« (2.5+)ã€‚</p></li> <li><p>å¯¼èˆªè¢«ç¡®è®¤ã€‚</p></li> <li><p>è°ƒç”¨å…¨å±€çš„ afterEach é’©å­ã€‚</p></li> <li><p>è§¦å‘ DOM æ›´æ–°ï¼ˆä» beforeCreate -&gt; created -&gt; beforeMount -&gt; mounted [-&gt; activated]ï¼‰ã€‚</p></li> <li><p>è°ƒç”¨ beforeRouteEnter å®ˆå«ä¸­ä¼ ç»™ next çš„å›è°ƒå‡½æ•°ï¼Œåˆ›å»ºå¥½çš„ç»„ä»¶å®ä¾‹ä¼šä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ä¼ å…¥ã€‚</p></li></ol> <h2 id="_032-ç®€å•èŠèŠ-new-vue-ä»¥åå‘ç”Ÿçš„äº‹æƒ…"><a href="#_032-ç®€å•èŠèŠ-new-vue-ä»¥åå‘ç”Ÿçš„äº‹æƒ…" class="header-anchor">#</a> 032ï¼šç®€å•èŠèŠ new Vue ä»¥åå‘ç”Ÿçš„äº‹æƒ…</h2> <p>åœ¨ vue çš„ç”Ÿå‘½å‘¨æœŸä¸Šç¬¬ä¸€ä¸ªå°±æ˜¯ new Vue() åˆ›å»ºä¸€ä¸ª vue å®ä¾‹å‡ºæ¥ï¼Œå¯¹åº”åˆ°æºç åœ¨\vue-dev\src\core\instance\index.js:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Vue</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Vue</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span>
            <span class="token string">&quot;Vue is a constructor and should be called with the `new` keyword&quot;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_init</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">initMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">stateMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">eventsMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">lifecycleMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">renderMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// vue åˆå§‹åŒ–ä¸»è¦å°±å¹²äº†å‡ ä»¶äº‹æƒ…ï¼Œåˆå¹¶é…ç½®ï¼Œåˆå§‹åŒ–ç”Ÿå‘½å‘¨æœŸï¼Œåˆå§‹åŒ–äº‹ä»¶ä¸­å¿ƒï¼Œåˆå§‹åŒ–æ¸²æŸ“ï¼Œåˆå§‹åŒ–dataã€propsã€computedã€watcher ç­‰ç­‰</span>
</code></pre></div><h2 id="_033-æ¨¡æ¿å­—ç¬¦ä¸²è§£æ"><a href="#_033-æ¨¡æ¿å­—ç¬¦ä¸²è§£æ" class="header-anchor">#</a> 033ï¼šæ¨¡æ¿å­—ç¬¦ä¸²è§£æ</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> template <span class="token operator">=</span> <span class="token string">&quot;æˆ‘æ˜¯{{name}}ï¼Œå¹´é¾„{{age}}ï¼Œæ€§åˆ«{{sex}}&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;chieminchan&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token string">&quot;girl&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">template<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> computed <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\{\{(\w+)\}\}</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">match<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>match<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> computed<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">render</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/fragments/" class="prev router-link-active">
        ğŸŒ» çŸ¥è¯†ç¢ç‰‡
      </a></span> <span class="next"><a href="/fragments/Network.html">
        ğŸŒµ ç½‘ç»œ
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.448d156c.js" defer></script><script src="/assets/js/2.fefa3fa1.js" defer></script><script src="/assets/js/1.67a15f5a.js" defer></script><script src="/assets/js/78.81fd1ead.js" defer></script>
  </body>
</html>
