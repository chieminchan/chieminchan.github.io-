<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>🌵 JavaScript | CHIEMINCHAN&#39;S BLOG</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/images/donut.png">
    <meta name="description" content="Hi, glad you came.">
    
    <link rel="preload" href="/assets/css/0.styles.8f3dca9f.css" as="style"><link rel="preload" href="/assets/js/app.448d156c.js" as="script"><link rel="preload" href="/assets/js/2.fefa3fa1.js" as="script"><link rel="preload" href="/assets/js/1.67a15f5a.js" as="script"><link rel="preload" href="/assets/js/75.b006fb40.js" as="script"><link rel="prefetch" href="/assets/js/10.5229b01a.js"><link rel="prefetch" href="/assets/js/11.9dccb5a1.js"><link rel="prefetch" href="/assets/js/12.1aa023e7.js"><link rel="prefetch" href="/assets/js/13.da540175.js"><link rel="prefetch" href="/assets/js/14.981e669d.js"><link rel="prefetch" href="/assets/js/15.f28dd0b3.js"><link rel="prefetch" href="/assets/js/16.47e1d84d.js"><link rel="prefetch" href="/assets/js/17.7ff34030.js"><link rel="prefetch" href="/assets/js/18.6dcbdd16.js"><link rel="prefetch" href="/assets/js/19.e568fd00.js"><link rel="prefetch" href="/assets/js/20.182f1f9b.js"><link rel="prefetch" href="/assets/js/21.b834a74a.js"><link rel="prefetch" href="/assets/js/22.a3523cd2.js"><link rel="prefetch" href="/assets/js/23.61d15c5b.js"><link rel="prefetch" href="/assets/js/24.2aadb209.js"><link rel="prefetch" href="/assets/js/25.836695fb.js"><link rel="prefetch" href="/assets/js/26.0ab922cb.js"><link rel="prefetch" href="/assets/js/27.5ac9e339.js"><link rel="prefetch" href="/assets/js/28.d6a5eb15.js"><link rel="prefetch" href="/assets/js/29.3eea682e.js"><link rel="prefetch" href="/assets/js/3.fc739620.js"><link rel="prefetch" href="/assets/js/30.5225944d.js"><link rel="prefetch" href="/assets/js/31.ec02d3da.js"><link rel="prefetch" href="/assets/js/32.bd05dede.js"><link rel="prefetch" href="/assets/js/33.4a293dcf.js"><link rel="prefetch" href="/assets/js/34.4464026b.js"><link rel="prefetch" href="/assets/js/35.4dd4f327.js"><link rel="prefetch" href="/assets/js/36.ca28dda7.js"><link rel="prefetch" href="/assets/js/37.3a17971f.js"><link rel="prefetch" href="/assets/js/38.f86fa51b.js"><link rel="prefetch" href="/assets/js/39.6ff149b0.js"><link rel="prefetch" href="/assets/js/4.0471e9ae.js"><link rel="prefetch" href="/assets/js/40.23565895.js"><link rel="prefetch" href="/assets/js/41.0116a1ec.js"><link rel="prefetch" href="/assets/js/42.c38f3e0c.js"><link rel="prefetch" href="/assets/js/43.1d0d8ffd.js"><link rel="prefetch" href="/assets/js/44.631fa43e.js"><link rel="prefetch" href="/assets/js/45.0f88df1f.js"><link rel="prefetch" href="/assets/js/46.cc671ab0.js"><link rel="prefetch" href="/assets/js/47.90cce12d.js"><link rel="prefetch" href="/assets/js/48.ad0ce6a4.js"><link rel="prefetch" href="/assets/js/49.ade35f37.js"><link rel="prefetch" href="/assets/js/5.5356be46.js"><link rel="prefetch" href="/assets/js/50.de00c31b.js"><link rel="prefetch" href="/assets/js/51.9de8257a.js"><link rel="prefetch" href="/assets/js/52.50f1abf2.js"><link rel="prefetch" href="/assets/js/53.b3b3acb2.js"><link rel="prefetch" href="/assets/js/54.71bfe1b2.js"><link rel="prefetch" href="/assets/js/55.b00cfb1c.js"><link rel="prefetch" href="/assets/js/56.1bb058d3.js"><link rel="prefetch" href="/assets/js/57.5651fd65.js"><link rel="prefetch" href="/assets/js/58.3dd11306.js"><link rel="prefetch" href="/assets/js/59.233d45e8.js"><link rel="prefetch" href="/assets/js/6.5b3d5499.js"><link rel="prefetch" href="/assets/js/60.7c729149.js"><link rel="prefetch" href="/assets/js/61.eb5805f6.js"><link rel="prefetch" href="/assets/js/62.fde12179.js"><link rel="prefetch" href="/assets/js/63.3358d1e0.js"><link rel="prefetch" href="/assets/js/64.1b930210.js"><link rel="prefetch" href="/assets/js/65.3048ba53.js"><link rel="prefetch" href="/assets/js/66.a065502e.js"><link rel="prefetch" href="/assets/js/67.715eef17.js"><link rel="prefetch" href="/assets/js/68.edf44196.js"><link rel="prefetch" href="/assets/js/69.94cb6d60.js"><link rel="prefetch" href="/assets/js/7.c94df317.js"><link rel="prefetch" href="/assets/js/70.9061bb98.js"><link rel="prefetch" href="/assets/js/71.980c8e32.js"><link rel="prefetch" href="/assets/js/72.43be58ba.js"><link rel="prefetch" href="/assets/js/73.e2f40377.js"><link rel="prefetch" href="/assets/js/74.9ef8a48c.js"><link rel="prefetch" href="/assets/js/76.311cf38f.js"><link rel="prefetch" href="/assets/js/77.2d4b2c6d.js"><link rel="prefetch" href="/assets/js/78.81fd1ead.js"><link rel="prefetch" href="/assets/js/79.01e24fba.js"><link rel="prefetch" href="/assets/js/80.b15cc1f3.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.934ed2fb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f3dca9f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">CHIEMINCHAN'S BLOG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/articles/" class="nav-link">
  文章
</a></div><div class="nav-item"><a href="/fragments/" class="nav-link router-link-active">
  知识碎片
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/reading/" class="nav-link">
  读/观后感
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/chieminchan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/articles/" class="nav-link">
  文章
</a></div><div class="nav-item"><a href="/fragments/" class="nav-link router-link-active">
  知识碎片
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/reading/" class="nav-link">
  读/观后感
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/chieminchan" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>知识碎片</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fragments/" aria-current="page" class="sidebar-link">🌻 知识碎片</a></li><li><a href="/fragments/Vue.html" class="sidebar-link">🌵 Vue</a></li><li><a href="/fragments/Network.html" class="sidebar-link">🌵 网络</a></li><li><a href="/fragments/JavaScript.html" aria-current="page" class="active sidebar-link">🌵 JavaScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_001-js-中的数据类型有哪些-区别是什么" class="sidebar-link">001： JS 中的数据类型有哪些，区别是什么？</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_002-请写出如下代码的打印结果。" class="sidebar-link">002： 请写出如下代码的打印结果。</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_003-列出判断数据类型的方法和区别。" class="sidebar-link">003： 列出判断数据类型的方法和区别。</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_004-和-有什么区别" class="sidebar-link">004： == 和 ===有什么区别？</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_005-如何理解作用域链-作用域链的尽头是什么-针对变量" class="sidebar-link">005： 如何理解作用域链，作用域链的尽头是什么？（针对变量）</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_006-什么是闭包-为什么要用它" class="sidebar-link">006： 什么是闭包，为什么要用它？</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_007-原型和构造函数的关系-如何理解原型链-针对对象属性" class="sidebar-link">007： 原型和构造函数的关系，如何理解原型链？（针对对象属性）</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_008-new-具体干了些什么-通过-new-的方式创建对象和通过字面量创建有什么区别-模拟实现-new" class="sidebar-link">008： new 具体干了些什么？通过 new 的方式创建对象和通过字面量创建有什么区别？模拟实现 new？</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_009-call、apply-和-bind-的区别-模拟实现-bind、call" class="sidebar-link">009： call、apply 和 bind 的区别，模拟实现 bind、call？</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_010-对-this-指向的理解" class="sidebar-link">010： 对 this 指向的理解</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_011-事件流、事件对象、事件处理程序、事件委托" class="sidebar-link">011： 事件流、事件对象、事件处理程序、事件委托</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_012-深拷贝和浅拷贝-哪些栗子" class="sidebar-link">012： 深拷贝和浅拷贝，哪些栗子？</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_013-什么是防抖和节流-有什么区别-如何实现" class="sidebar-link">013： 什么是防抖和节流？有什么区别？如何实现？</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_014-浏览器重绘和回流" class="sidebar-link">014： 浏览器重绘和回流？</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_015-createdocumentfragment-创建文档碎片节点" class="sidebar-link">015： createDocumentFragment 创建文档碎片节点</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_016-for-in-和-for-of-区别" class="sidebar-link">016： for..in 和 for..of 区别</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_017-javascript-如何实现继承-不同方式的优缺点" class="sidebar-link">017：JavaScript 如何实现继承？(不同方式的优缺点)</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_019-javascript-的类和-es6-的-class-区别" class="sidebar-link">019：JavaScript 的类和 ES6 的 class 区别</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_020-javascript-的设计模式" class="sidebar-link">020：JavaScript 的设计模式</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_021-reduce" class="sidebar-link">021：reduce</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_022-compose" class="sidebar-link">022：compose</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_023-数组方法中的-indexof-和-includes-实现" class="sidebar-link">023：数组方法中的 indexOf 和 includes 实现</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_024-什么是-symbol-它的使用场景是什么" class="sidebar-link">024：什么是 Symbol，它的使用场景是什么</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_025-object-keys、object-getownpropertynames、object-getpropertysymbols" class="sidebar-link">025：Object.keys、Object.getOwnPropertyNames、Object.getPropertySymbols</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_026-window-onload-和-domcontentloaded" class="sidebar-link">026：window.onload 和 DOMContentLoaded</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_027-valueof-和-tostring" class="sidebar-link">027：valueOf 和 toString</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_029-柯里化" class="sidebar-link">029：柯里化</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_030-实现一个-add-方法" class="sidebar-link">030：实现一个 add 方法</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_031-实现-string-的-indexof-方法" class="sidebar-link">031：实现 String 的 indexOf 方法</a></li><li class="sidebar-sub-header"><a href="/fragments/JavaScript.html#_032-类数组转数组的方法" class="sidebar-link">032：类数组转数组的方法</a></li></ul></li><li><a href="/fragments/JavaScript Algorithms.html" class="sidebar-link">🌵 JavaScript 基础算法</a></li><li><a href="/fragments/ES6.html" class="sidebar-link">🌵 ES6</a></li><li><a href="/fragments/CSS.html" class="sidebar-link">🌵 CSS</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript"><a href="#javascript" class="header-anchor">#</a> 🌵 JavaScript</h1> <h2 id="_001-js-中的数据类型有哪些-区别是什么"><a href="#_001-js-中的数据类型有哪些-区别是什么" class="header-anchor">#</a> 001： JS 中的数据类型有哪些，区别是什么？</h2> <ol><li><p>原始类型有（可以用 typeof 检查）：Boolean 、String 、Number 、Undefined 、Null 、Symbol（ES6） 、BigInt（ES2020）</p></li> <li><p>对象类型有：对象 Object（包含普通对象 Object 、数组 Array 、函数 Function 、正则 RegExp 、日期 Date 、数学函数 Math ）</p></li> <li><p>不同之处：原始类型储存值，对象类型储存地址。</p></li> <li><p>注意点：<br>
（1）闭包变量存储在堆内存；<br>
（2）typeof null -&gt; object，但 null 严谨来说不是对象，是历史遗留的 bug，000 开头代表是对象然而 null 表示为全零，所以将它错误的判断为 object；<br>
（3）number 是浮点类型，浮点运算时会有 bug。<br>
（4）BigInt 是一种新的数据类型，用于当整数值大于 Number 数据类型支持的范围时。这种数据类型允许我们安全地对大整数执行算术操作，表示高分辨率的时间戳，使用大整数 id，等等，而不需要使用库。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">9007199254740992</span> <span class="token operator">===</span> <span class="token number">9007199254740993</span><span class="token punctuation">;</span> <span class="token comment">// true (Number的最大安全数为2^53-1)</span>
<span class="token number">9007199254740992</span> <span class="token operator">===</span> <span class="token number">9007199254740993n</span><span class="token punctuation">;</span> <span class="token comment">// false (要创建BigInt，只需要在数字末尾追加n即可)</span>
</code></pre></div></li></ol> <h4 id="_0-1-0-2-0-3-打印什么"><a href="#_0-1-0-2-0-3-打印什么" class="header-anchor">#</a> 0.1 + 0.2 === 0.3 打印什么</h4> <p>false。</p> <p>JavaScirpt 使用 Number 类型来表示数字（包括整数或浮点数），遵循 IEEE 754 标准 通过 64 位来表示一个数字。</p> <p>第 0 位：符号位 a，0 表示正数 ，1 表示负数；第 1 位到第 11 位：储存指数部分 e；第 12 位到第 63 位：储存小数部分（即有效数字）f。</p> <p>二进制表示有效数字总是 1.xx…xx 的形式，有效数字尾数部分 f 在规约形式下第一位默认为 1（省略不写，xx..xx 为尾数部分 f，最长 52 位）。因此，JavaScript 提供的有效数字最长为 53 个二进制位（64 位浮点的后 52 位+被省略的 1 位）因此 js 最大安全数是 <code>Number.MAX_SAFE_INTEGER === Math.pow(2,53) - 1</code>, 而不是 Math.pow(2,52) - 1</p> <p>在两数相加时，<strong>计算机无法直接对十进制的数字进行运算</strong>，这是硬件物理特性已经决定的。先<strong>按照 IEEE 754 转成相应的二进制，然后对阶运算</strong>。</p> <p>0.1 和 0.2 转换成二进制的时候尾数会发生无限循环，且由于 IEEE 754 尾数位数限制，需要将后面多余的位截掉；</p> <p>由于指数位数不相同，运算时需要对阶运算（两个进行运算的浮点数的阶码对齐，使两个浮点数的尾数能够对齐进行加减运算），JS 引擎对二进制进行截断，所以造成精度丢失。</p> <p>（本质是 二进制模拟十进制进行计算时 的精度问题。）</p> <p>相关文章：<a href="https://juejin.cn/post/6844903680362151950" target="_blank" rel="noopener noreferrer">0.1 + 0.2 不等于 0.3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="为什么-x-0-1-能得到-0-1"><a href="#为什么-x-0-1-能得到-0-1" class="header-anchor">#</a> 为什么 x=0.1 能得到 0.1？</h4> <p>这是因为这个 0.1 并不是真正的 0.1，JS 最大可以表示 2^53(9007199254740992), 长度是 16，所以可以使用 toPrecision(16) 来做精度运算。超过的精度会自动做凑整处理。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">0.10000000000000000555</span><span class="token punctuation">.</span><span class="token function">toPrecision</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
<span class="token comment">// 返回 0.1000000000000000，去掉末尾的零后正好为 0.1</span>

<span class="token comment">// 但来一个更高的精度：</span>
<span class="token number">0.1</span><span class="token punctuation">.</span><span class="token function">toPrecision</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.100000000000000005551</span>
</code></pre></div><h4 id="怎么解决精度问题"><a href="#怎么解决精度问题" class="header-anchor">#</a> 怎么解决精度问题？</h4> <p>（1）将数字转成整数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> num1Base <span class="token operator">=</span> num1<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">const</span> num2Base <span class="token operator">=</span> num2<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

    <span class="token keyword">const</span> parse <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>num1Base<span class="token punctuation">,</span> num2Base<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>num1 <span class="token operator">*</span> parse <span class="token operator">+</span> num2 <span class="token operator">*</span> parse<span class="token punctuation">)</span> <span class="token operator">/</span> parse<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>（2）三方库 - Math.js</p> <h4 id="js-整数是怎么表示"><a href="#js-整数是怎么表示" class="header-anchor">#</a> JS 整数是怎么表示</h4> <p>通过 Number 类型来表示，遵循 IEEE754 标准，通过 64 位来表示一个数字，（1 + 11 + 52），最大安全数字是 Math.pow(2, 53) - 1，对应是 16 位十进制。（符号位 + 指数位 + 小数部分有效位）</p> <p>Number() 的存储空间是 Math.pow(2, 53) ，53 为有效数字，等于 JS 能支持的最大数字。如果接收到一个超过范围的数字会自动被截断。</p> <h2 id="_002-请写出如下代码的打印结果。"><a href="#_002-请写出如下代码的打印结果。" class="header-anchor">#</a> 002： 请写出如下代码的打印结果。</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">&quot;chieminchan&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">changeTest</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    name <span class="token operator">=</span> <span class="token string">&quot;kate&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">changeTest</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// -&gt; chieminchan</span>

<span class="token comment">// 这里把 name 变量对应的值 chieminchan 传入函数 changeTest，然后复制给了的一个局部变量，改变局部变量的值不会对外部变量产生影响，因此打印的依然的是 chieminchan</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;chieminchan&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">changeTest</span><span class="token punctuation">(</span><span class="token parameter">person</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>
    person <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;jack&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> person<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> person2 <span class="token operator">=</span> <span class="token function">changeTest</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// -&gt; ?</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// -&gt; ?</span>
</code></pre></div><p>这里看似成了地址传递，但其实这一段和上一段 js 代码的函数传参方式都是值传递。</p> <p>此处将 person1 对应的值传入了 changeTest 函数，同样地将这个值复制了一个副本给函数里面的局部变量，只不过这个局部变量的值是指向堆内存中的地址。这时候，在函数内部对这个局部变量的属性进行修改，就变成了对 这个局部变量 所指向的堆内存地址 的值进行修改。</p> <p>因为外部变量 person1 的值也是指向同一个堆内存的地址，因此外部变量的值也一并发生了变化。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// -&gt; { name: 'chieminchan', age : 22 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// -&gt; { name: 'jack', age: 24 }</span>
</code></pre></div><p><strong>考察点：ECMAScript 所有的函数的参数都是按值传递，即函数参数传递的是变量的值。</strong></p> <h2 id="_003-列出判断数据类型的方法和区别。"><a href="#_003-列出判断数据类型的方法和区别。" class="header-anchor">#</a> 003： 列出判断数据类型的方法和区别。</h2> <h4 id="_1-常用的-typeof"><a href="#_1-常用的-typeof" class="header-anchor">#</a> （1）常用的 typeof</h4> <p>对于原始类型来说，除了 null，typeof 可以正确显示对应的数据类型：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">typeof</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 'number'</span>
<span class="token keyword">typeof</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">;</span> <span class="token comment">//'string'</span>
<span class="token keyword">typeof</span> True<span class="token punctuation">;</span> <span class="token comment">// 'boolean'</span>
<span class="token keyword">typeof</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">//'undefined'</span>
<span class="token keyword">typeof</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'symbol'</span>

<span class="token keyword">typeof</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;object&quot;,new String会返回一个对象</span>
<span class="token keyword">typeof</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;string&quot;,String 会返回一个字符串</span>
</code></pre></div><p>但对于对象类型来说，除了函数，都会显示<code>object</code>，因此<code>typeof</code>不能准确地对数据类型进行判断：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 'object'</span>
<span class="token keyword">typeof</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//'object'</span>
<span class="token keyword">typeof</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 'function'</span>

<span class="token comment">// 特殊例子</span>
<span class="token keyword">typeof</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">//'object'</span>
<span class="token keyword">typeof</span> Object<span class="token punctuation">;</span> <span class="token comment">// 'function'</span>
<span class="token keyword">typeof</span> <span class="token function">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'object'</span>
</code></pre></div><h4 id="_2-instanceof-内部机制是通过原型链来判断-一般用来判断对象类型"><a href="#_2-instanceof-内部机制是通过原型链来判断-一般用来判断对象类型" class="header-anchor">#</a> (2）instanceof（内部机制是通过原型链来判断，一般用来判断对象类型）</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">Person</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p1 <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token keyword">const</span> str1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
str1 <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
a <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">;</span> <span class="token comment">//true;</span>
a <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token comment">//true;</span>

<span class="token keyword">null</span> <span class="token keyword">instanceof</span> <span class="token class-name">object</span><span class="token punctuation">;</span> <span class="token comment">//false;</span>
</code></pre></div><h4 id="_3-object-prototype-tostring-call"><a href="#_3-object-prototype-tostring-call" class="header-anchor">#</a> (3) Object.prototype.toString.call</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[object Function]&quot;;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[object Array]&quot;</span>

<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[object String]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[object String]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;[object Number]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;[object Null]&quot;</span>
</code></pre></div><p>参考文章：<br> <a href="https://juejin.cn/post/6844903613584654344" target="_blank" rel="noopener noreferrer">浅谈 instanceof 和 typeof 的实现原理<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="typeof-实现原理"><a href="#typeof-实现原理" class="header-anchor">#</a> typeof 实现原理</h4> <p>typeof 是通过获取<strong>数据底层的类型标签</strong>来获取类型信息。</p> <p>JS 在底层存储变量的时候，会在变量的机器码的低位 1-3 位存储其类型信息：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">000</span>：对象
<span class="token number">010</span>：浮点数
<span class="token number">100</span>：字符串
<span class="token number">110</span>：布尔
<span class="token number">1</span>：整数
</code></pre></div><p>对于 <code>undefined</code> 和 <code>null</code> 来说，这两个值的信息存储是有点特殊，<code>nul</code>l：所有机器码均为 0，<code>undefined</code>：用 −2^30 整数来表示。</p> <p>typeof 在判断 null 的时候就出现问题了，由于 null 的所有机器码均为 0，因此直接被当做了对象来看待。</p> <h4 id="instanceof-实现原理"><a href="#instanceof-实现原理" class="header-anchor">#</a> instanceof 实现原理</h4> <p>instanceof 的实现原理：</p> <blockquote><p>instanceof 主要的实现原理就是只要右边变量的 prototype 在左边变量的原型链上即可。</p></blockquote> <p>因此，instanceof 在查找的过程中会遍历左边变量的原型链，直到找到右边变量的 prototype，如果查找失败，则会返回 false，告诉我们左边变量并非是右边变量的实例。</p> <h4 id="instanceof-手写实现"><a href="#instanceof-手写实现" class="header-anchor">#</a> instanceof 手写实现</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_instanceof</span><span class="token punctuation">(</span><span class="token parameter">instance<span class="token punctuation">,</span> right</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> rightProto <span class="token operator">=</span> right<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
    <span class="token keyword">const</span> instanceProto <span class="token operator">=</span> instance<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instanceProto <span class="token operator">===</span> rightProto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>instanceProto <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        instanceProto <span class="token operator">=</span> instanceProto<span class="token punctuation">.</span>__proto_<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="顺带引出一些例子"><a href="#顺带引出一些例子" class="header-anchor">#</a> 顺带引出一些例子</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Function Object都是由函数构造</span>
Function <span class="token keyword">instanceof</span> <span class="token class-name">Function</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
Function <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token comment">//Object.__proto__ = Object.prototype</span>
<span class="token comment">// Object.prototype为一个对象，</span>
Object <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
Object <span class="token keyword">instanceof</span> <span class="token class-name">Funciton</span><span class="token punctuation">;</span> <span class="token comment">// true（对象由函数创建）</span>

<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Foo <span class="token keyword">instanceof</span> <span class="token class-name">Foo</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
Foo <span class="token keyword">instanceof</span> <span class="token class-name">Function</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
Foo <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p><img src="https://raw.githubusercontent.com/chieminchan/chieminchan.github.io/master/images/interviews/JS-prototype.jpg" alt="原型图"></p> <h4 id="但对于原始类型不能直接通过-instanceof-来判断类型-特殊例子"><a href="#但对于原始类型不能直接通过-instanceof-来判断类型-特殊例子" class="header-anchor">#</a> 但对于原始类型不能直接通过 instanceof 来判断类型，特殊例子：</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">;</span>
str <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

<span class="token keyword">let</span> str2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">typeof</span> str2<span class="token punctuation">;</span> <span class="token comment">// &quot;object&quot;</span>
str2 <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>需要利用<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/hasInstance" target="_blank" rel="noopener noreferrer">Symbol.hasInstance<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>将原有的 instanceof 方法重定义，换成了 typeof，才能能够判断基本数据类型：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">PrimitiveNumber</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">111</span> <span class="token keyword">instanceof</span> <span class="token class-name">PrimitiveNumber</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h2 id="_004-和-有什么区别"><a href="#_004-和-有什么区别" class="header-anchor">#</a> 004： == 和 ===有什么区别？</h2> <p>=== 为严格相等，而 == 比 === 条件更宽松。<br>
=== 要求两边的值和类型都要相同， == 在比较时只要求值相同。</p> <p>== 比较值的规则：<br>
（1）首先会判断两者类型是否相同。相同的话就是比大小了；类型不相同的话，那么就会进行类型转换：<br>
（2）会先判断是否在对比 null 和 undefined，是的话返回 true ；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">null</span> <span class="token operator">==</span> <span class="token keyword">undefined</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">true</span>
</code></pre></div><p>（3）判断两者类型是否为 string 和 number，是的话就会将<strong>字符串 转换为 Number</strong>；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1</span> <span class="token operator">==</span> <span class="token string">'1'</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">==</span>  <span class="token number">1</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">true</span>
</code></pre></div><p>（4）判断其中一方是否是 Boolean，是的话就把 <strong>Boolean 转换成 Number</strong>，再进行比较；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'1'</span> <span class="token operator">==</span> <span class="token boolean">true</span>   <span class="token operator">-</span><span class="token operator">&gt;</span>  <span class="token string">'1'</span> <span class="token operator">==</span>  <span class="token number">1</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">1</span>  <span class="token operator">==</span>  <span class="token number">1</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">true</span>
</code></pre></div><p><strong>PS: 请记住 6 个虚值（null，undefined，''，0，NaN，false） -&gt; 转成布尔都会是 false</strong></p> <p>（5）如果其中一方为 Object，且另一方为 String、Number 或者 Symbol，会将 <strong>Object 转换成 原始类型</strong>，再进行比较。<br>
(PS：这里会优先通过 valueOf 进行转换，如果 valueOf 输出的值类型是引用类型，将会通过 toString 进行转换)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token operator">==</span> <span class="token number">1</span>
<span class="token operator">-</span><span class="token operator">&gt;</span>  <span class="token string">'[object Object]'</span> <span class="token operator">==</span> <span class="token number">1</span>
<span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">NaN</span> <span class="token operator">==</span> <span class="token number">1</span>
<span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">false</span>

<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
 <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token punctuation">(</span>！的优先级是大于 <span class="token operator">==</span> 的，先执行后者<span class="token punctuation">)</span>
 <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> （按照第（<span class="token number">4</span>）点来，其中一方是 Boolean 要先转换成 Number）
 <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token string">''</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">(</span>按照第（<span class="token number">5</span>）点来，一方为Object，需valueOf转成原始类型<span class="token punctuation">)</span>
 <span class="token operator">-</span><span class="token operator">&gt;</span>  <span class="token number">0</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">(</span>按照第（<span class="token number">3</span>）点来，<span class="token string">''</span><span class="token function">转数字，Number</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>值为<span class="token number">0</span><span class="token punctuation">)</span>
 <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">true</span>

<span class="token comment">//如果两个操作数都是对象，则比较它们是不是同一个对象引用，如果两个操作数都指向同一个对象</span>
<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">false</span>

<span class="token comment">// 验证（5）</span>
<span class="token keyword">const</span> test <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
test<span class="token punctuation">.</span><span class="token function-variable function">valueOf</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'valueOf'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
test<span class="token punctuation">.</span><span class="token function-variable function">toString</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'toString'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">'1'</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>test <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// valueOf  toString  true</span>
</code></pre></div><p>(更详细规则详情戳<a href="https://www.ecma-international.org/ecma-262/5.1/#sec-11.9.3" target="_blank" rel="noopener noreferrer">这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p> <h4 id="加号的隐形转换"><a href="#加号的隐形转换" class="header-anchor">#</a> 加号的隐形转换</h4> <ul><li><a href="https://segmentfault.com/a/1190000008038678" target="_blank" rel="noopener noreferrer">加号的隐形转换<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <blockquote><p>在加号中，会使用 ToPrimitive 运算转换左与右运算元为原始数据类型值(primitive)</p></blockquote> <blockquote><p>在第 1 步转换后，如果有运算元出现<strong>原始数据类型是&quot;字符串&quot;类型值时，则另一运算元作强制转换为字符串，然后作字符串的连接运算(concatenation)</strong></p></blockquote> <blockquote><p>在其他情况时，<strong>所有运算元都会转换为原始数据类型的&quot;数字&quot;类型值，然后作数学的相加运算(addition)</strong></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> ？
<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> ？
</code></pre></div><p>引用知乎的回答：https://www.zhihu.com/question/45478070?sort=created：</p> <ul><li><p>先说 <code>[] + {}</code> 。<br>
一个数组加一个对象。</p> <p>加法会进行隐式类型转换，规则是调用其 valueOf() 或 toString() 以取得一个非对象的值（primitive value）。</p> <p><strong>如果两个值中的任何一个是字符串，则进行字符串串接，否则进行数字加法。</strong></p> <p>[] 和 {} 的 valueOf() 都返回对象自身（一个空数组和一个空对象），所以都会调用 toString()，最后的结果是字符串串接。</p> <p>[].toString() 返回空字符串，({}).toString() 返回“[object Object]”。最后的结果就是“[object Object]”。</p></li> <li><p><code>{} + []</code><br>
{} 除了表示一个对象之外，也可以表示一个空的 block。</p> <p>在 <code>{} + []</code> 中，如果<code>{}(空对象)</code>在前面，而<code>[](空数组)</code>在后面时，前面(左边)那个运算元会被认为是区块语句而不是对象字面量。</p> <p>所以<code>{} + []</code>相当于<code>+[]</code>语句，也就是相当于强制求出数字值的 Number([])运算，相当于 Number(&quot;&quot;)运算，最后得出的是 0 数字。</p> <p>{} 被解析为空的 block，随后的 + 被解析为正号运算符。即实际上被解析成成了：<code>{ // empty block }</code>。</p> <p><code>+[]</code> 即对一个空数组执行正号运算，实际上就是把数组转型为数字。首先调用 [].valueOf(),返回数组自身，不是 primitive value，因此继续调用 [].toString() ，返回空字符串。空字符串转型为数字，返回 0，即最后的结果。</p></li></ul> <h2 id="_005-如何理解作用域链-作用域链的尽头是什么-针对变量"><a href="#_005-如何理解作用域链-作用域链的尽头是什么-针对变量" class="header-anchor">#</a> 005： 如何理解作用域链，作用域链的尽头是什么？（针对变量）</h2> <p>（1）作用域是<strong>定义变量的区域</strong>，可确定当前执行代码对变量的访问权限，同时也决定了变量的生命周期。<strong>Javascript 采用的是词法作用域（就是静态作用域）</strong>，函数的作用域<strong>基于函数创建的位置</strong>，函数一旦创建了就会产生一个作用域，函数内部会有一个 <code>[scope]</code> 属性；</p> <p>（2）作用域链可以理解为在函数执行时，用于搜索变量的一条链子。当在一个函数中访问某个变量时，会先在当前函数上下文的变量对象中作用中检索，如果没检索到这个变量，逐步往上一级的变量对象检索，一直到全局上下文的变量对象（浏览器环境下全局对象 window）。这样由<strong>多个执行上下文的变量对象构成的链表</strong>就叫做作用域链。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
</code></pre></div><p>执行函数 foo，因为 foo 的创建位置在 bar 函数体内，因此在 foo 自身作用域搜寻不到变量 value 时，会往上一层搜寻，即 bar 函数体内，找到 value 为 2，因此结果输出 2。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
</code></pre></div><p>因为是静态作用域，执行 foo 函数时候会根据创建的位置，先从自身的局部作用域搜寻变量 value，找不到就往上搜寻，于是 value 为 1 ，结果也会输出 1。</p> <p>再来个例子，猜猜输出什么：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> myName <span class="token operator">=</span> <span class="token string">&quot; 极客世界 &quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> test1 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">debugger</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> myName <span class="token operator">=</span> <span class="token string">&quot;Chrome 浏览器 &quot;</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> test<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> myName <span class="token operator">=</span> <span class="token string">&quot; 极客邦 &quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> test <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> test <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> myName <span class="token operator">=</span> <span class="token string">&quot; 极客时间 &quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> myAge <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> test <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_006-什么是闭包-为什么要用它"><a href="#_006-什么是闭包-为什么要用它" class="header-anchor">#</a> 006： 什么是闭包，为什么要用它？</h2> <h4 id="对闭包的理解"><a href="#对闭包的理解" class="header-anchor">#</a> 对闭包的理解</h4> <p>在 JavaScript 中，根据词法作用域的规则，内部函数总是可以访问其外部函数中声明的变量。当通过调用一个外部函数 A 返回一个内部函数 B 后，即使该外部函数 A 已经执行结束了，但是内部函数引用外部函数的变量依然保存在内存中，我们就把这些变量的集合称为闭包。</p> <p>如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> f2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
</code></pre></div><h4 id="闭包产生的原因"><a href="#闭包产生的原因" class="header-anchor">#</a> 闭包产生的原因</h4> <p>由于作用域链从最底层向上找，从当前作用域找到全局作用域 window 为止。如果全局还没有的话就会报错。因此，为了在当前环境中能存在指向局部作用域的引用，可以间接访问函数内部的变量，闭包就出现了。</p> <h4 id="常见的闭包使用方式"><a href="#常见的闭包使用方式" class="header-anchor">#</a> 常见的闭包使用方式</h4> <ul><li><p>(1) 中作为函数返回值被返回；</p></li> <li><p>作为函数参数传递；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

    <span class="token comment">// 闭包</span>
    <span class="token keyword">function</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">test3</span><span class="token punctuation">(</span>test2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 闭包</span>
    <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
</code></pre></div></li> <li><p>在定时器、事件监听、Ajax 请求或者任何异步中，只要使用了回调函数，实际上就是在使用闭包；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 事件监听</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;DOM Listener&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定时器</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;in settiomeout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>IIFE(立即执行函数表达式)创建闭包。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>按照 js 事件循环的机制，setTimeout 是宏任务，等待主线程的循环任务执行完毕，接着会执行宏任务 setTimeout 的回调，因为在回调函数的局部作用域中没有变量 i，因此会依次往上找到全局变量 i，因为此时循环已结束，所以 i 已变成了 6，所以会全部输出 6。</p> <p>可以利用 IIFE 来解决这个问题，当每次 for 循环时，把此时的 i 值作为参数传递到定时器中：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">j</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>（另外，这个问题的推荐用 es6 的 let 来解决。）</p></li></ul> <h4 id="闭包的回收机制"><a href="#闭包的回收机制" class="header-anchor">#</a> 闭包的回收机制</h4> <p>如果引用闭包的函数是一个全局变量，那么闭包会一直存在直到页面关闭；但如果这个闭包以后不再使用的话，就会造成内存泄漏。</p> <p>如果引用闭包的函数是个局部变量，等函数销毁后，在下次 JavaScript 引擎执行垃圾回收时，判断闭包这块内容如果已经不再被使用了，那么 JavaScript 引擎的垃圾回收器就会回收这块内存。</p> <p>所以在使用闭包的时候，你要尽量注意一个原则：如果该闭包会一直使用，那么它可以作为全局变量而存在；但如果使用频率不高，而且占用内存又比较大的话，那就尽量让它成为一个局部变量。</p> <h2 id="_007-原型和构造函数的关系-如何理解原型链-针对对象属性"><a href="#_007-原型和构造函数的关系-如何理解原型链-针对对象属性" class="header-anchor">#</a> 007： 原型和构造函数的关系，如何理解原型链？（针对对象属性）</h2> <p>（1）原型<br>
每个函数数据类型内部都会默认有一个 <code>prototype</code> 属性，这个属性指向函数的原型对象。</p> <p>而这个原型对象就是这个函数作为构造函数时，通过 new 创建的实例对象的原型。（实例对象通过隐式的 <code>__proto__</code> 指向构造函数的原型对象）</p> <p>可以说在 new 的过程中，新对象就会被添加了<code>__proto__</code> 并且链接到构造函数的原型对象上。）</p> <p>（2）原型和构造函数的关系，constructor</p> <p>实例对象和构造函数可分别通过<code>__proto__</code>、<code>prototype</code>指向原型，而原型可通过<code>constructor</code>属性指向构造函数。（让实例对象知道是什么函数构造了它）</p> <p><img src="https://raw.githubusercontent.com/chieminchan/chieminchan.github.io/master/images/interviews/prototype.png" alt="原型图"></p> <p>如上图所示：<br>
1）构造函数 Person 的实例对象为 person，Person 通过 prototype 指向自己的原型对象 <code>Person.prototype</code>；<br>
2）原型对象 <code>Person.prototype</code> 可通过<code>constructor</code>指向构造函数 Person；<br>
3）实例 person 通过隐式的 <code>__proto__</code> 指向原型 Person.prototype；<br>
4）Person.prototype 原型对象同时也是一个对象，即作为 Object 的实例，因此也有<code>Person.prototype.__ proto__</code> 属性指向自己的原型 Object.prototype。</p> <p>（3）原型链<br>
原型链就是多个对象通过<code>__proto__</code>连接起来的一个链子。</p> <p>在实例对象里面，如果要访问某个属性，首先会从这个实例对象内部搜寻；如果在内部找不到这个属性，就会去它的原型里面找这个属性，若还是没有，就沿着原型链，向它的原型的原型，直到找到为止。</p> <p>原型链最顶层是 Object 的原型对象 Object.prototype ，而它的原型是 null，因此到此便会终止搜寻。</p> <p><img src="https://raw.githubusercontent.com/chieminchan/chieminchan.github.io/master/images/interviews/prototype2.png" alt="原型图"></p> <p>⚠️ ：<br>
a. 对象的 hasOwnProperty() 可用于检查对象自身中是否含有该属性；<br>
b. 使用 in 也可检查对象中是否含有某个属性，如果对象中没有，但是原型链中有，也会返回 true。</p> <p>相关题：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Ofo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Bick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;bick&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Ofo</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> OfoBick <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ofo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> bick <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>OfoBick<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bick<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// bick</span>
<span class="token comment">// bick</span>
</code></pre></div><h4 id="object-create-的实现"><a href="#object-create-的实现" class="header-anchor">#</a> Object.create 的实现</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> sex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">hi,i am </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> b <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;coco&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">&quot;hello sex&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;set value:&quot;</span> <span class="token operator">+</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 以上其实等价于</span>
<span class="token comment">// var c = new Person(&quot;coco&quot;, &quot;boy&quot;);</span>
</code></pre></div><blockquote><p>Object.create(proto,[propertiesObject])<br>
proto:新创建对象的原型对象<br>
propertiesObject:可选。要添加到新对象的可枚举的属性，包括属性名字属性值以及描述符（新添加的属性是其自身的属性，而不是其原型链上的属性，可用 hasOwnProperty()获取）</p></blockquote> <blockquote><p>Object.create(null) 和 {} 的区别：前者会创建一个纯净不继承 Object 原型链上方法的全空白对象，{}创建的对象会继承 Object 原型链上方法</p></blockquote> <p>由以上可知，Object.create 做的事情主要有：<br>
1）创建一个新的对象，并以第一个参数作为新对象的<strong>proto</strong>属性的值（以第一个参数作为新对象的构造函数的原型对象）<br>
2）有第二个可选参数，是一个对象，对象的每个属性都会作为新对象的自身属性，对象的属性值以 descriptor（Object.getOwnPropertyDescriptor(obj, 'key')）的形式出现，且 enumerable 默认为 false</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// step1: 暂时不考虑第二个参数</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">_create1</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">proto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//实现一个隐藏函数</span>
    <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token comment">//函数的原型设置为参数传进来的原型</span>
    <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> proto<span class="token punctuation">;</span>
    <span class="token comment">// F.prototype.constructor = F;</span>

    <span class="token comment">// 返回一个F函数的实例，即此实例的__proto__指向为参数proto</span>
    <span class="token keyword">const</span> newObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 传进来的原型为null时，建立一个全空对象</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>proto <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        newObj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> newObj<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// step2，考虑第二个参数</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">_create2</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">proto<span class="token punctuation">,</span> properties <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> proto<span class="token punctuation">;</span>

    <span class="token keyword">const</span> newObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Object.defineProperty定义新属性或修改原有的属性</span>
        <span class="token comment">// Object.defineProperty(obj, prop, descriptor)</span>
        <span class="token comment">// Object.defineProperty(obj, &quot;test&quot;, {</span>
        <span class="token comment">//     value: 任意类型的值,</span>
        <span class="token comment">//     configurable: true | false, // 是否可删除/再次设置特性</span>
        <span class="token comment">//     enumerable: true | false, //是否可枚举（使用for...in或Object.keys()）</span>
        <span class="token comment">//     writable: true | false, //是否可被重写</span>
        <span class="token comment">// });</span>
        Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>newObj<span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>proto <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        newObj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> newObj<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_008-new-具体干了些什么-通过-new-的方式创建对象和通过字面量创建有什么区别-模拟实现-new"><a href="#_008-new-具体干了些什么-通过-new-的方式创建对象和通过字面量创建有什么区别-模拟实现-new" class="header-anchor">#</a> 008： new 具体干了些什么？通过 new 的方式创建对象和通过字面量创建有什么区别？模拟实现 new？</h2> <p>（1）new 操作背后的步骤：</p> <ul><li>创建一个空对象，并把这个空对象的原型指向构造函数原型对象；（继承自构造函数原型对象的实例）</li> <li>使用 apply 将构造函数的 this 指向空对象，并执行一遍构造函数，为空对象增加新的属性方法；</li> <li>构造函数有 return 语句，但没有指定返回值，或返回一个原始值，那么这时将忽略返回值，返回这个新对象；若返回的是一个对象，则返回构造函数提供这一个对象。</li> <li>构造函数无 return，则直接返回这个新对象。</li></ul> <p>(2) 通过 new 创建对象和字面量创建对象的方式区别：</p> <ul><li>字面量创建对象不会调用 Object() 构造函数，简洁明了，性能较好；</li> <li>通过 new Object() 方式创建对象本质上是方法调用，涉及到在原型链中遍历该方法，当找到该方法后，又会生产方法调用必须的堆栈信息，方法调用结束后，还要释放该堆栈，性能会不如字面量的方式。</li></ul> <p>（3）模拟实现 new：</p> <p>这里主要参考了大神<a href="https://github.com/mqyqingfeng/Blog/issues/13" target="_blank" rel="noopener noreferrer">冴羽<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的文章：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 简单创建一个空对象</span>
    <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 获取从外部传入的构造器，即第一个参数</span>
    <span class="token keyword">var</span> constructor <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 实例指向的原型</span>
    obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> constructor<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

    <span class="token comment">// 也可通过 Object.create 直接创建继承自构造函数原型对象的实例对象</span>
    <span class="token comment">// var obj = Object.create(constructor.prototype);</span>

    <span class="token comment">// 通过改变外部传入的构造器中的this指向，并执行构造器，给obj设置新的属性</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">constructor</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 根据构造器的返回值，来决定该返回什么</span>
    <span class="token comment">// 构造函数有返回，且返回的是一个对象则按构造函数的对象来返回</span>
    <span class="token comment">// 构造函数无返回，即返回 undefined，则返回这个新创建的对象</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> result <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">?</span> result <span class="token operator">||</span> obj <span class="token operator">:</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="object-create-、-、new-的区别"><a href="#object-create-、-、new-的区别" class="header-anchor">#</a> Object.create 、{}、new 的区别？</h4> <ul><li><p>直接字面量创建 {}<br>
创建一个新对象，并且继承 Object 原型的属性方法。</p></li> <li><p>new 关键字创建<br>
创建一个给定的构造函数原型的新实例对象，实例对象会继承构造函数的属性方法。</p></li> <li><p>Object.create()<br>
创建一个继承给定的第一个参数原型的新对象，第一个参数为 null 时会返回一个真正的空对象。</p></li></ul> <h2 id="_009-call、apply-和-bind-的区别-模拟实现-bind、call"><a href="#_009-call、apply-和-bind-的区别-模拟实现-bind、call" class="header-anchor">#</a> 009： call、apply 和 bind 的区别，模拟实现 bind、call？</h2> <p><a href="/articles/JavaScript/call、apply、bind的实现.html">可戳《call、apply、bind 的实现》</a></p> <h2 id="_010-对-this-指向的理解"><a href="#_010-对-this-指向的理解" class="header-anchor">#</a> 010： 对 this 指向的理解</h2> <p>（1）call/apply/bind 显示绑定<br>
（2）全局上下文中，this 默认绑定到 window，严格模式下指向 undefined<br>
（3）谁最后调用就指向谁</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">bar</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> func <span class="token operator">=</span> foo<span class="token punctuation">.</span>bar<span class="token punctuation">;</span>
<span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>
</code></pre></div><p>👆 <code>func()</code> 是方法调用，this 指向调用者，即全局上下文的情况。</p> <div class="language-js extra-class"><pre class="language-js"><code>foo<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// foo</span>
</code></pre></div><p>👆 <code>foo.bar()</code> 以对象.方法的形式调用，this 指向调用者，即 <code>foo</code>。</p> <p>⚠️ 值得注意，有个特殊的情况：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">bar</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span>
        <span class="token function-variable function">baz</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">&quot;window&quot;</span><span class="token punctuation">;</span>
foo<span class="token punctuation">.</span>bar<span class="token punctuation">.</span><span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// bar</span>
</code></pre></div><p><strong>若一串对象属性链中的某个属性对应的一个函数中有 this，尽管这个函数是被最外层的对象所调用，this 指向也只会是最内层的对象。</strong></p> <p>（5）new 绑定<br>
如果函数或者方法调用之前带有关键字 new，就构成构造函数调用。此时的 this 指向构造函数的实例对象。</p> <p>（6）箭头函数</p> <ul><li>箭头函数中没有 this 绑定，必须通过查找作用域链来决定 this 的值。</li></ul> <p>如果箭头函数被非箭头函数包含，则 this 指向<strong>当前外层最近的非箭头函数</strong>的 this，否则，找不到就是 window(严格模式是 undefined)。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

obj1<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>

<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// obj2 {foo: ƒ}</span>
<span class="token comment">// obj2 {foo: ƒ}</span>

<span class="token comment">// bar() 找到最近的非箭头函数为 foo，而此时 foo 是被 obj2 调用，即 foo 中的 this 指向 obj2，因此箭头函数中 this 指向 obj2</span>

<span class="token keyword">const</span> obj3 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> baz <span class="token operator">=</span> obj3<span class="token punctuation">.</span>foo<span class="token punctuation">;</span>
<span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// window</span>
<span class="token comment">// window</span>

<span class="token comment">// bar() 找到最近的非箭头函数为 foo，而 baz() 是方法调用, 即 baz 中的 this 指向全局上下文，因此箭头函数中 this 指向全局上下文 window</span>
</code></pre></div><p>（7）DOM 事件绑定</p> <h2 id="_011-事件流、事件对象、事件处理程序、事件委托"><a href="#_011-事件流、事件对象、事件处理程序、事件委托" class="header-anchor">#</a> 011： 事件流、事件对象、事件处理程序、事件委托</h2> <p><a href="/articles/JavaScript/事件流和事件处理程序.html">戳我看详细的《事件流和事件处理程序》</a></p> <h2 id="_012-深拷贝和浅拷贝-哪些栗子"><a href="#_012-深拷贝和浅拷贝-哪些栗子" class="header-anchor">#</a> 012： 深拷贝和浅拷贝，哪些栗子？</h2> <p>当目标对象对赋值对象通过直接赋值的方式进行拷贝，这种情况仅能拷贝了地址，改变一方属性值，由于是同一个引用，会导致同个地址对应的属性值都发生变化。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
a<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
</code></pre></div><p>（1）浅拷贝</p> <p>浅拷贝会将对象的各个属性进行依次复制，但并不会进行递归复制，即只会赋值目标对象的第一层属性。</p> <p>对于目标对象第一层为基本数据类型的数据，就是直接赋值；<br>
而对于目标对象第一层为引用数据类型的数据，就是直接赋存于栈内存中的堆内存地址。</p> <ul><li>Object.assign</li></ul> <p>Object.assign 会拷贝所有的属性值到新的对象中，如果属性值是对象的话，拷贝的依然是属性的引用，因此只是浅拷贝，并不是深拷贝。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Kate&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token literal-property property">habits</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">first</span><span class="token operator">:</span> <span class="token string">&quot;running&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">second</span><span class="token operator">:</span> <span class="token string">&quot;eating&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> person2 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> person1<span class="token punctuation">)</span><span class="token punctuation">;</span>
person2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Rose&quot;</span><span class="token punctuation">;</span>
person2<span class="token punctuation">.</span>habits<span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;person1：&quot;</span><span class="token punctuation">,</span> person1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;person2：&quot;</span><span class="token punctuation">,</span> person2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// person1： {name: &quot;Kate&quot;, age: 20, habits: {first: &quot;shopping&quot;, second: &quot;eating&quot;}}</span>
<span class="token comment">// person2： {name: &quot;Rose&quot;, age: 20, habits: {first: &quot;shopping&quot;, second: &quot;eating&quot;}}</span>
</code></pre></div><ul><li>运算符 ...</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Kate&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token literal-property property">habit</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">first</span><span class="token operator">:</span> <span class="token string">&quot;running&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> person2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>person1 <span class="token punctuation">}</span><span class="token punctuation">;</span>
person2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Rose&quot;</span><span class="token punctuation">;</span>
person2<span class="token punctuation">.</span>habit<span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token string">&quot;reading&quot;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;person1：&quot;</span><span class="token punctuation">,</span> person1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;person2：&quot;</span><span class="token punctuation">,</span> person2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// person1： {name: &quot;Kate&quot;, age: 20, habits: {first: &quot;reading&quot;}}</span>
<span class="token comment">// person1： {name: &quot;Rose&quot;, age: 20, habits: {first: &quot;reading&quot;}}</span>
</code></pre></div><ul><li>array.concat()</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">habit</span><span class="token operator">:</span> <span class="token string">&quot;eating&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> arr2 <span class="token operator">=</span> arr1<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

arr2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>
arr2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>habit <span class="token operator">=</span> <span class="token string">&quot;running&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;arr1：&quot;</span><span class="token punctuation">,</span> arr1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;arr2：&quot;</span><span class="token punctuation">,</span> arr2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// arr1：[20, {habit: &quot;running&quot;}]</span>
<span class="token comment">// arr2：[22, {habit: &quot;running&quot;}]</span>
</code></pre></div><p>（2）深拷贝</p> <p>深拷贝不同于浅拷贝，它不只拷贝目标对象的第一层属性，而是递归拷贝目标对象的所有属性。</p> <ul><li>JSON.parse(JSON.stringify())</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Kate&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token literal-property property">habits</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">first</span><span class="token operator">:</span> <span class="token string">&quot;running&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> person2 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
person2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Rose&quot;</span><span class="token punctuation">;</span>
person2<span class="token punctuation">.</span>habits<span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token string">&quot;eating&quot;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;person1:&quot;</span><span class="token punctuation">,</span> person1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;person2:&quot;</span><span class="token punctuation">,</span> person2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// person1: {name: &quot;Kate&quot;, age: 20, habits: {first: &quot;running&quot;}}</span>
<span class="token comment">// person2: {name: &quot;Rose&quot;, age: 20, habits: {first: &quot;eating&quot;}}</span>
</code></pre></div><p>这个方法可以足够覆盖大多数的应用场景，但有一些情况会出现问题，比如：</p> <ul><li>在遇到函数、 undefined 或者 symbol 的时候，JSON 不能正常的序列化</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Kate&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;female&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">habits</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
    <span class="token function-variable function">jobs</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> person2 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;person1:&quot;</span><span class="token punctuation">,</span> person1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;person2:&quot;</span><span class="token punctuation">,</span> person2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// person1: {name: &quot;Kate&quot;, age: 20, sex: Symbol(female), habits: undefined, jobs: ƒ ()}</span>
<span class="token comment">// person2: {name: &quot;Kate&quot;, age: 20}</span>
</code></pre></div><ul><li>不能解决循环引用的对象</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 拷贝person1会出现系统栈溢出，因为出现了无限递归的情况。</span>
<span class="token keyword">const</span> person1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Kate&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token literal-property property">habits</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">first</span><span class="token operator">:</span> <span class="token string">&quot;eating&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

person1<span class="token punctuation">.</span>friend <span class="token operator">=</span> person1<span class="token punctuation">;</span>
<span class="token keyword">const</span> person2 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;person1:&quot;</span><span class="token punctuation">,</span> person1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;person2:&quot;</span><span class="token punctuation">,</span> person2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Uncaught TypeError: Converting circular structure to JSON at JSON.stringify (&lt;anonymous&gt;)</span>
</code></pre></div><h2 id="_013-什么是防抖和节流-有什么区别-如何实现"><a href="#_013-什么是防抖和节流-有什么区别-如何实现" class="header-anchor">#</a> 013： 什么是防抖和节流？有什么区别？如何实现？</h2> <p>防抖和节流的主要作用都是为了减少函数无用的触发次数，以便解决响应跟不上触发频率导致页面卡顿这类问题，提高性能和避免资源浪费。</p> <p>但防抖动和节流本质是不一样的，防抖是将多次执行变为最后一次执行，节流是将多次执行变成每隔一段时间执行。</p> <h4 id="防抖-debounce-原理"><a href="#防抖-debounce-原理" class="header-anchor">#</a> 防抖 debounce 原理：</h4> <p>在触发触发某个事件后的 n 秒后才能重新执行，若在触发事件的 n 秒内再次触发这个事件，时间 n 将会重新开始计时，直到触发完事件的 n 秒内不再触发事件，这个事件才会执行。（指定时间内只能触发一次事件，否则多次触发会重新计时。）</p> <p><strong>应用场景：</strong><br>
常用于搜索框输入实时查询、下载按钮</p> <h4 id="节流-throttle-原理"><a href="#节流-throttle-原理" class="header-anchor">#</a> 节流 throttle 原理：</h4> <p>当持续触发事件时，保证一定时间段内只能执行一次事件处理函数。（指定时间内多次触发时间后，需要间隔一定时间才会执行）</p> <p><strong>应用场景：</strong><br>
常用于监听浏览器滚动条</p> <h4 id="防抖和节流的手写实现"><a href="#防抖和节流的手写实现" class="header-anchor">#</a> 防抖和节流的手写实现</h4> <p><a href="/articles/JavaScript/防抖和节流.html">可戳《防抖和节流》</a></p> <h2 id="_014-浏览器重绘和回流"><a href="#_014-浏览器重绘和回流" class="header-anchor">#</a> 014： 浏览器重绘和回流？</h2> <h2 id="_015-createdocumentfragment-创建文档碎片节点"><a href="#_015-createdocumentfragment-创建文档碎片节点" class="header-anchor">#</a> 015： createDocumentFragment 创建文档碎片节点</h2> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lists<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>234<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>345<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>678<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>789<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">const</span> lists <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;lists&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> text <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 事件委托</span>
    lists<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> target <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
        text<span class="token punctuation">.</span>innerText <span class="token operator">=</span> target<span class="token punctuation">.</span>textContent<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// document.createDocumentFragment</span>
    <span class="token keyword">const</span> fragement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> li <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;li&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        li<span class="token punctuation">.</span>innerText <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token string">&quot;. i am a list&quot;</span><span class="token punctuation">;</span>
        fragement<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    lists<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>fragement<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_016-for-in-和-for-of-区别"><a href="#_016-for-in-和-for-of-区别" class="header-anchor">#</a> 016： for..in 和 for..of 区别</h2> <h4 id="for-let-key-in-obj"><a href="#for-let-key-in-obj" class="header-anchor">#</a> for (let key in Obj)</h4> <ol><li><p>对于对象，遍历可枚举的对象属性，包括 prototype 中的方法名称，但不包括 不可枚举 和 Symbol 类型 的属性名称</p></li> <li><p>对于数组，枚举索引（index）</p></li></ol> <p><code>for..in</code>对于数组存在一个问题：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;ccc&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token keyword">in</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0, 1, 2, 3, name</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
</code></pre></div><h4 id="for-let-item-of-array"><a href="#for-let-item-of-array" class="header-anchor">#</a> for (let item of Array)</h4> <p><code>for..of</code> 为了解决 <code>for..in</code> 的问题，只遍历集合本身的元素，可用于 set、map、array 可迭代对象。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;ccc&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1, 2, 3, 4</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_017-javascript-如何实现继承-不同方式的优缺点"><a href="#_017-javascript-如何实现继承-不同方式的优缺点" class="header-anchor">#</a> 017：JavaScript 如何实现继承？(不同方式的优缺点)</h2> <h2 id="_019-javascript-的类和-es6-的-class-区别"><a href="#_019-javascript-的类和-es6-的-class-区别" class="header-anchor">#</a> 019：JavaScript 的类和 ES6 的 class 区别</h2> <h2 id="_020-javascript-的设计模式"><a href="#_020-javascript-的设计模式" class="header-anchor">#</a> 020：JavaScript 的设计模式</h2> <h2 id="_021-reduce"><a href="#_021-reduce" class="header-anchor">#</a> 021：reduce</h2> <p>https://www.jianshu.com/p/e375ba1cfc47</p> <p>reduce polyfill</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 简单版</span>
<span class="token keyword">function</span> <span class="token function">_reduce</span><span class="token punctuation">(</span><span class="token parameter">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fn<span class="token punctuation">,</span> initialVal <span class="token operator">=</span> <span class="token keyword">undefined</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 初始化值</span>
    <span class="token keyword">let</span> startIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> startVal <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>initialVal <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        startIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        startVal <span class="token operator">=</span> initialVal<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> startVal<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> startIndex<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// (prev, cur, curIndex, arr) =&gt; {}</span>
        result <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">_reduce</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> prev <span class="token operator">+</span> cur<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 复杂版</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myreduce</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> initialVal <span class="token operator">=</span> <span class="token keyword">undefined</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> sourceArray <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> length <span class="token operator">=</span> sourceArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

    <span class="token comment">// 检验数组长度</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">&quot;empty array&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 检验fn是否为函数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> fn <span class="token operator">!==</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fn<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not a function</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 初始化默认值</span>
    <span class="token keyword">let</span> startIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> startValue <span class="token operator">=</span> sourceArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>initialVal <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        startIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        startValue <span class="token operator">=</span> initialVal<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> startValue<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> startIndex<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> sourceArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> sourceArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">myreduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> prev <span class="token operator">+</span> cur<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_022-compose"><a href="#_022-compose" class="header-anchor">#</a> 022：compose</h2> <h2 id="_023-数组方法中的-indexof-和-includes-实现"><a href="#_023-数组方法中的-indexof-和-includes-实现" class="header-anchor">#</a> 023：数组方法中的 indexOf 和 includes 实现</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">indexOf</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">param<span class="token punctuation">,</span> start <span class="token operator">=</span> <span class="token number">0</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//如果start大于等于数组长度，此时this[start]越界，返回-1</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">&gt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//如果start小于0，判断start + this.length</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        start <span class="token operator">=</span> start <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">+</span> start<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//start处理完毕，开始从start处遍历数组，查找元素下标</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> start<span class="token punctuation">,</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> param<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> i<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 遍历完也没找到，返回-1</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">includes</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">param<span class="token punctuation">,</span> start <span class="token operator">=</span> <span class="token number">0</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">&gt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            start <span class="token operator">=</span> start <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> start <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//start处理完毕后，判断要查找的元素是不是NaN,</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Number<span class="token punctuation">.</span><span class="token function">isNaN</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//param是NaN，从start处开始逐个判断数组中的元素是不是NaN，如果是，返回true</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> start<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>Number<span class="token punctuation">.</span><span class="token function">isNaN</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">//param不是NaN，使用===比较即可</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> start<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> param<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
</code></pre></div><h2 id="_024-什么是-symbol-它的使用场景是什么"><a href="#_024-什么是-symbol-它的使用场景是什么" class="header-anchor">#</a> 024：什么是 Symbol，它的使用场景是什么</h2> <p>新的原始数据类型 Symbol 表示独一无二的值。最大的用法是用来定义对象的唯一属性名，Symbol 作为对象属性名时不能用.运算符，要用方括号<code>obj[symbol]</code>。</p> <p>Symbol.for() 可以在全局访问 Symbol。Symbol.for() 类似单例模式，首先会在全局搜索被登记的 Symbol 中是否有该字符串参数作为名称的 Symbol 值，如果有即返回该 Symbol 值，若没有则新建并返回一个以该字符串参数为名称的 Symbol 值，并登记在全局环境中供搜索。</p> <p>使用场景：<br>
1）Symbol 用来作为对象的属性名，表示唯一的属性名称，防止变量名冲突或；</p> <p>2） Symbol 不会被常规的方法（除了 Object.getOwnPropertySymbols，Reflect.ownKeys() 外）遍历到，所以可以用来<strong>模拟私有变量</strong>；更优雅的“对内操作”和“对外选择性输出”；</p> <p>3）使用 Symbol 来替代常量，防止常量值相等；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">TYPE_AUDIO</span> <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">TYPE_VIDEO</span> <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">TYPE_IMAGE</span> <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">handleFileResource</span><span class="token punctuation">(</span><span class="token parameter">resource</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>resource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token constant">TYPE_AUDIO</span><span class="token operator">:</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;TYPE_AUDIO&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token constant">TYPE_VIDEO</span><span class="token operator">:</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;TYPE_VIDEO&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token constant">TYPE_IMAGE</span><span class="token operator">:</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;TYPE_IMAGE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Unknown type of resource&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 当你想要判断的时候只需要把值传进去</span>
<span class="token function">handleFileResource</span><span class="token punctuation">(</span><span class="token constant">TYPE_VIDEO</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TYPE_AUDIO</span>
</code></pre></div><p>4）注册和获取全局 Symbol</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> gs1 <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;global_symbol_1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//注册一个全局Symbol</span>
<span class="token keyword">let</span> gs2 <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;global_symbol_1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取全局Symbol</span>

gs1 <span class="token operator">===</span> gs2<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>5）注册对象迭代器<br>
Symbol.iterator 可以为每一个对象定义默认的迭代器。该迭代器可以被<code>for…of</code>和<code>…</code>运算符循环使用。</p> <p>插入一下关于 iterator 的知识：</p> <blockquote><p>一个数据结构只要具有 iterator 接口，就可以用 for...of 循环遍历它的成员。Iterator 为各种不同的数据结构提供统一的访问机制。Iterator 其实就是一个具有 next()方法的对象，并且每次调用 next()方法都会返回一个结果对象，这个结果对象有 value 和 done 两个属性。</p></blockquote> <blockquote><p>Symbol.iterator 会返回一个对象，是一个遍历器对象，而作为遍历器对象，其必须具备的特征就是必须具备 next()方法。<br>
for 循环会不断调用 next 。调用 next 函数，返回 value 和 done 两个属性；value 属性返回当前位置的成员，done 属性是一个布尔值，表示遍历是否结束，即是否还有必要再一次调用 next 方法；当 done 为 true 时，即遍历完成。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">k1</span><span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">k2</span><span class="token operator">:</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">k3</span><span class="token operator">:</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// 默认情况下通过defineProperty定义的属性是不能被枚举(遍历)的</span>
    <span class="token literal-property property">enumberable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否可枚举</span>
    <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否可以配置对象，删除属性</span>
    <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否可以修改对象</span>

    <span class="token function-variable function">value</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>_this<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> done <span class="token operator">=</span> index <span class="token operator">&lt;</span> keys<span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token boolean">false</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token keyword">const</span> value <span class="token operator">=</span>
                    index <span class="token operator">&lt;</span> keys<span class="token punctuation">.</span>length <span class="token operator">?</span> _this<span class="token punctuation">[</span>keys<span class="token punctuation">[</span>index<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span> value<span class="token punctuation">,</span> done <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a b c</span>
<span class="token punctuation">}</span>
</code></pre></div><p>留一个问题：有没有其他迭代生成器的写法？</p> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Iterators_and_Generators" target="_blank" rel="noopener noreferrer">yield*<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>https://cloud.tencent.com/developer/article/1446889</p> <h2 id="_025-object-keys、object-getownpropertynames、object-getpropertysymbols"><a href="#_025-object-keys、object-getownpropertynames、object-getpropertysymbols" class="header-anchor">#</a> 025：Object.keys、Object.getOwnPropertyNames、Object.getPropertySymbols</h2> <p>Object.keys：会返回一个给定对象的<strong>自身可枚举属性组成的数组</strong>，会遍历原型上的属性，数组中属性名的排列顺序和使用<code>for...in</code>循环遍历该对象时返回的顺序一致。</p> <p>Object.getOwnPropertyNames：返回一个给定对象的<strong>所有可枚举或不可枚举的属性名</strong>（但不包括 Symbol 值作为名称的属性和原型链上的属性）组成的数组</p> <p>Object.geyOwnPropertySymbols：返回一个给定对象的<strong>所有 Symbol 值的属性</strong>（包括不可枚举的 Symbol 值属性）。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

obj<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;SymbolA&quot;</span><span class="token punctuation">;</span>
obj<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;SymbolForB&quot;</span><span class="token punctuation">;</span>
obj<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;SymbolForC&quot;</span><span class="token punctuation">;</span>
obj<span class="token punctuation">[</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ['d']</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ['d']</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [Symbol(a), Symbol(b), Symbol(c)]</span>
</code></pre></div> <h2 id="_026-window-onload-和-domcontentloaded"><a href="#_026-window-onload-和-domcontentloaded" class="header-anchor">#</a> 026：window.onload 和 DOMContentLoaded</h2> <ol><li><p>当 DOMContentLoaded 事件触发时，仅当 DOM 加载完成，HTML 结构被解析完，但不包括样式表，图片，flash。</p></li> <li><p>当 onload 事件触发时，页面上所有的 DOM，样式表，脚本，图片都已经加载完成了。</p></li></ol> <h2 id="_027-valueof-和-tostring"><a href="#_027-valueof-和-tostring" class="header-anchor">#</a> 027：valueOf 和 toString</h2> <ul><li>valueOf</li></ul> <p>valueOf 方法返回指定对象的原始值。</p> <p>JavaScript 调用 valueOf() 方法用来把对象转换成原始类型的值（数值、字符串和布尔值）。但是我们很少需要自己调用此函数，valueOf 方法一般都会被 JavaScript 自动调用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1,2,3]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {test: 1}</span>
</code></pre></div><ul><li>toString</li></ul> <p>toString 返回一个表示该对象的字符串，当对象表示为文本值或以期望的字符串方式被引用时，toString 方法被自动调用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1,2,3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [object Object]</span>
</code></pre></div><ul><li>区别：valueOf 偏向于运算，toString 偏向于显示。</li></ul> <ol><li>使用运算操作符的情况下，valueOf 的优先级高于 toString。</li> <li>在进行对象转换时，将优先调用 toString 方法，如若没有重写 toString，将调用 valueOf 方法；如果两个方法都没有重写，则按 Object 的 toString 输出。</li> <li>在进行<strong>强转字符串类型时优先调用 toString 方法</strong>，<strong>强转为数字时优先调用 valueOf</strong>。</li></ol> <p>共同的缺点：无法获取 null 和 undefined 的值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;valueOf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;toString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;哈哈哈&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// toString  哈哈哈</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// valueOf   2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token string">&quot;22&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// valueOf   '222'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// valueOf   true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false     =&gt; (严格等于不会触发隐式转换)</span>
</code></pre></div><h4 id="相关应用-如何让-a-1-a-2-a-3-的值为-true"><a href="#相关应用-如何让-a-1-a-2-a-3-的值为-true" class="header-anchor">#</a> 相关应用：如何让(a===1&amp;&amp;a===2&amp;&amp;a===3)的值为 true?</h4> <p>在双等于<code>==</code>的时候，因为涉及隐形类型转换可以通过改写<code>valueOf</code>来实现。</p> <p>但在<code>===</code>时，不会通过 valueOf 进行类型转换，因此可以尝试通过 Object.defineProperty 的 get 去进行改写。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//  让a==1&amp;&amp;a==2&amp;&amp;a==3 =&gt; true</span>
<span class="token keyword">const</span> <span class="token function-variable function">A</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> val<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">A</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">valueOf</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;valueOf&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>val<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// valueOf 1</span>
<span class="token comment">// valueOf 2</span>
<span class="token comment">// valueOf 3</span>
<span class="token comment">// true</span>

<span class="token comment">// 让a===1&amp;&amp;a===2&amp;&amp;a===3 =&gt; true</span>
<span class="token keyword">var</span> val <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;get value&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>val<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">===</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//get value 1</span>
<span class="token comment">// get value 2</span>
<span class="token comment">// get value 3</span>
<span class="token comment">// true</span>
</code></pre></div><ul><li><a href="https://juejin.cn/post/6844904085930377229" target="_blank" rel="noopener noreferrer">如何让(a===1&amp;&amp;a===2&amp;&amp;a===3)的值为 true?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="_029-柯里化"><a href="#_029-柯里化" class="header-anchor">#</a> 029：柯里化</h2> <p>柯里化：只传递给函数一部分参数来调用它，让它返回一个函数去处理剩下的参数。</p> <p>柯里化作用： 参数复用、提前返回 和 延迟执行。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ES6</span>
<span class="token keyword">function</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> len <span class="token operator">=</span> fn<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>curryArgs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> argArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>args<span class="token punctuation">,</span> <span class="token operator">...</span>currArgs<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>argArr<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">curry</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> fn<span class="token punctuation">,</span> <span class="token operator">...</span>argArr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> argArr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ES5</span>
<span class="token keyword">var</span> <span class="token function-variable function">curry</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    arr <span class="token operator">=</span> arr <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> arg <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> arg<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> fn<span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">curry</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_030-实现一个-add-方法"><a href="#_030-实现一个-add-方法" class="header-anchor">#</a> 030：实现一个 add 方法</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 实现一个 add 方法，使计算结果能够满足如下预期：add(1)(2)(3)()=6`，`add(1,2,3)(4)()=10</span>
<span class="token keyword">function</span> <span class="token function">add1</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> allArgs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>args<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>addArgs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 没有参数时进行求和</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>addArgs<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> allArgs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> prev <span class="token operator">+</span> cur<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 有参数时push进args数组</span>
        allArgs <span class="token operator">=</span> allArgs<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>addArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> fn<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> fn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// test</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// 在Function需要转换为字符串时，通常会自动调用函数的 toString 方法，因此也可以尝试通过toString方法实现</span>
<span class="token comment">// 这个方式还兼容支持，add(1)(2)(3)=6， add(1,2,3)(4)=10</span>
<span class="token keyword">function</span> <span class="token function">add2</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> sum <span class="token operator">=</span> args<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> prev <span class="token operator">+</span> cur<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>

     <span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>addArgs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sum <span class="token operator">=</span> addArgs<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> addArgs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> prev <span class="token operator">+</span> cur<span class="token punctuation">,</span> sum<span class="token punctuation">)</span> <span class="token operator">:</span> sum<span class="token punctuation">;</span>
        <span class="token keyword">return</span> fn<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    fn<span class="token punctuation">.</span><span class="token function-variable function">toString</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> fn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// test</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// f 6</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// f 10</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// f 10</span>

<span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token function">add2</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
val <span class="token operator">=</span> <span class="token function">val</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> val<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// f 9 , 9 , funtion</span>


<span class="token comment">// add3</span>
<span class="token keyword">function</span> <span class="token function">add3</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> allArgs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>args<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>addArgs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        allArgs <span class="token operator">=</span> allArgs<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>addArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> fn<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    fn<span class="token punctuation">.</span><span class="token function-variable function">toString</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>allArgs<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> allArgs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> prev <span class="token operator">+</span> cur<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> fn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="_031-实现-string-的-indexof-方法"><a href="#_031-实现-string-的-indexof-方法" class="header-anchor">#</a> 031：实现 String 的 indexOf 方法</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myIndexOf</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> sourceArr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> firstStr <span class="token operator">=</span> str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sourceArr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sourceArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> firstStr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> i <span class="token operator">+</span> str<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                num <span class="token operator">=</span> i<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> num<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_032-类数组转数组的方法"><a href="#_032-类数组转数组的方法" class="header-anchor">#</a> 032：类数组转数组的方法</h2> <div class="language-js extra-class"><pre class="language-js"><code></code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/fragments/Network.html" class="prev">
        🌵 网络
      </a></span> <span class="next"><a href="/fragments/JavaScript Algorithms.html">
        🌵 JavaScript 基础算法
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.448d156c.js" defer></script><script src="/assets/js/2.fefa3fa1.js" defer></script><script src="/assets/js/1.67a15f5a.js" defer></script><script src="/assets/js/75.b006fb40.js" defer></script>
  </body>
</html>
